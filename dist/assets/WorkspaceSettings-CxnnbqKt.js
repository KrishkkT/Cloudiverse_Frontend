import{j as e}from"./index-BJ2RQODn.js";import{e as D,u as A,r as n}from"./vendor-Bj8RrwSB.js";import{B as a}from"./utils-D7-Zsnno.js";import{a6 as E,S as $,a7 as F,a8 as T,N as C,O as m}from"./ui-27QXhGAK.js";const B=()=>{var j;const{id:i}=D(),l=A(),[x,p]=n.useState(""),[h,u]=n.useState(""),[b,y]=n.useState(""),[o,N]=n.useState(null),[k,w]=n.useState(!0);n.useEffect(()=>{i&&(async()=>{var t,r;try{const c=localStorage.getItem("token"),g=await fetch(`http://localhost:5000/api/workspaces/${i}`,{headers:{Authorization:`Bearer ${c}`}});if(g.ok){const d=await g.json();N(d),p(d.name),u(d.description||"");const f=d.state_json||{},W=((t=f.step2Result)==null?void 0:t.project_summary)||((r=f.intent_classification)==null?void 0:r.primary_domain)||"";y(W)}else a.error("Failed to load workspace"),l("/workspaces")}catch(c){console.error("Error fetching workspace:",c),a.error("Failed to load workspace"),l("/workspaces")}finally{w(!1)}})()},[i,l]);const v=async()=>{if(window.confirm("Are you sure you want to delete this workspace? This action cannot be undone."))try{const s=localStorage.getItem("token"),t=await fetch(`http://localhost:5000/api/workspaces/${i}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(t.ok)a.success("Workspace deleted successfully"),l("/workspaces");else{const r=await t.json();a.error(r.message||"Failed to delete workspace")}}catch(s){console.error("Error deleting workspace:",s),a.error("Failed to delete workspace")}},S=async s=>{s.preventDefault();try{const t=localStorage.getItem("token"),r=await fetch(`http://localhost:5000/api/workspaces/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({name:x,description:h})});if(r.ok){const c=await r.json();a.success("Workspace settings saved")}else{const c=await r.json();a.error(c.message||"Failed to save settings")}}catch(t){console.error("Error saving settings:",t),a.error("Failed to save settings")}};return k?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-text-secondary",children:"Loading workspace settings..."})]})}):e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>l(-1),className:"mr-4 p-2 rounded-lg hover:bg-surface",children:e.jsx(E,{className:"h-5 w-5 text-text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-text-primary",children:"Workspace Settings"}),e.jsx("p",{className:"text-text-secondary",children:"Manage your workspace configuration"})]})]})}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx($,{className:"h-6 w-6 text-primary mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"General Settings"})]}),e.jsx("form",{onSubmit:S,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(F,{className:"h-4 w-4 text-primary mr-2"}),e.jsx("label",{htmlFor:"workspaceName",className:"block text-sm font-medium text-text-primary",children:"Project Name"})]}),e.jsx("input",{id:"workspaceName",type:"text",value:x,onChange:s=>p(s.target.value),className:"w-full px-4 py-3 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-text-primary",placeholder:"Enter project name"}),e.jsx("p",{className:"text-text-subtle text-sm mt-1",children:"This is your project name. It stays unchanged throughout the project."})]}),b&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(T,{className:"h-4 w-4 text-secondary mr-2"}),e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"AI-Generated Description"}),e.jsx("span",{className:"ml-2 text-xs bg-secondary/20 text-secondary px-2 py-0.5 rounded",children:"Auto-generated"})]}),e.jsx("div",{className:"w-full px-4 py-3 bg-surface/50 border border-border/50 rounded-lg text-text-secondary",children:b}),e.jsx("p",{className:"text-text-subtle text-sm mt-1",children:"This description was generated by AI based on your project requirements."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"workspaceDescription",className:"block text-sm font-medium text-text-primary mb-2",children:"Your Notes (Optional)"}),e.jsx("textarea",{id:"workspaceDescription",value:h,onChange:s=>u(s.target.value),rows:3,className:"w-full px-4 py-3 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-text-primary",placeholder:"Add your own notes about this workspace"})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-4",children:e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-primary hover:bg-primary/90 text-white rounded-lg flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6 mt-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(m,{className:"h-6 w-6 text-red-500 mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Danger Zone"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-500/10 rounded-lg border border-red-500/20",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:"Delete Workspace"}),e.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Permanently delete this workspace and all its data. This action cannot be undone."})]}),e.jsx("div",{className:"flex flex-col items-end",children:((j=o==null?void 0:o.state_json)==null?void 0:j.is_deployed)===!0||(o==null?void 0:o.step)==="deployed"?e.jsxs("div",{className:"text-right",children:[e.jsxs("button",{disabled:!0,className:"px-4 py-2 bg-gray-600 text-white/50 rounded-lg flex items-center cursor-not-allowed opacity-70",title:"Undeploy project to delete",children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),"Delete Workspace"]}),e.jsxs("p",{className:"text-xs text-red-400 mt-2 font-medium",children:["Cannot delete active deployment. ",e.jsx("br",{}),"Undeploy first."]})]}):e.jsxs("button",{onClick:v,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg flex items-center",children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),"Delete Workspace"]})})]})]})]})})};export{B as default};
