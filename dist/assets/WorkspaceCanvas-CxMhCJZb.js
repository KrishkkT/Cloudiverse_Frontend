import{j as e}from"./index-CFCMkEAz.js";import{r as K,g as Br,c as $e,f as Le,e as Dr,u as Pr}from"./vendor-rtOnKvnR.js";import{a as Be}from"./utils-DrXocLQh.js";import{c as ct,u as Ur,a as wt,s as $r,z as Lr,P as Mr,b as mr,i as Wr,p as Zr,g as Hr,d as pr,e as Gr,f as qr,h as Vr,j as Yr,R as Kr,B as Xr,C as Jr,k as nr}from"./style-BtV30vCO.js";import"./ui-BA9QmYBK.js";let Qr={data:""},es=r=>{if(typeof window=="object"){let c=(r?r.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return c.nonce=window.__nonce__,c.parentNode||(r||document.head).appendChild(c),c.firstChild}return r||Qr},ts=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,rs=/\/\*[^]*?\*\/|  +/g,ir=/\n+/g,Ge=(r,c)=>{let t="",u="",f="";for(let i in r){let s=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+s+";":u+=i[1]=="f"?Ge(s,i):i+"{"+Ge(s,i[1]=="k"?"":c)+"}":typeof s=="object"?u+=Ge(s,c?c.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,a):a?a+" "+d:d)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),f+=Ge.p?Ge.p(i,s):i+":"+s+";")}return t+(c&&f?c+"{"+f+"}":f)+u},Ue={},xr=r=>{if(typeof r=="object"){let c="";for(let t in r)c+=t+xr(r[t]);return c}return r},ss=(r,c,t,u,f)=>{let i=xr(r),s=Ue[i]||(Ue[i]=(d=>{let b=0,m=11;for(;b<d.length;)m=101*m+d.charCodeAt(b++)>>>0;return"go"+m})(i));if(!Ue[s]){let d=i!==r?r:(b=>{let m,v,x=[{}];for(;m=ts.exec(b.replace(rs,""));)m[4]?x.shift():m[3]?(v=m[3].replace(ir," ").trim(),x.unshift(x[0][v]=x[0][v]||{})):x[0][m[1]]=m[2].replace(ir," ").trim();return x[0]})(r);Ue[s]=Ge(f?{["@keyframes "+s]:d}:d,t?"":"."+s)}let a=t&&Ue.g?Ue.g:null;return t&&(Ue.g=Ue[s]),((d,b,m,v)=>{v?b.data=b.data.replace(v,d):b.data.indexOf(d)===-1&&(b.data=m?d+b.data:b.data+d)})(Ue[s],c,u,a),s},as=(r,c,t)=>r.reduce((u,f,i)=>{let s=c[i];if(s&&s.call){let a=s(t),d=a&&a.props&&a.props.className||/^go/.test(a)&&a;s=d?"."+d:a&&typeof a=="object"?a.props?"":Ge(a,""):a===!1?"":a}return u+f+(s??"")},"");function pt(r){let c=this||{},t=r.call?r(c.p):r;return ss(t.unshift?t.raw?as(t,[].slice.call(arguments,1),c.p):t.reduce((u,f)=>Object.assign(u,f&&f.call?f(c.p):f),{}):t,es(c.target),c.g,c.o,c.k)}let gr,_t,jt;pt.bind({g:1});let Me=pt.bind({k:1});function ns(r,c,t,u){Ge.p=c,gr=r,_t=t,jt=u}function Ve(r,c){let t=this||{};return function(){let u=arguments;function f(i,s){let a=Object.assign({},i),d=a.className||f.className;t.p=Object.assign({theme:_t&&_t()},a),t.o=/ *go\d+/.test(d),a.className=pt.apply(t,u)+(d?" "+d:"");let b=r;return r[0]&&(b=a.as||r,delete a.as),jt&&b[0]&&jt(a),gr(b,a)}return c?c(f):f}}var is=r=>typeof r=="function",ht=(r,c)=>is(r)?r(c):r,os=(()=>{let r=0;return()=>(++r).toString()})(),br=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let c=matchMedia("(prefers-reduced-motion: reduce)");r=!c||c.matches}return r}})(),ls=20,Ct="default",yr=(r,c)=>{let{toastLimit:t}=r.settings;switch(c.type){case 0:return{...r,toasts:[c.toast,...r.toasts].slice(0,t)};case 1:return{...r,toasts:r.toasts.map(s=>s.id===c.toast.id?{...s,...c.toast}:s)};case 2:let{toast:u}=c;return yr(r,{type:r.toasts.find(s=>s.id===u.id)?1:0,toast:u});case 3:let{toastId:f}=c;return{...r,toasts:r.toasts.map(s=>s.id===f||f===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return c.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(s=>s.id!==c.toastId)};case 5:return{...r,pausedAt:c.time};case 6:let i=c.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},ut=[],vr={toasts:[],pausedAt:void 0,settings:{toastLimit:ls}},Pe={},wr=(r,c=Ct)=>{Pe[c]=yr(Pe[c]||vr,r),ut.forEach(([t,u])=>{t===c&&u(Pe[c])})},_r=r=>Object.keys(Pe).forEach(c=>wr(r,c)),cs=r=>Object.keys(Pe).find(c=>Pe[c].toasts.some(t=>t.id===r)),xt=(r=Ct)=>c=>{wr(c,r)},ds={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},us=(r={},c=Ct)=>{let[t,u]=K.useState(Pe[c]||vr),f=K.useRef(Pe[c]);K.useEffect(()=>(f.current!==Pe[c]&&u(Pe[c]),ut.push([c,u]),()=>{let s=ut.findIndex(([a])=>a===c);s>-1&&ut.splice(s,1)}),[c]);let i=t.toasts.map(s=>{var a,d,b;return{...r,...r[s.type],...s,removeDelay:s.removeDelay||((a=r[s.type])==null?void 0:a.removeDelay)||(r==null?void 0:r.removeDelay),duration:s.duration||((d=r[s.type])==null?void 0:d.duration)||(r==null?void 0:r.duration)||ds[s.type],style:{...r.style,...(b=r[s.type])==null?void 0:b.style,...s.style}}});return{...t,toasts:i}},hs=(r,c="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:c,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||os()}),nt=r=>(c,t)=>{let u=hs(c,r,t);return xt(u.toasterId||cs(u.id))({type:2,toast:u}),u.id},Se=(r,c)=>nt("blank")(r,c);Se.error=nt("error");Se.success=nt("success");Se.loading=nt("loading");Se.custom=nt("custom");Se.dismiss=(r,c)=>{let t={type:3,toastId:r};c?xt(c)(t):_r(t)};Se.dismissAll=r=>Se.dismiss(void 0,r);Se.remove=(r,c)=>{let t={type:4,toastId:r};c?xt(c)(t):_r(t)};Se.removeAll=r=>Se.remove(void 0,r);Se.promise=(r,c,t)=>{let u=Se.loading(c.loading,{...t,...t==null?void 0:t.loading});return typeof r=="function"&&(r=r()),r.then(f=>{let i=c.success?ht(c.success,f):void 0;return i?Se.success(i,{id:u,...t,...t==null?void 0:t.success}):Se.dismiss(u),f}).catch(f=>{let i=c.error?ht(c.error,f):void 0;i?Se.error(i,{id:u,...t,...t==null?void 0:t.error}):Se.dismiss(u)}),r};var fs=1e3,ms=(r,c="default")=>{let{toasts:t,pausedAt:u}=us(r,c),f=K.useRef(new Map).current,i=K.useCallback((v,x=fs)=>{if(f.has(v))return;let h=setTimeout(()=>{f.delete(v),s({type:4,toastId:v})},x);f.set(v,h)},[]);K.useEffect(()=>{if(u)return;let v=Date.now(),x=t.map(h=>{if(h.duration===1/0)return;let w=(h.duration||0)+h.pauseDuration-(v-h.createdAt);if(w<0){h.visible&&Se.dismiss(h.id);return}return setTimeout(()=>Se.dismiss(h.id,c),w)});return()=>{x.forEach(h=>h&&clearTimeout(h))}},[t,u,c]);let s=K.useCallback(xt(c),[c]),a=K.useCallback(()=>{s({type:5,time:Date.now()})},[s]),d=K.useCallback((v,x)=>{s({type:1,toast:{id:v,height:x}})},[s]),b=K.useCallback(()=>{u&&s({type:6,time:Date.now()})},[u,s]),m=K.useCallback((v,x)=>{let{reverseOrder:h=!1,gutter:w=8,defaultPosition:l}=x||{},g=t.filter(C=>(C.position||l)===(v.position||l)&&C.height),p=g.findIndex(C=>C.id===v.id),j=g.filter((C,k)=>k<p&&C.visible).length;return g.filter(C=>C.visible).slice(...h?[j+1]:[0,j]).reduce((C,k)=>C+(k.height||0)+w,0)},[t]);return K.useEffect(()=>{t.forEach(v=>{if(v.dismissed)i(v.id,v.removeDelay);else{let x=f.get(v.id);x&&(clearTimeout(x),f.delete(v.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:d,startPause:a,endPause:b,calculateOffset:m}}},ps=Me`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,xs=Me`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gs=Me`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,bs=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ps} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${xs} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${gs} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ys=Me`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,vs=Ve("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${ys} 1s linear infinite;
`,ws=Me`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,_s=Me`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,js=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ws} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${_s} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Ns=Ve("div")`
  position: absolute;
`,ks=Ve("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Cs=Me`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ss=Ve("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Cs} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Es=({toast:r})=>{let{icon:c,type:t,iconTheme:u}=r;return c!==void 0?typeof c=="string"?K.createElement(Ss,null,c):c:t==="blank"?null:K.createElement(ks,null,K.createElement(vs,{...u}),t!=="loading"&&K.createElement(Ns,null,t==="error"?K.createElement(bs,{...u}):K.createElement(js,{...u})))},As=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Rs=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,zs="0%{opacity:0;} 100%{opacity:1;}",Is="0%{opacity:1;} 100%{opacity:0;}",Os=Ve("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Ts=Ve("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Fs=(r,c)=>{let t=r.includes("top")?1:-1,[u,f]=br()?[zs,Is]:[As(t),Rs(t)];return{animation:c?`${Me(u)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Me(f)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Bs=K.memo(({toast:r,position:c,style:t,children:u})=>{let f=r.height?Fs(r.position||c||"top-center",r.visible):{opacity:0},i=K.createElement(Es,{toast:r}),s=K.createElement(Ts,{...r.ariaProps},ht(r.message,r));return K.createElement(Os,{className:r.className,style:{...f,...t,...r.style}},typeof u=="function"?u({icon:i,message:s}):K.createElement(K.Fragment,null,i,s))});ns(K.createElement);var Ds=({id:r,className:c,style:t,onHeightUpdate:u,children:f})=>{let i=K.useCallback(s=>{if(s){let a=()=>{let d=s.getBoundingClientRect().height;u(r,d)};a(),new MutationObserver(a).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[r,u]);return K.createElement("div",{ref:i,className:c,style:t},f)},Ps=(r,c)=>{let t=r.includes("top"),u=t?{top:0}:{bottom:0},f=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:br()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${c*(t?1:-1)}px)`,...u,...f}},Us=pt`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,dt=16,$s=({reverseOrder:r,position:c="top-center",toastOptions:t,gutter:u,children:f,toasterId:i,containerStyle:s,containerClassName:a})=>{let{toasts:d,handlers:b}=ms(t,i);return K.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:dt,left:dt,right:dt,bottom:dt,pointerEvents:"none",...s},className:a,onMouseEnter:b.startPause,onMouseLeave:b.endPause},d.map(m=>{let v=m.position||c,x=b.calculateOffset(m,{reverseOrder:r,gutter:u,defaultPosition:c}),h=Ps(v,x);return K.createElement(Ds,{id:m.id,key:m.id,onHeightUpdate:b.updateHeight,className:m.visible?Us:"",style:h},m.type==="custom"?ht(m.message,m):f?f(m):K.createElement(Bs,{toast:m,position:v}))}))},ce=Se;const bt="http://localhost:5000/api",Ls=({workspaceId:r,costEstimation:c,selectedProvider:t,onNext:u,onBack:f,costIntent:i,onFeedbackSubmitted:s})=>{const[a,d]=K.useState(null),[b,m]=K.useState(!1),v=async()=>{var x;if(!a){ce.error("Please select an option");return}m(!0);try{const h=(x=c.provider_details)==null?void 0:x[t],w=(h==null?void 0:h.cost_range)||{min:0,max:0};let l="cost_effective";if(c.cost_profile)l=c.cost_profile;else if(c.selected_profile)l=c.selected_profile;else if(c.scenarios){const p=h==null?void 0:h.total_monthly_cost;for(const[j,C]of Object.entries(c.scenarios)){const k=C[t];if(k&&p){const A=k.monthly_cost||k.estimated_cost;if(A&&Math.abs(p-A)<.01){l=j;break}}}}l==="costeffective"||l==="cost_effective"||l==="costEffective"?l="cost_effective":l==="highperformance"||l==="high_performance"||l==="highPerformance"?l="high_performance":l==="standard"||l==="Standard"?l="standard":l="cost_effective";const g=bt.endsWith("/")?bt.slice(0,-1):bt;try{await Be.post(`${g}/feedback`,{workspace_id:r,cost_intent:(i==null?void 0:i.type)||"startup",estimated_min:w.min||0,estimated_max:w.max||0,selected_provider:t,selected_profile:l,user_feedback:a}),ce.success("Feedback recorded"),s&&s()}catch(p){console.warn("Feedback failed (non-blocking):",p),ce.success("Proceeding to code generation..."),s&&s()}u()}catch(h){console.error("Feedback submission error:",h),ce.error("Failed to submit feedback")}finally{m(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"One Quick Question"}),e.jsx("p",{className:"text-gray-400",children:"Before we generate your Terraform code, help us calibrate our estimator."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-6 text-center",children:"Is this cost estimate within your expected budget?"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("button",{onClick:()=>d("within_budget"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${a==="within_budget"?"bg-green-500/10 border-green-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"Yes, it looks reasonable"}),a==="within_budget"&&e.jsx("span",{className:"material-icons text-green-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("slightly_high"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${a==="slightly_high"?"bg-yellow-500/10 border-yellow-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"It's a bit higher than expected"}),a==="slightly_high"&&e.jsx("span",{className:"material-icons text-yellow-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("too_high"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${a==="too_high"?"bg-red-500/10 border-red-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"No, it's significantly too high"}),a==="too_high"&&e.jsx("span",{className:"material-icons text-red-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("unknown"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${a==="unknown"?"bg-blue-500/10 border-blue-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"I'm not sure / I have no baseline"}),a==="unknown"&&e.jsx("span",{className:"material-icons text-blue-500",children:"check_circle"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Estimate"})]}),e.jsx("button",{onClick:v,disabled:!a||b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Generate Terraform"}),e.jsx("span",{className:"material-icons",children:"code"})]})})]})]})};var jr={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,c){(function(t){r.exports=t()})(function(){return function t(u,f,i){function s(b,m){if(!f[b]){if(!u[b]){var v=typeof ct=="function"&&ct;if(!m&&v)return v(b,!0);if(a)return a(b,!0);var x=new Error("Cannot find module '"+b+"'");throw x.code="MODULE_NOT_FOUND",x}var h=f[b]={exports:{}};u[b][0].call(h.exports,function(w){var l=u[b][1][w];return s(l||w)},h,h.exports,t,u,f,i)}return f[b].exports}for(var a=typeof ct=="function"&&ct,d=0;d<i.length;d++)s(i[d]);return s}({1:[function(t,u,f){var i=t("./utils"),s=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(d){for(var b,m,v,x,h,w,l,g=[],p=0,j=d.length,C=j,k=i.getTypeOf(d)!=="string";p<d.length;)C=j-p,v=k?(b=d[p++],m=p<j?d[p++]:0,p<j?d[p++]:0):(b=d.charCodeAt(p++),m=p<j?d.charCodeAt(p++):0,p<j?d.charCodeAt(p++):0),x=b>>2,h=(3&b)<<4|m>>4,w=1<C?(15&m)<<2|v>>6:64,l=2<C?63&v:64,g.push(a.charAt(x)+a.charAt(h)+a.charAt(w)+a.charAt(l));return g.join("")},f.decode=function(d){var b,m,v,x,h,w,l=0,g=0,p="data:";if(d.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var j,C=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===a.charAt(64)&&C--,d.charAt(d.length-2)===a.charAt(64)&&C--,C%1!=0)throw new Error("Invalid base64 input, bad content length.");for(j=s.uint8array?new Uint8Array(0|C):new Array(0|C);l<d.length;)b=a.indexOf(d.charAt(l++))<<2|(x=a.indexOf(d.charAt(l++)))>>4,m=(15&x)<<4|(h=a.indexOf(d.charAt(l++)))>>2,v=(3&h)<<6|(w=a.indexOf(d.charAt(l++))),j[g++]=b,h!==64&&(j[g++]=m),w!==64&&(j[g++]=v);return j}},{"./support":30,"./utils":32}],2:[function(t,u,f){var i=t("./external"),s=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function b(m,v,x,h,w){this.compressedSize=m,this.uncompressedSize=v,this.crc32=x,this.compression=h,this.compressedContent=w}b.prototype={getContentWorker:function(){var m=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),v=this;return m.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(m,v,x){return m.pipe(new a).pipe(new d("uncompressedSize")).pipe(v.compressWorker(x)).pipe(new d("compressedSize")).withStreamInfo("compression",v)},u.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,u,f){var i=t("./stream/GenericWorker");f.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},f.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,u,f){var i=t("./utils"),s=function(){for(var a,d=[],b=0;b<256;b++){a=b;for(var m=0;m<8;m++)a=1&a?3988292384^a>>>1:a>>>1;d[b]=a}return d}();u.exports=function(a,d){return a!==void 0&&a.length?i.getTypeOf(a)!=="string"?function(b,m,v,x){var h=s,w=x+v;b^=-1;for(var l=x;l<w;l++)b=b>>>8^h[255&(b^m[l])];return-1^b}(0|d,a,a.length,0):function(b,m,v,x){var h=s,w=x+v;b^=-1;for(var l=x;l<w;l++)b=b>>>8^h[255&(b^m.charCodeAt(l))];return-1^b}(0|d,a,a.length,0):0}},{"./utils":32}],5:[function(t,u,f){f.base64=!1,f.binary=!1,f.dir=!1,f.createFolders=!0,f.date=null,f.compression=null,f.compressionOptions=null,f.comment=null,f.unixPermissions=null,f.dosPermissions=null},{}],6:[function(t,u,f){var i=null;i=typeof Promise<"u"?Promise:t("lie"),u.exports={Promise:i}},{lie:37}],7:[function(t,u,f){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),a=t("./utils"),d=t("./stream/GenericWorker"),b=i?"uint8array":"array";function m(v,x){d.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=x,this.meta={}}f.magic="\b\0",a.inherits(m,d),m.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(b,v.data),!1)},m.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(x){v.push({data:x,meta:v.meta})}},f.compressWorker=function(v){return new m("Deflate",v)},f.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,u,f){function i(h,w){var l,g="";for(l=0;l<w;l++)g+=String.fromCharCode(255&h),h>>>=8;return g}function s(h,w,l,g,p,j){var C,k,A=h.file,P=h.compression,D=j!==b.utf8encode,S=a.transformTo("string",j(A.name)),F=a.transformTo("string",b.utf8encode(A.name)),G=A.comment,ee=a.transformTo("string",j(G)),N=a.transformTo("string",b.utf8encode(G)),I=F.length!==A.name.length,o=N.length!==G.length,B="",X="",$="",ae=A.dir,W=A.date,te={crc32:0,compressedSize:0,uncompressedSize:0};w&&!l||(te.crc32=h.crc32,te.compressedSize=h.compressedSize,te.uncompressedSize=h.uncompressedSize);var O=0;w&&(O|=8),D||!I&&!o||(O|=2048);var R=0,re=0;ae&&(R|=16),p==="UNIX"?(re=798,R|=function(H,he){var be=H;return H||(be=he?16893:33204),(65535&be)<<16}(A.unixPermissions,ae)):(re=20,R|=function(H){return 63&(H||0)}(A.dosPermissions)),C=W.getUTCHours(),C<<=6,C|=W.getUTCMinutes(),C<<=5,C|=W.getUTCSeconds()/2,k=W.getUTCFullYear()-1980,k<<=4,k|=W.getUTCMonth()+1,k<<=5,k|=W.getUTCDate(),I&&(X=i(1,1)+i(m(S),4)+F,B+="up"+i(X.length,2)+X),o&&($=i(1,1)+i(m(ee),4)+N,B+="uc"+i($.length,2)+$);var V="";return V+=`
\0`,V+=i(O,2),V+=P.magic,V+=i(C,2),V+=i(k,2),V+=i(te.crc32,4),V+=i(te.compressedSize,4),V+=i(te.uncompressedSize,4),V+=i(S.length,2),V+=i(B.length,2),{fileRecord:v.LOCAL_FILE_HEADER+V+S+B,dirRecord:v.CENTRAL_FILE_HEADER+i(re,2)+V+i(ee.length,2)+"\0\0\0\0"+i(R,4)+i(g,4)+S+B+ee}}var a=t("../utils"),d=t("../stream/GenericWorker"),b=t("../utf8"),m=t("../crc32"),v=t("../signature");function x(h,w,l,g){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=l,this.encodeFileName=g,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(x,d),x.prototype.push=function(h){var w=h.meta.percent||0,l=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,d.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:l?(w+100*(l-g-1))/l:100}}))},x.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var w=this.streamFiles&&!h.file.dir;if(w){var l=s(h,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(h){this.accumulate=!1;var w=this.streamFiles&&!h.file.dir,l=s(h,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),w)this.push({data:function(g){return v.DATA_DESCRIPTOR+i(g.crc32,4)+i(g.compressedSize,4)+i(g.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var h=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var l=this.bytesWritten-h,g=function(p,j,C,k,A){var P=a.transformTo("string",A(k));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(p,2)+i(p,2)+i(j,4)+i(C,4)+i(P.length,2)+P}(this.dirRecords.length,l,h,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(h){this._sources.push(h);var w=this;return h.on("data",function(l){w.processChunk(l)}),h.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),h.on("error",function(l){w.error(l)}),this},x.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(h){var w=this._sources;if(!d.prototype.error.call(this,h))return!1;for(var l=0;l<w.length;l++)try{w[l].error(h)}catch{}return!0},x.prototype.lock=function(){d.prototype.lock.call(this);for(var h=this._sources,w=0;w<h.length;w++)h[w].lock()},u.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,u,f){var i=t("../compressions"),s=t("./ZipFileWorker");f.generateWorker=function(a,d,b){var m=new s(d.streamFiles,b,d.platform,d.encodeFileName),v=0;try{a.forEach(function(x,h){v++;var w=function(j,C){var k=j||C,A=i[k];if(!A)throw new Error(k+" is not a valid compression method !");return A}(h.options.compression,d.compression),l=h.options.compressionOptions||d.compressionOptions||{},g=h.dir,p=h.date;h._compressWorker(w,l).withStreamInfo("file",{name:x,dir:g,date:p,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(m)}),m.entriesCount=v}catch(x){m.error(x)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,u,f){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(s,a){return new i().loadAsync(s,a)},i.external=t("./external"),u.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,u,f){var i=t("./utils"),s=t("./external"),a=t("./utf8"),d=t("./zipEntries"),b=t("./stream/Crc32Probe"),m=t("./nodejsUtils");function v(x){return new s.Promise(function(h,w){var l=x.decompressed.getContentWorker().pipe(new b);l.on("error",function(g){w(g)}).on("end",function(){l.streamInfo.crc32!==x.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}u.exports=function(x,h){var w=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),m.isNode&&m.isStream(x)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",x,!0,h.optimizedBinaryString,h.base64).then(function(l){var g=new d(h);return g.load(l),g}).then(function(l){var g=[s.Promise.resolve(l)],p=l.files;if(h.checkCRC32)for(var j=0;j<p.length;j++)g.push(v(p[j]));return s.Promise.all(g)}).then(function(l){for(var g=l.shift(),p=g.files,j=0;j<p.length;j++){var C=p[j],k=C.fileNameStr,A=i.resolve(C.fileNameStr);w.file(A,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:h.createFolders}),C.dir||(w.file(A).unsafeOriginalName=k)}return g.zipComment.length&&(w.comment=g.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,u,f){var i=t("../utils"),s=t("../stream/GenericWorker");function a(d,b){s.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(b)}i.inherits(a,s),a.prototype._bindStream=function(d){var b=this;(this._stream=d).pause(),d.on("data",function(m){b.push({data:m,meta:{percent:0}})}).on("error",function(m){b.isPaused?this.generatedError=m:b.error(m)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,u,f){var i=t("readable-stream").Readable;function s(a,d,b){i.call(this,d),this._helper=a;var m=this;a.on("data",function(v,x){m.push(v)||m._helper.pause(),b&&b(x)}).on("error",function(v){m.emit("error",v)}).on("end",function(){m.push(null)})}t("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},u.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,u,f){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,u,f){function i(A,P,D){var S,F=a.getTypeOf(P),G=a.extend(D||{},m);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(A=p(A)),G.createFolders&&(S=g(A))&&j.call(this,S,!0);var ee=F==="string"&&G.binary===!1&&G.base64===!1;D&&D.binary!==void 0||(G.binary=!ee),(P instanceof v&&P.uncompressedSize===0||G.dir||!P||P.length===0)&&(G.base64=!1,G.binary=!0,P="",G.compression="STORE",F="string");var N=null;N=P instanceof v||P instanceof d?P:w.isNode&&w.isStream(P)?new l(A,P):a.prepareContent(A,P,G.binary,G.optimizedBinaryString,G.base64);var I=new x(A,N,G);this.files[A]=I}var s=t("./utf8"),a=t("./utils"),d=t("./stream/GenericWorker"),b=t("./stream/StreamHelper"),m=t("./defaults"),v=t("./compressedObject"),x=t("./zipObject"),h=t("./generate"),w=t("./nodejsUtils"),l=t("./nodejs/NodejsStreamInputAdapter"),g=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var P=A.lastIndexOf("/");return 0<P?A.substring(0,P):""},p=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},j=function(A,P){return P=P!==void 0?P:m.createFolders,A=p(A),this.files[A]||i.call(this,A,null,{dir:!0,createFolders:P}),this.files[A]};function C(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var P,D,S;for(P in this.files)S=this.files[P],(D=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&A(D,S)},filter:function(A){var P=[];return this.forEach(function(D,S){A(D,S)&&P.push(S)}),P},file:function(A,P,D){if(arguments.length!==1)return A=this.root+A,i.call(this,A,P,D),this;if(C(A)){var S=A;return this.filter(function(G,ee){return!ee.dir&&S.test(G)})}var F=this.files[this.root+A];return F&&!F.dir?F:null},folder:function(A){if(!A)return this;if(C(A))return this.filter(function(F,G){return G.dir&&A.test(F)});var P=this.root+A,D=j.call(this,P),S=this.clone();return S.root=D.name,S},remove:function(A){A=this.root+A;var P=this.files[A];if(P||(A.slice(-1)!=="/"&&(A+="/"),P=this.files[A]),P&&!P.dir)delete this.files[A];else for(var D=this.filter(function(F,G){return G.name.slice(0,A.length)===A}),S=0;S<D.length;S++)delete this.files[D[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var P,D={};try{if((D=a.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");a.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var S=D.comment||this.comment||"";P=h.generateWorker(this,D,S)}catch(F){(P=new d("error")).error(F)}return new b(P,D.type||"string",D.mimeType)},generateAsync:function(A,P){return this.generateInternalStream(A).accumulate(P)},generateNodeStream:function(A,P){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(P)}};u.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,u,f){u.exports=t("stream")},{stream:void 0}],17:[function(t,u,f){var i=t("./DataReader");function s(a){i.call(this,a);for(var d=0;d<this.data.length;d++)a[d]=255&a[d]}t("../utils").inherits(s,i),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var d=a.charCodeAt(0),b=a.charCodeAt(1),m=a.charCodeAt(2),v=a.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===d&&this.data[x+1]===b&&this.data[x+2]===m&&this.data[x+3]===v)return x-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var d=a.charCodeAt(0),b=a.charCodeAt(1),m=a.charCodeAt(2),v=a.charCodeAt(3),x=this.readData(4);return d===x[0]&&b===x[1]&&m===x[2]&&v===x[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},u.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,u,f){var i=t("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var d,b=0;for(this.checkOffset(a),d=this.index+a-1;d>=this.index;d--)b=(b<<8)+this.byteAt(d);return this.index+=a,b},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},u.exports=s},{"../utils":32}],19:[function(t,u,f){var i=t("./Uint8ArrayReader");function s(a){i.call(this,a)}t("../utils").inherits(s,i),s.prototype.readData=function(a){this.checkOffset(a);var d=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},u.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,u,f){var i=t("./DataReader");function s(a){i.call(this,a)}t("../utils").inherits(s,i),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var d=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},u.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,u,f){var i=t("./ArrayReader");function s(a){i.call(this,a)}t("../utils").inherits(s,i),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,d},u.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,u,f){var i=t("../utils"),s=t("../support"),a=t("./ArrayReader"),d=t("./StringReader"),b=t("./NodeBufferReader"),m=t("./Uint8ArrayReader");u.exports=function(v){var x=i.getTypeOf(v);return i.checkSupport(x),x!=="string"||s.uint8array?x==="nodebuffer"?new b(v):s.uint8array?new m(i.transformTo("uint8array",v)):new a(i.transformTo("array",v)):new d(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,u,f){f.LOCAL_FILE_HEADER="PK",f.CENTRAL_FILE_HEADER="PK",f.CENTRAL_DIRECTORY_END="PK",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",f.ZIP64_CENTRAL_DIRECTORY_END="PK",f.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,u,f){var i=t("./GenericWorker"),s=t("../utils");function a(d){i.call(this,"ConvertWorker to "+d),this.destType=d}s.inherits(a,i),a.prototype.processChunk=function(d){this.push({data:s.transformTo(this.destType,d.data),meta:d.meta})},u.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,u,f){var i=t("./GenericWorker"),s=t("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,i),a.prototype.processChunk=function(d){this.streamInfo.crc32=s(d.data,this.streamInfo.crc32||0),this.push(d)},u.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,u,f){var i=t("../utils"),s=t("./GenericWorker");function a(d){s.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(a,s),a.prototype.processChunk=function(d){if(d){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+d.data.length}s.prototype.processChunk.call(this,d)},u.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,u,f){var i=t("../utils"),s=t("./GenericWorker");function a(d){s.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(m){b.dataIsReady=!0,b.data=m,b.max=m&&m.length||0,b.type=i.getTypeOf(m),b.isPaused||b._tickAndRepeat()},function(m){b.error(m)})}i.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,b);break;case"uint8array":d=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":d=this.data.slice(this.index,b)}return this.index=b,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,u,f){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var d=0;d<this._listeners[s].length;d++)this._listeners[s][d].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(d){a.processChunk(d)}),s.on("end",function(){a.end()}),s.on("error",function(d){a.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},u.exports=i},{}],29:[function(t,u,f){var i=t("../utils"),s=t("./ConvertWorker"),a=t("./GenericWorker"),d=t("../base64"),b=t("../support"),m=t("../external"),v=null;if(b.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(w,l){return new m.Promise(function(g,p){var j=[],C=w._internalType,k=w._outputType,A=w._mimeType;w.on("data",function(P,D){j.push(P),l&&l(D)}).on("error",function(P){j=[],p(P)}).on("end",function(){try{var P=function(D,S,F){switch(D){case"blob":return i.newBlob(i.transformTo("arraybuffer",S),F);case"base64":return d.encode(S);default:return i.transformTo(D,S)}}(k,function(D,S){var F,G=0,ee=null,N=0;for(F=0;F<S.length;F++)N+=S[F].length;switch(D){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(ee=new Uint8Array(N),F=0;F<S.length;F++)ee.set(S[F],G),G+=S[F].length;return ee;case"nodebuffer":return Buffer.concat(S);default:throw new Error("concat : unsupported type '"+D+"'")}}(C,j),A);g(P)}catch(D){p(D)}j=[]}).resume()})}function h(w,l,g){var p=l;switch(l){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=l,this._mimeType=g,i.checkSupport(p),this._worker=w.pipe(new s(p)),w.lock()}catch(j){this._worker=new a("error"),this._worker.error(j)}}h.prototype={accumulate:function(w){return x(this,w)},on:function(w,l){var g=this;return w==="data"?this._worker.on(w,function(p){l.call(g,p.data,p.meta)}):this._worker.on(w,function(){i.delay(l,arguments,g)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},w)}},u.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,u,f){if(f.base64=!0,f.array=!0,f.string=!0,f.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",f.nodebuffer=typeof Buffer<"u",f.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")f.blob=!1;else{var i=new ArrayBuffer(0);try{f.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),f.blob=s.getBlob("application/zip").size===0}catch{f.blob=!1}}}try{f.nodestream=!!t("readable-stream").Readable}catch{f.nodestream=!1}},{"readable-stream":16}],31:[function(t,u,f){for(var i=t("./utils"),s=t("./support"),a=t("./nodejsUtils"),d=t("./stream/GenericWorker"),b=new Array(256),m=0;m<256;m++)b[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;b[254]=b[254]=1;function v(){d.call(this,"utf-8 decode"),this.leftOver=null}function x(){d.call(this,"utf-8 encode")}f.utf8encode=function(h){return s.nodebuffer?a.newBufferFrom(h,"utf-8"):function(w){var l,g,p,j,C,k=w.length,A=0;for(j=0;j<k;j++)(64512&(g=w.charCodeAt(j)))==55296&&j+1<k&&(64512&(p=w.charCodeAt(j+1)))==56320&&(g=65536+(g-55296<<10)+(p-56320),j++),A+=g<128?1:g<2048?2:g<65536?3:4;for(l=s.uint8array?new Uint8Array(A):new Array(A),j=C=0;C<A;j++)(64512&(g=w.charCodeAt(j)))==55296&&j+1<k&&(64512&(p=w.charCodeAt(j+1)))==56320&&(g=65536+(g-55296<<10)+(p-56320),j++),g<128?l[C++]=g:(g<2048?l[C++]=192|g>>>6:(g<65536?l[C++]=224|g>>>12:(l[C++]=240|g>>>18,l[C++]=128|g>>>12&63),l[C++]=128|g>>>6&63),l[C++]=128|63&g);return l}(h)},f.utf8decode=function(h){return s.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(w){var l,g,p,j,C=w.length,k=new Array(2*C);for(l=g=0;l<C;)if((p=w[l++])<128)k[g++]=p;else if(4<(j=b[p]))k[g++]=65533,l+=j-1;else{for(p&=j===2?31:j===3?15:7;1<j&&l<C;)p=p<<6|63&w[l++],j--;1<j?k[g++]=65533:p<65536?k[g++]=p:(p-=65536,k[g++]=55296|p>>10&1023,k[g++]=56320|1023&p)}return k.length!==g&&(k.subarray?k=k.subarray(0,g):k.length=g),i.applyFromCharCode(k)}(h=i.transformTo(s.uint8array?"uint8array":"array",h))},i.inherits(v,d),v.prototype.processChunk=function(h){var w=i.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var l=w;(w=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),w.set(l,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var g=function(j,C){var k;for((C=C||j.length)>j.length&&(C=j.length),k=C-1;0<=k&&(192&j[k])==128;)k--;return k<0||k===0?C:k+b[j[k]]>C?k:C}(w),p=w;g!==w.length&&(s.uint8array?(p=w.subarray(0,g),this.leftOver=w.subarray(g,w.length)):(p=w.slice(0,g),this.leftOver=w.slice(g,w.length))),this.push({data:f.utf8decode(p),meta:h.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:f.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},f.Utf8DecodeWorker=v,i.inherits(x,d),x.prototype.processChunk=function(h){this.push({data:f.utf8encode(h.data),meta:h.meta})},f.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,u,f){var i=t("./support"),s=t("./base64"),a=t("./nodejsUtils"),d=t("./external");function b(l){return l}function m(l,g){for(var p=0;p<l.length;++p)g[p]=255&l.charCodeAt(p);return g}t("setimmediate"),f.newBlob=function(l,g){f.checkSupport("blob");try{return new Blob([l],{type:g})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(l),p.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(l,g,p){var j=[],C=0,k=l.length;if(k<=p)return String.fromCharCode.apply(null,l);for(;C<k;)g==="array"||g==="nodebuffer"?j.push(String.fromCharCode.apply(null,l.slice(C,Math.min(C+p,k)))):j.push(String.fromCharCode.apply(null,l.subarray(C,Math.min(C+p,k)))),C+=p;return j.join("")},stringifyByChar:function(l){for(var g="",p=0;p<l.length;p++)g+=String.fromCharCode(l[p]);return g},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function x(l){var g=65536,p=f.getTypeOf(l),j=!0;if(p==="uint8array"?j=v.applyCanBeUsed.uint8array:p==="nodebuffer"&&(j=v.applyCanBeUsed.nodebuffer),j)for(;1<g;)try{return v.stringifyByChunk(l,p,g)}catch{g=Math.floor(g/2)}return v.stringifyByChar(l)}function h(l,g){for(var p=0;p<l.length;p++)g[p]=l[p];return g}f.applyFromCharCode=x;var w={};w.string={string:b,array:function(l){return m(l,new Array(l.length))},arraybuffer:function(l){return w.string.uint8array(l).buffer},uint8array:function(l){return m(l,new Uint8Array(l.length))},nodebuffer:function(l){return m(l,a.allocBuffer(l.length))}},w.array={string:x,array:b,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return a.newBufferFrom(l)}},w.arraybuffer={string:function(l){return x(new Uint8Array(l))},array:function(l){return h(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:b,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return a.newBufferFrom(new Uint8Array(l))}},w.uint8array={string:x,array:function(l){return h(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:b,nodebuffer:function(l){return a.newBufferFrom(l)}},w.nodebuffer={string:x,array:function(l){return h(l,new Array(l.length))},arraybuffer:function(l){return w.nodebuffer.uint8array(l).buffer},uint8array:function(l){return h(l,new Uint8Array(l.length))},nodebuffer:b},f.transformTo=function(l,g){if(g=g||"",!l)return g;f.checkSupport(l);var p=f.getTypeOf(g);return w[p][l](g)},f.resolve=function(l){for(var g=l.split("/"),p=[],j=0;j<g.length;j++){var C=g[j];C==="."||C===""&&j!==0&&j!==g.length-1||(C===".."?p.pop():p.push(C))}return p.join("/")},f.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":i.nodebuffer&&a.isBuffer(l)?"nodebuffer":i.uint8array&&l instanceof Uint8Array?"uint8array":i.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},f.checkSupport=function(l){if(!i[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},f.MAX_VALUE_16BITS=65535,f.MAX_VALUE_32BITS=-1,f.pretty=function(l){var g,p,j="";for(p=0;p<(l||"").length;p++)j+="\\x"+((g=l.charCodeAt(p))<16?"0":"")+g.toString(16).toUpperCase();return j},f.delay=function(l,g,p){setImmediate(function(){l.apply(p||null,g||[])})},f.inherits=function(l,g){function p(){}p.prototype=g.prototype,l.prototype=new p},f.extend=function(){var l,g,p={};for(l=0;l<arguments.length;l++)for(g in arguments[l])Object.prototype.hasOwnProperty.call(arguments[l],g)&&p[g]===void 0&&(p[g]=arguments[l][g]);return p},f.prepareContent=function(l,g,p,j,C){return d.Promise.resolve(g).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new d.Promise(function(A,P){var D=new FileReader;D.onload=function(S){A(S.target.result)},D.onerror=function(S){P(S.target.error)},D.readAsArrayBuffer(k)}):k}).then(function(k){var A=f.getTypeOf(k);return A?(A==="arraybuffer"?k=f.transformTo("uint8array",k):A==="string"&&(C?k=s.decode(k):p&&j!==!0&&(k=function(P){return m(P,i.uint8array?new Uint8Array(P.length):new Array(P.length))}(k))),k):d.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,u,f){var i=t("./reader/readerFor"),s=t("./utils"),a=t("./signature"),d=t("./zipEntry"),b=t("./support");function m(v){this.files=[],this.loadOptions=v}m.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(x)+", expected "+s.pretty(v)+")")}},isSignature:function(v,x){var h=this.reader.index;this.reader.setIndex(v);var w=this.reader.readString(4)===x;return this.reader.setIndex(h),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),x=b.uint8array?"uint8array":"array",h=s.transformTo(x,v);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,x,h,w=this.zip64EndOfCentralSize-44;0<w;)v=this.reader.readInt(2),x=this.reader.readInt(4),h=this.reader.readData(x),this.zip64ExtensibleData[v]={id:v,length:x,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,x;for(v=0;v<this.files.length;v++)x=this.files[v],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(v=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var x=v;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var w=x-h;if(0<w)this.isSignature(x,a.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(v){this.reader=i(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,u,f){var i=t("./reader/readerFor"),s=t("./utils"),a=t("./compressedObject"),d=t("./crc32"),b=t("./utf8"),m=t("./compressions"),v=t("./support");function x(h,w){this.options=h,this.loadOptions=w}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var w,l;if(h.skip(22),this.fileNameLength=h.readInt(2),l=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(g){for(var p in m)if(Object.prototype.hasOwnProperty.call(m,p)&&m[p].magic===g)return m[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,w,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var w=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(w),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var w,l,g,p=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<p;)w=h.readInt(2),l=h.readInt(2),g=h.readData(l),this.extraFields[w]={id:w,length:l,value:g};h.setIndex(p)},handleUTF8:function(){var h=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var l=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var p=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var w=i(h.value);return w.readInt(1)!==1||d(this.fileName)!==w.readInt(4)?null:b.utf8decode(w.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var w=i(h.value);return w.readInt(1)!==1||d(this.fileComment)!==w.readInt(4)?null:b.utf8decode(w.readData(h.length-5))}return null}},u.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,u,f){function i(w,l,g){this.name=w,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=l,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var s=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),d=t("./utf8"),b=t("./compressedObject"),m=t("./stream/GenericWorker");i.prototype={internalStream:function(w){var l=null,g="string";try{if(!w)throw new Error("No output type specified.");var p=(g=w.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),l=this._decompressWorker();var j=!this._dataBinary;j&&!p&&(l=l.pipe(new d.Utf8EncodeWorker)),!j&&p&&(l=l.pipe(new d.Utf8DecodeWorker))}catch(C){(l=new m("error")).error(C)}return new s(l,g,"")},async:function(w,l){return this.internalStream(w).accumulate(l)},nodeStream:function(w,l){return this.internalStream(w||"nodebuffer").toNodejsStream(l)},_compressWorker:function(w,l){if(this._data instanceof b&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new d.Utf8EncodeWorker)),b.createWorkerFrom(g,w,l)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof m?this._data:new a(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<v.length;h++)i.prototype[v[h]]=x;u.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,u,f){(function(i){var s,a,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var b=0,m=new d(w),v=i.document.createTextNode("");m.observe(v,{characterData:!0}),s=function(){v.data=b=++b%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var l=i.document.createElement("script");l.onreadystatechange=function(){w(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},i.document.documentElement.appendChild(l)}:function(){setTimeout(w,0)};else{var x=new i.MessageChannel;x.port1.onmessage=w,s=function(){x.port2.postMessage(0)}}var h=[];function w(){var l,g;a=!0;for(var p=h.length;p;){for(g=h,h=[],l=-1;++l<p;)g[l]();p=h.length}a=!1}u.exports=function(l){h.push(l)!==1||a||s()}}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,u,f){var i=t("immediate");function s(){}var a={},d=["REJECTED"],b=["FULFILLED"],m=["PENDING"];function v(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,p!==s&&l(this,p)}function x(p,j,C){this.promise=p,typeof j=="function"&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function h(p,j,C){i(function(){var k;try{k=j(C)}catch(A){return a.reject(p,A)}k===p?a.reject(p,new TypeError("Cannot resolve promise with itself")):a.resolve(p,k)})}function w(p){var j=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof j=="function")return function(){j.apply(p,arguments)}}function l(p,j){var C=!1;function k(D){C||(C=!0,a.reject(p,D))}function A(D){C||(C=!0,a.resolve(p,D))}var P=g(function(){j(A,k)});P.status==="error"&&k(P.value)}function g(p,j){var C={};try{C.value=p(j),C.status="success"}catch(k){C.status="error",C.value=k}return C}(u.exports=v).prototype.finally=function(p){if(typeof p!="function")return this;var j=this.constructor;return this.then(function(C){return j.resolve(p()).then(function(){return C})},function(C){return j.resolve(p()).then(function(){throw C})})},v.prototype.catch=function(p){return this.then(null,p)},v.prototype.then=function(p,j){if(typeof p!="function"&&this.state===b||typeof j!="function"&&this.state===d)return this;var C=new this.constructor(s);return this.state!==m?h(C,this.state===b?p:j,this.outcome):this.queue.push(new x(C,p,j)),C},x.prototype.callFulfilled=function(p){a.resolve(this.promise,p)},x.prototype.otherCallFulfilled=function(p){h(this.promise,this.onFulfilled,p)},x.prototype.callRejected=function(p){a.reject(this.promise,p)},x.prototype.otherCallRejected=function(p){h(this.promise,this.onRejected,p)},a.resolve=function(p,j){var C=g(w,j);if(C.status==="error")return a.reject(p,C.value);var k=C.value;if(k)l(p,k);else{p.state=b,p.outcome=j;for(var A=-1,P=p.queue.length;++A<P;)p.queue[A].callFulfilled(j)}return p},a.reject=function(p,j){p.state=d,p.outcome=j;for(var C=-1,k=p.queue.length;++C<k;)p.queue[C].callRejected(j);return p},v.resolve=function(p){return p instanceof this?p:a.resolve(new this(s),p)},v.reject=function(p){var j=new this(s);return a.reject(j,p)},v.all=function(p){var j=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=p.length,k=!1;if(!C)return this.resolve([]);for(var A=new Array(C),P=0,D=-1,S=new this(s);++D<C;)F(p[D],D);return S;function F(G,ee){j.resolve(G).then(function(N){A[ee]=N,++P!==C||k||(k=!0,a.resolve(S,A))},function(N){k||(k=!0,a.reject(S,N))})}},v.race=function(p){var j=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=p.length,k=!1;if(!C)return this.resolve([]);for(var A=-1,P=new this(s);++A<C;)D=p[A],j.resolve(D).then(function(S){k||(k=!0,a.resolve(P,S))},function(S){k||(k=!0,a.reject(P,S))});var D;return P}},{immediate:36}],38:[function(t,u,f){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),u.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,u,f){var i=t("./zlib/deflate"),s=t("./utils/common"),a=t("./utils/strings"),d=t("./zlib/messages"),b=t("./zlib/zstream"),m=Object.prototype.toString,v=0,x=-1,h=0,w=8;function l(p){if(!(this instanceof l))return new l(p);this.options=s.assign({level:x,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},p||{});var j=this.options;j.raw&&0<j.windowBits?j.windowBits=-j.windowBits:j.gzip&&0<j.windowBits&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var C=i.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(C!==v)throw new Error(d[C]);if(j.header&&i.deflateSetHeader(this.strm,j.header),j.dictionary){var k;if(k=typeof j.dictionary=="string"?a.string2buf(j.dictionary):m.call(j.dictionary)==="[object ArrayBuffer]"?new Uint8Array(j.dictionary):j.dictionary,(C=i.deflateSetDictionary(this.strm,k))!==v)throw new Error(d[C]);this._dict_set=!0}}function g(p,j){var C=new l(j);if(C.push(p,!0),C.err)throw C.msg||d[C.err];return C.result}l.prototype.push=function(p,j){var C,k,A=this.strm,P=this.options.chunkSize;if(this.ended)return!1;k=j===~~j?j:j===!0?4:0,typeof p=="string"?A.input=a.string2buf(p):m.call(p)==="[object ArrayBuffer]"?A.input=new Uint8Array(p):A.input=p,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(P),A.next_out=0,A.avail_out=P),(C=i.deflate(A,k))!==1&&C!==v)return this.onEnd(C),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(A.output,A.next_out))):this.onData(s.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&C!==1);return k===4?(C=i.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===v):k!==2||(this.onEnd(v),!(A.avail_out=0))},l.prototype.onData=function(p){this.chunks.push(p)},l.prototype.onEnd=function(p){p===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},f.Deflate=l,f.deflate=g,f.deflateRaw=function(p,j){return(j=j||{}).raw=!0,g(p,j)},f.gzip=function(p,j){return(j=j||{}).gzip=!0,g(p,j)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,u,f){var i=t("./zlib/inflate"),s=t("./utils/common"),a=t("./utils/strings"),d=t("./zlib/constants"),b=t("./zlib/messages"),m=t("./zlib/zstream"),v=t("./zlib/gzheader"),x=Object.prototype.toString;function h(l){if(!(this instanceof h))return new h(l);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},l||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||l&&l.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var p=i.inflateInit2(this.strm,g.windowBits);if(p!==d.Z_OK)throw new Error(b[p]);this.header=new v,i.inflateGetHeader(this.strm,this.header)}function w(l,g){var p=new h(g);if(p.push(l,!0),p.err)throw p.msg||b[p.err];return p.result}h.prototype.push=function(l,g){var p,j,C,k,A,P,D=this.strm,S=this.options.chunkSize,F=this.options.dictionary,G=!1;if(this.ended)return!1;j=g===~~g?g:g===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof l=="string"?D.input=a.binstring2buf(l):x.call(l)==="[object ArrayBuffer]"?D.input=new Uint8Array(l):D.input=l,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new s.Buf8(S),D.next_out=0,D.avail_out=S),(p=i.inflate(D,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&F&&(P=typeof F=="string"?a.string2buf(F):x.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,p=i.inflateSetDictionary(this.strm,P)),p===d.Z_BUF_ERROR&&G===!0&&(p=d.Z_OK,G=!1),p!==d.Z_STREAM_END&&p!==d.Z_OK)return this.onEnd(p),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&p!==d.Z_STREAM_END&&(D.avail_in!==0||j!==d.Z_FINISH&&j!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(C=a.utf8border(D.output,D.next_out),k=D.next_out-C,A=a.buf2string(D.output,C),D.next_out=k,D.avail_out=S-k,k&&s.arraySet(D.output,D.output,C,k,0),this.onData(A)):this.onData(s.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(G=!0)}while((0<D.avail_in||D.avail_out===0)&&p!==d.Z_STREAM_END);return p===d.Z_STREAM_END&&(j=d.Z_FINISH),j===d.Z_FINISH?(p=i.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===d.Z_OK):j!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(D.avail_out=0))},h.prototype.onData=function(l){this.chunks.push(l)},h.prototype.onEnd=function(l){l===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},f.Inflate=h,f.inflate=w,f.inflateRaw=function(l,g){return(g=g||{}).raw=!0,w(l,g)},f.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,u,f){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";f.assign=function(d){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var m=b.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var v in m)m.hasOwnProperty(v)&&(d[v]=m[v])}}return d},f.shrinkBuf=function(d,b){return d.length===b?d:d.subarray?d.subarray(0,b):(d.length=b,d)};var s={arraySet:function(d,b,m,v,x){if(b.subarray&&d.subarray)d.set(b.subarray(m,m+v),x);else for(var h=0;h<v;h++)d[x+h]=b[m+h]},flattenChunks:function(d){var b,m,v,x,h,w;for(b=v=0,m=d.length;b<m;b++)v+=d[b].length;for(w=new Uint8Array(v),b=x=0,m=d.length;b<m;b++)h=d[b],w.set(h,x),x+=h.length;return w}},a={arraySet:function(d,b,m,v,x){for(var h=0;h<v;h++)d[x+h]=b[m+h]},flattenChunks:function(d){return[].concat.apply([],d)}};f.setTyped=function(d){d?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,s)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,a))},f.setTyped(i)},{}],42:[function(t,u,f){var i=t("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var d=new i.Buf8(256),b=0;b<256;b++)d[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function m(v,x){if(x<65537&&(v.subarray&&a||!v.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(v,x));for(var h="",w=0;w<x;w++)h+=String.fromCharCode(v[w]);return h}d[254]=d[254]=1,f.string2buf=function(v){var x,h,w,l,g,p=v.length,j=0;for(l=0;l<p;l++)(64512&(h=v.charCodeAt(l)))==55296&&l+1<p&&(64512&(w=v.charCodeAt(l+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),l++),j+=h<128?1:h<2048?2:h<65536?3:4;for(x=new i.Buf8(j),l=g=0;g<j;l++)(64512&(h=v.charCodeAt(l)))==55296&&l+1<p&&(64512&(w=v.charCodeAt(l+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),l++),h<128?x[g++]=h:(h<2048?x[g++]=192|h>>>6:(h<65536?x[g++]=224|h>>>12:(x[g++]=240|h>>>18,x[g++]=128|h>>>12&63),x[g++]=128|h>>>6&63),x[g++]=128|63&h);return x},f.buf2binstring=function(v){return m(v,v.length)},f.binstring2buf=function(v){for(var x=new i.Buf8(v.length),h=0,w=x.length;h<w;h++)x[h]=v.charCodeAt(h);return x},f.buf2string=function(v,x){var h,w,l,g,p=x||v.length,j=new Array(2*p);for(h=w=0;h<p;)if((l=v[h++])<128)j[w++]=l;else if(4<(g=d[l]))j[w++]=65533,h+=g-1;else{for(l&=g===2?31:g===3?15:7;1<g&&h<p;)l=l<<6|63&v[h++],g--;1<g?j[w++]=65533:l<65536?j[w++]=l:(l-=65536,j[w++]=55296|l>>10&1023,j[w++]=56320|1023&l)}return m(j,w)},f.utf8border=function(v,x){var h;for((x=x||v.length)>v.length&&(x=v.length),h=x-1;0<=h&&(192&v[h])==128;)h--;return h<0||h===0?x:h+d[v[h]]>x?h:x}},{"./common":41}],43:[function(t,u,f){u.exports=function(i,s,a,d){for(var b=65535&i|0,m=i>>>16&65535|0,v=0;a!==0;){for(a-=v=2e3<a?2e3:a;m=m+(b=b+s[d++]|0)|0,--v;);b%=65521,m%=65521}return b|m<<16|0}},{}],44:[function(t,u,f){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,u,f){var i=function(){for(var s,a=[],d=0;d<256;d++){s=d;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;a[d]=s}return a}();u.exports=function(s,a,d,b){var m=i,v=b+d;s^=-1;for(var x=b;x<v;x++)s=s>>>8^m[255&(s^a[x])];return-1^s}},{}],46:[function(t,u,f){var i,s=t("../utils/common"),a=t("./trees"),d=t("./adler32"),b=t("./crc32"),m=t("./messages"),v=0,x=4,h=0,w=-2,l=-1,g=4,p=2,j=8,C=9,k=286,A=30,P=19,D=2*k+1,S=15,F=3,G=258,ee=G+F+1,N=42,I=113,o=1,B=2,X=3,$=4;function ae(n,U){return n.msg=m[U],U}function W(n){return(n<<1)-(4<n?9:0)}function te(n){for(var U=n.length;0<=--U;)n[U]=0}function O(n){var U=n.state,T=U.pending;T>n.avail_out&&(T=n.avail_out),T!==0&&(s.arraySet(n.output,U.pending_buf,U.pending_out,T,n.next_out),n.next_out+=T,U.pending_out+=T,n.total_out+=T,n.avail_out-=T,U.pending-=T,U.pending===0&&(U.pending_out=0))}function R(n,U){a._tr_flush_block(n,0<=n.block_start?n.block_start:-1,n.strstart-n.block_start,U),n.block_start=n.strstart,O(n.strm)}function re(n,U){n.pending_buf[n.pending++]=U}function V(n,U){n.pending_buf[n.pending++]=U>>>8&255,n.pending_buf[n.pending++]=255&U}function H(n,U){var T,_,y=n.max_chain_length,E=n.strstart,M=n.prev_length,Z=n.nice_match,z=n.strstart>n.w_size-ee?n.strstart-(n.w_size-ee):0,q=n.window,J=n.w_mask,Y=n.prev,se=n.strstart+G,ye=q[E+M-1],fe=q[E+M];n.prev_length>=n.good_match&&(y>>=2),Z>n.lookahead&&(Z=n.lookahead);do if(q[(T=U)+M]===fe&&q[T+M-1]===ye&&q[T]===q[E]&&q[++T]===q[E+1]){E+=2,T++;do;while(q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&E<se);if(_=G-(se-E),E=se-G,M<_){if(n.match_start=U,Z<=(M=_))break;ye=q[E+M-1],fe=q[E+M]}}while((U=Y[U&J])>z&&--y!=0);return M<=n.lookahead?M:n.lookahead}function he(n){var U,T,_,y,E,M,Z,z,q,J,Y=n.w_size;do{if(y=n.window_size-n.lookahead-n.strstart,n.strstart>=Y+(Y-ee)){for(s.arraySet(n.window,n.window,Y,Y,0),n.match_start-=Y,n.strstart-=Y,n.block_start-=Y,U=T=n.hash_size;_=n.head[--U],n.head[U]=Y<=_?_-Y:0,--T;);for(U=T=Y;_=n.prev[--U],n.prev[U]=Y<=_?_-Y:0,--T;);y+=Y}if(n.strm.avail_in===0)break;if(M=n.strm,Z=n.window,z=n.strstart+n.lookahead,q=y,J=void 0,J=M.avail_in,q<J&&(J=q),T=J===0?0:(M.avail_in-=J,s.arraySet(Z,M.input,M.next_in,J,z),M.state.wrap===1?M.adler=d(M.adler,Z,J,z):M.state.wrap===2&&(M.adler=b(M.adler,Z,J,z)),M.next_in+=J,M.total_in+=J,J),n.lookahead+=T,n.lookahead+n.insert>=F)for(E=n.strstart-n.insert,n.ins_h=n.window[E],n.ins_h=(n.ins_h<<n.hash_shift^n.window[E+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[E+F-1])&n.hash_mask,n.prev[E&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=E,E++,n.insert--,!(n.lookahead+n.insert<F)););}while(n.lookahead<ee&&n.strm.avail_in!==0)}function be(n,U){for(var T,_;;){if(n.lookahead<ee){if(he(n),n.lookahead<ee&&U===v)return o;if(n.lookahead===0)break}if(T=0,n.lookahead>=F&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+F-1])&n.hash_mask,T=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),T!==0&&n.strstart-T<=n.w_size-ee&&(n.match_length=H(n,T)),n.match_length>=F)if(_=a._tr_tally(n,n.strstart-n.match_start,n.match_length-F),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=F){for(n.match_length--;n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+F-1])&n.hash_mask,T=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart,--n.match_length!=0;);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else _=a._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(_&&(R(n,!1),n.strm.avail_out===0))return o}return n.insert=n.strstart<F-1?n.strstart:F-1,U===x?(R(n,!0),n.strm.avail_out===0?X:$):n.last_lit&&(R(n,!1),n.strm.avail_out===0)?o:B}function oe(n,U){for(var T,_,y;;){if(n.lookahead<ee){if(he(n),n.lookahead<ee&&U===v)return o;if(n.lookahead===0)break}if(T=0,n.lookahead>=F&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+F-1])&n.hash_mask,T=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=F-1,T!==0&&n.prev_length<n.max_lazy_match&&n.strstart-T<=n.w_size-ee&&(n.match_length=H(n,T),n.match_length<=5&&(n.strategy===1||n.match_length===F&&4096<n.strstart-n.match_start)&&(n.match_length=F-1)),n.prev_length>=F&&n.match_length<=n.prev_length){for(y=n.strstart+n.lookahead-F,_=a._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-F),n.lookahead-=n.prev_length-1,n.prev_length-=2;++n.strstart<=y&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+F-1])&n.hash_mask,T=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),--n.prev_length!=0;);if(n.match_available=0,n.match_length=F-1,n.strstart++,_&&(R(n,!1),n.strm.avail_out===0))return o}else if(n.match_available){if((_=a._tr_tally(n,0,n.window[n.strstart-1]))&&R(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return o}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(_=a._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<F-1?n.strstart:F-1,U===x?(R(n,!0),n.strm.avail_out===0?X:$):n.last_lit&&(R(n,!1),n.strm.avail_out===0)?o:B}function le(n,U,T,_,y){this.good_length=n,this.max_lazy=U,this.nice_length=T,this.max_chain=_,this.func=y}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=j,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*D),this.dyn_dtree=new s.Buf16(2*(2*A+1)),this.bl_tree=new s.Buf16(2*(2*P+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(S+1),this.heap=new s.Buf16(2*k+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ge(n){var U;return n&&n.state?(n.total_in=n.total_out=0,n.data_type=p,(U=n.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?N:I,n.adler=U.wrap===2?0:1,U.last_flush=v,a._tr_init(U),h):ae(n,w)}function ke(n){var U=ge(n);return U===h&&function(T){T.window_size=2*T.w_size,te(T.head),T.max_lazy_match=i[T.level].max_lazy,T.good_match=i[T.level].good_length,T.nice_match=i[T.level].nice_length,T.max_chain_length=i[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=F-1,T.match_available=0,T.ins_h=0}(n.state),U}function Ee(n,U,T,_,y,E){if(!n)return w;var M=1;if(U===l&&(U=6),_<0?(M=0,_=-_):15<_&&(M=2,_-=16),y<1||C<y||T!==j||_<8||15<_||U<0||9<U||E<0||g<E)return ae(n,w);_===8&&(_=9);var Z=new ve;return(n.state=Z).strm=n,Z.wrap=M,Z.gzhead=null,Z.w_bits=_,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=y+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+F-1)/F),Z.window=new s.Buf8(2*Z.w_size),Z.head=new s.Buf16(Z.hash_size),Z.prev=new s.Buf16(Z.w_size),Z.lit_bufsize=1<<y+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new s.Buf8(Z.pending_buf_size),Z.d_buf=1*Z.lit_bufsize,Z.l_buf=3*Z.lit_bufsize,Z.level=U,Z.strategy=E,Z.method=T,ke(n)}i=[new le(0,0,0,0,function(n,U){var T=65535;for(T>n.pending_buf_size-5&&(T=n.pending_buf_size-5);;){if(n.lookahead<=1){if(he(n),n.lookahead===0&&U===v)return o;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var _=n.block_start+T;if((n.strstart===0||n.strstart>=_)&&(n.lookahead=n.strstart-_,n.strstart=_,R(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-ee&&(R(n,!1),n.strm.avail_out===0))return o}return n.insert=0,U===x?(R(n,!0),n.strm.avail_out===0?X:$):(n.strstart>n.block_start&&(R(n,!1),n.strm.avail_out),o)}),new le(4,4,8,4,be),new le(4,5,16,8,be),new le(4,6,32,32,be),new le(4,4,16,16,oe),new le(8,16,32,32,oe),new le(8,16,128,128,oe),new le(8,32,128,256,oe),new le(32,128,258,1024,oe),new le(32,258,258,4096,oe)],f.deflateInit=function(n,U){return Ee(n,U,j,15,8,0)},f.deflateInit2=Ee,f.deflateReset=ke,f.deflateResetKeep=ge,f.deflateSetHeader=function(n,U){return n&&n.state?n.state.wrap!==2?w:(n.state.gzhead=U,h):w},f.deflate=function(n,U){var T,_,y,E;if(!n||!n.state||5<U||U<0)return n?ae(n,w):w;if(_=n.state,!n.output||!n.input&&n.avail_in!==0||_.status===666&&U!==x)return ae(n,n.avail_out===0?-5:w);if(_.strm=n,T=_.last_flush,_.last_flush=U,_.status===N)if(_.wrap===2)n.adler=0,re(_,31),re(_,139),re(_,8),_.gzhead?(re(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),re(_,255&_.gzhead.time),re(_,_.gzhead.time>>8&255),re(_,_.gzhead.time>>16&255),re(_,_.gzhead.time>>24&255),re(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),re(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(re(_,255&_.gzhead.extra.length),re(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(n.adler=b(n.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(re(_,0),re(_,0),re(_,0),re(_,0),re(_,0),re(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),re(_,3),_.status=I);else{var M=j+(_.w_bits-8<<4)<<8;M|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&(M|=32),M+=31-M%31,_.status=I,V(_,M),_.strstart!==0&&(V(_,n.adler>>>16),V(_,65535&n.adler)),n.adler=1}if(_.status===69)if(_.gzhead.extra){for(y=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>y&&(n.adler=b(n.adler,_.pending_buf,_.pending-y,y)),O(n),y=_.pending,_.pending!==_.pending_buf_size));)re(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>y&&(n.adler=b(n.adler,_.pending_buf,_.pending-y,y)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(n.adler=b(n.adler,_.pending_buf,_.pending-y,y)),O(n),y=_.pending,_.pending===_.pending_buf_size)){E=1;break}E=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,re(_,E)}while(E!==0);_.gzhead.hcrc&&_.pending>y&&(n.adler=b(n.adler,_.pending_buf,_.pending-y,y)),E===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(n.adler=b(n.adler,_.pending_buf,_.pending-y,y)),O(n),y=_.pending,_.pending===_.pending_buf_size)){E=1;break}E=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,re(_,E)}while(E!==0);_.gzhead.hcrc&&_.pending>y&&(n.adler=b(n.adler,_.pending_buf,_.pending-y,y)),E===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&O(n),_.pending+2<=_.pending_buf_size&&(re(_,255&n.adler),re(_,n.adler>>8&255),n.adler=0,_.status=I)):_.status=I),_.pending!==0){if(O(n),n.avail_out===0)return _.last_flush=-1,h}else if(n.avail_in===0&&W(U)<=W(T)&&U!==x)return ae(n,-5);if(_.status===666&&n.avail_in!==0)return ae(n,-5);if(n.avail_in!==0||_.lookahead!==0||U!==v&&_.status!==666){var Z=_.strategy===2?function(z,q){for(var J;;){if(z.lookahead===0&&(he(z),z.lookahead===0)){if(q===v)return o;break}if(z.match_length=0,J=a._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,J&&(R(z,!1),z.strm.avail_out===0))return o}return z.insert=0,q===x?(R(z,!0),z.strm.avail_out===0?X:$):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?o:B}(_,U):_.strategy===3?function(z,q){for(var J,Y,se,ye,fe=z.window;;){if(z.lookahead<=G){if(he(z),z.lookahead<=G&&q===v)return o;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=F&&0<z.strstart&&(Y=fe[se=z.strstart-1])===fe[++se]&&Y===fe[++se]&&Y===fe[++se]){ye=z.strstart+G;do;while(Y===fe[++se]&&Y===fe[++se]&&Y===fe[++se]&&Y===fe[++se]&&Y===fe[++se]&&Y===fe[++se]&&Y===fe[++se]&&Y===fe[++se]&&se<ye);z.match_length=G-(ye-se),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=F?(J=a._tr_tally(z,1,z.match_length-F),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(J=a._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),J&&(R(z,!1),z.strm.avail_out===0))return o}return z.insert=0,q===x?(R(z,!0),z.strm.avail_out===0?X:$):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?o:B}(_,U):i[_.level].func(_,U);if(Z!==X&&Z!==$||(_.status=666),Z===o||Z===X)return n.avail_out===0&&(_.last_flush=-1),h;if(Z===B&&(U===1?a._tr_align(_):U!==5&&(a._tr_stored_block(_,0,0,!1),U===3&&(te(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),O(n),n.avail_out===0))return _.last_flush=-1,h}return U!==x?h:_.wrap<=0?1:(_.wrap===2?(re(_,255&n.adler),re(_,n.adler>>8&255),re(_,n.adler>>16&255),re(_,n.adler>>24&255),re(_,255&n.total_in),re(_,n.total_in>>8&255),re(_,n.total_in>>16&255),re(_,n.total_in>>24&255)):(V(_,n.adler>>>16),V(_,65535&n.adler)),O(n),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?h:1)},f.deflateEnd=function(n){var U;return n&&n.state?(U=n.state.status)!==N&&U!==69&&U!==73&&U!==91&&U!==103&&U!==I&&U!==666?ae(n,w):(n.state=null,U===I?ae(n,-3):h):w},f.deflateSetDictionary=function(n,U){var T,_,y,E,M,Z,z,q,J=U.length;if(!n||!n.state||(E=(T=n.state).wrap)===2||E===1&&T.status!==N||T.lookahead)return w;for(E===1&&(n.adler=d(n.adler,U,J,0)),T.wrap=0,J>=T.w_size&&(E===0&&(te(T.head),T.strstart=0,T.block_start=0,T.insert=0),q=new s.Buf8(T.w_size),s.arraySet(q,U,J-T.w_size,T.w_size,0),U=q,J=T.w_size),M=n.avail_in,Z=n.next_in,z=n.input,n.avail_in=J,n.next_in=0,n.input=U,he(T);T.lookahead>=F;){for(_=T.strstart,y=T.lookahead-(F-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[_+F-1])&T.hash_mask,T.prev[_&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=_,_++,--y;);T.strstart=_,T.lookahead=F-1,he(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=F-1,T.match_available=0,n.next_in=Z,n.input=z,n.avail_in=M,T.wrap=E,h},f.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,u,f){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,u,f){u.exports=function(i,s){var a,d,b,m,v,x,h,w,l,g,p,j,C,k,A,P,D,S,F,G,ee,N,I,o,B;a=i.state,d=i.next_in,o=i.input,b=d+(i.avail_in-5),m=i.next_out,B=i.output,v=m-(s-i.avail_out),x=m+(i.avail_out-257),h=a.dmax,w=a.wsize,l=a.whave,g=a.wnext,p=a.window,j=a.hold,C=a.bits,k=a.lencode,A=a.distcode,P=(1<<a.lenbits)-1,D=(1<<a.distbits)-1;e:do{C<15&&(j+=o[d++]<<C,C+=8,j+=o[d++]<<C,C+=8),S=k[j&P];t:for(;;){if(j>>>=F=S>>>24,C-=F,(F=S>>>16&255)===0)B[m++]=65535&S;else{if(!(16&F)){if(!(64&F)){S=k[(65535&S)+(j&(1<<F)-1)];continue t}if(32&F){a.mode=12;break e}i.msg="invalid literal/length code",a.mode=30;break e}G=65535&S,(F&=15)&&(C<F&&(j+=o[d++]<<C,C+=8),G+=j&(1<<F)-1,j>>>=F,C-=F),C<15&&(j+=o[d++]<<C,C+=8,j+=o[d++]<<C,C+=8),S=A[j&D];r:for(;;){if(j>>>=F=S>>>24,C-=F,!(16&(F=S>>>16&255))){if(!(64&F)){S=A[(65535&S)+(j&(1<<F)-1)];continue r}i.msg="invalid distance code",a.mode=30;break e}if(ee=65535&S,C<(F&=15)&&(j+=o[d++]<<C,(C+=8)<F&&(j+=o[d++]<<C,C+=8)),h<(ee+=j&(1<<F)-1)){i.msg="invalid distance too far back",a.mode=30;break e}if(j>>>=F,C-=F,(F=m-v)<ee){if(l<(F=ee-F)&&a.sane){i.msg="invalid distance too far back",a.mode=30;break e}if(I=p,(N=0)===g){if(N+=w-F,F<G){for(G-=F;B[m++]=p[N++],--F;);N=m-ee,I=B}}else if(g<F){if(N+=w+g-F,(F-=g)<G){for(G-=F;B[m++]=p[N++],--F;);if(N=0,g<G){for(G-=F=g;B[m++]=p[N++],--F;);N=m-ee,I=B}}}else if(N+=g-F,F<G){for(G-=F;B[m++]=p[N++],--F;);N=m-ee,I=B}for(;2<G;)B[m++]=I[N++],B[m++]=I[N++],B[m++]=I[N++],G-=3;G&&(B[m++]=I[N++],1<G&&(B[m++]=I[N++]))}else{for(N=m-ee;B[m++]=B[N++],B[m++]=B[N++],B[m++]=B[N++],2<(G-=3););G&&(B[m++]=B[N++],1<G&&(B[m++]=B[N++]))}break}}break}}while(d<b&&m<x);d-=G=C>>3,j&=(1<<(C-=G<<3))-1,i.next_in=d,i.next_out=m,i.avail_in=d<b?b-d+5:5-(d-b),i.avail_out=m<x?x-m+257:257-(m-x),a.hold=j,a.bits=C}},{}],49:[function(t,u,f){var i=t("../utils/common"),s=t("./adler32"),a=t("./crc32"),d=t("./inffast"),b=t("./inftrees"),m=1,v=2,x=0,h=-2,w=1,l=852,g=592;function p(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function C(N){var I;return N&&N.state?(I=N.state,N.total_in=N.total_out=I.total=0,N.msg="",I.wrap&&(N.adler=1&I.wrap),I.mode=w,I.last=0,I.havedict=0,I.dmax=32768,I.head=null,I.hold=0,I.bits=0,I.lencode=I.lendyn=new i.Buf32(l),I.distcode=I.distdyn=new i.Buf32(g),I.sane=1,I.back=-1,x):h}function k(N){var I;return N&&N.state?((I=N.state).wsize=0,I.whave=0,I.wnext=0,C(N)):h}function A(N,I){var o,B;return N&&N.state?(B=N.state,I<0?(o=0,I=-I):(o=1+(I>>4),I<48&&(I&=15)),I&&(I<8||15<I)?h:(B.window!==null&&B.wbits!==I&&(B.window=null),B.wrap=o,B.wbits=I,k(N))):h}function P(N,I){var o,B;return N?(B=new j,(N.state=B).window=null,(o=A(N,I))!==x&&(N.state=null),o):h}var D,S,F=!0;function G(N){if(F){var I;for(D=new i.Buf32(512),S=new i.Buf32(32),I=0;I<144;)N.lens[I++]=8;for(;I<256;)N.lens[I++]=9;for(;I<280;)N.lens[I++]=7;for(;I<288;)N.lens[I++]=8;for(b(m,N.lens,0,288,D,0,N.work,{bits:9}),I=0;I<32;)N.lens[I++]=5;b(v,N.lens,0,32,S,0,N.work,{bits:5}),F=!1}N.lencode=D,N.lenbits=9,N.distcode=S,N.distbits=5}function ee(N,I,o,B){var X,$=N.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new i.Buf8($.wsize)),B>=$.wsize?(i.arraySet($.window,I,o-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(B<(X=$.wsize-$.wnext)&&(X=B),i.arraySet($.window,I,o-B,X,$.wnext),(B-=X)?(i.arraySet($.window,I,o-B,B,0),$.wnext=B,$.whave=$.wsize):($.wnext+=X,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=X))),0}f.inflateReset=k,f.inflateReset2=A,f.inflateResetKeep=C,f.inflateInit=function(N){return P(N,15)},f.inflateInit2=P,f.inflate=function(N,I){var o,B,X,$,ae,W,te,O,R,re,V,H,he,be,oe,le,ve,ge,ke,Ee,n,U,T,_,y=0,E=new i.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return h;(o=N.state).mode===12&&(o.mode=13),ae=N.next_out,X=N.output,te=N.avail_out,$=N.next_in,B=N.input,W=N.avail_in,O=o.hold,R=o.bits,re=W,V=te,U=x;e:for(;;)switch(o.mode){case w:if(o.wrap===0){o.mode=13;break}for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(2&o.wrap&&O===35615){E[o.check=0]=255&O,E[1]=O>>>8&255,o.check=a(o.check,E,2,0),R=O=0,o.mode=2;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&O)<<8)+(O>>8))%31){N.msg="incorrect header check",o.mode=30;break}if((15&O)!=8){N.msg="unknown compression method",o.mode=30;break}if(R-=4,n=8+(15&(O>>>=4)),o.wbits===0)o.wbits=n;else if(n>o.wbits){N.msg="invalid window size",o.mode=30;break}o.dmax=1<<n,N.adler=o.check=1,o.mode=512&O?10:12,R=O=0;break;case 2:for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(o.flags=O,(255&o.flags)!=8){N.msg="unknown compression method",o.mode=30;break}if(57344&o.flags){N.msg="unknown header flags set",o.mode=30;break}o.head&&(o.head.text=O>>8&1),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,o.check=a(o.check,E,2,0)),R=O=0,o.mode=3;case 3:for(;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.head&&(o.head.time=O),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,E[2]=O>>>16&255,E[3]=O>>>24&255,o.check=a(o.check,E,4,0)),R=O=0,o.mode=4;case 4:for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.head&&(o.head.xflags=255&O,o.head.os=O>>8),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,o.check=a(o.check,E,2,0)),R=O=0,o.mode=5;case 5:if(1024&o.flags){for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.length=O,o.head&&(o.head.extra_len=O),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,o.check=a(o.check,E,2,0)),R=O=0}else o.head&&(o.head.extra=null);o.mode=6;case 6:if(1024&o.flags&&(W<(H=o.length)&&(H=W),H&&(o.head&&(n=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),i.arraySet(o.head.extra,B,$,H,n)),512&o.flags&&(o.check=a(o.check,B,H,$)),W-=H,$+=H,o.length-=H),o.length))break e;o.length=0,o.mode=7;case 7:if(2048&o.flags){if(W===0)break e;for(H=0;n=B[$+H++],o.head&&n&&o.length<65536&&(o.head.name+=String.fromCharCode(n)),n&&H<W;);if(512&o.flags&&(o.check=a(o.check,B,H,$)),W-=H,$+=H,n)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=8;case 8:if(4096&o.flags){if(W===0)break e;for(H=0;n=B[$+H++],o.head&&n&&o.length<65536&&(o.head.comment+=String.fromCharCode(n)),n&&H<W;);if(512&o.flags&&(o.check=a(o.check,B,H,$)),W-=H,$+=H,n)break e}else o.head&&(o.head.comment=null);o.mode=9;case 9:if(512&o.flags){for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(O!==(65535&o.check)){N.msg="header crc mismatch",o.mode=30;break}R=O=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),N.adler=o.check=0,o.mode=12;break;case 10:for(;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}N.adler=o.check=p(O),R=O=0,o.mode=11;case 11:if(o.havedict===0)return N.next_out=ae,N.avail_out=te,N.next_in=$,N.avail_in=W,o.hold=O,o.bits=R,2;N.adler=o.check=1,o.mode=12;case 12:if(I===5||I===6)break e;case 13:if(o.last){O>>>=7&R,R-=7&R,o.mode=27;break}for(;R<3;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}switch(o.last=1&O,R-=1,3&(O>>>=1)){case 0:o.mode=14;break;case 1:if(G(o),o.mode=20,I!==6)break;O>>>=2,R-=2;break e;case 2:o.mode=17;break;case 3:N.msg="invalid block type",o.mode=30}O>>>=2,R-=2;break;case 14:for(O>>>=7&R,R-=7&R;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if((65535&O)!=(O>>>16^65535)){N.msg="invalid stored block lengths",o.mode=30;break}if(o.length=65535&O,R=O=0,o.mode=15,I===6)break e;case 15:o.mode=16;case 16:if(H=o.length){if(W<H&&(H=W),te<H&&(H=te),H===0)break e;i.arraySet(X,B,$,H,ae),W-=H,$+=H,te-=H,ae+=H,o.length-=H;break}o.mode=12;break;case 17:for(;R<14;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(o.nlen=257+(31&O),O>>>=5,R-=5,o.ndist=1+(31&O),O>>>=5,R-=5,o.ncode=4+(15&O),O>>>=4,R-=4,286<o.nlen||30<o.ndist){N.msg="too many length or distance symbols",o.mode=30;break}o.have=0,o.mode=18;case 18:for(;o.have<o.ncode;){for(;R<3;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.lens[M[o.have++]]=7&O,O>>>=3,R-=3}for(;o.have<19;)o.lens[M[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,T={bits:o.lenbits},U=b(0,o.lens,0,19,o.lencode,0,o.work,T),o.lenbits=T.bits,U){N.msg="invalid code lengths set",o.mode=30;break}o.have=0,o.mode=19;case 19:for(;o.have<o.nlen+o.ndist;){for(;le=(y=o.lencode[O&(1<<o.lenbits)-1])>>>16&255,ve=65535&y,!((oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(ve<16)O>>>=oe,R-=oe,o.lens[o.have++]=ve;else{if(ve===16){for(_=oe+2;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(O>>>=oe,R-=oe,o.have===0){N.msg="invalid bit length repeat",o.mode=30;break}n=o.lens[o.have-1],H=3+(3&O),O>>>=2,R-=2}else if(ve===17){for(_=oe+3;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}R-=oe,n=0,H=3+(7&(O>>>=oe)),O>>>=3,R-=3}else{for(_=oe+7;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}R-=oe,n=0,H=11+(127&(O>>>=oe)),O>>>=7,R-=7}if(o.have+H>o.nlen+o.ndist){N.msg="invalid bit length repeat",o.mode=30;break}for(;H--;)o.lens[o.have++]=n}}if(o.mode===30)break;if(o.lens[256]===0){N.msg="invalid code -- missing end-of-block",o.mode=30;break}if(o.lenbits=9,T={bits:o.lenbits},U=b(m,o.lens,0,o.nlen,o.lencode,0,o.work,T),o.lenbits=T.bits,U){N.msg="invalid literal/lengths set",o.mode=30;break}if(o.distbits=6,o.distcode=o.distdyn,T={bits:o.distbits},U=b(v,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,T),o.distbits=T.bits,U){N.msg="invalid distances set",o.mode=30;break}if(o.mode=20,I===6)break e;case 20:o.mode=21;case 21:if(6<=W&&258<=te){N.next_out=ae,N.avail_out=te,N.next_in=$,N.avail_in=W,o.hold=O,o.bits=R,d(N,V),ae=N.next_out,X=N.output,te=N.avail_out,$=N.next_in,B=N.input,W=N.avail_in,O=o.hold,R=o.bits,o.mode===12&&(o.back=-1);break}for(o.back=0;le=(y=o.lencode[O&(1<<o.lenbits)-1])>>>16&255,ve=65535&y,!((oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(le&&!(240&le)){for(ge=oe,ke=le,Ee=ve;le=(y=o.lencode[Ee+((O&(1<<ge+ke)-1)>>ge)])>>>16&255,ve=65535&y,!(ge+(oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}O>>>=ge,R-=ge,o.back+=ge}if(O>>>=oe,R-=oe,o.back+=oe,o.length=ve,le===0){o.mode=26;break}if(32&le){o.back=-1,o.mode=12;break}if(64&le){N.msg="invalid literal/length code",o.mode=30;break}o.extra=15&le,o.mode=22;case 22:if(o.extra){for(_=o.extra;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.length+=O&(1<<o.extra)-1,O>>>=o.extra,R-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=23;case 23:for(;le=(y=o.distcode[O&(1<<o.distbits)-1])>>>16&255,ve=65535&y,!((oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(!(240&le)){for(ge=oe,ke=le,Ee=ve;le=(y=o.distcode[Ee+((O&(1<<ge+ke)-1)>>ge)])>>>16&255,ve=65535&y,!(ge+(oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}O>>>=ge,R-=ge,o.back+=ge}if(O>>>=oe,R-=oe,o.back+=oe,64&le){N.msg="invalid distance code",o.mode=30;break}o.offset=ve,o.extra=15&le,o.mode=24;case 24:if(o.extra){for(_=o.extra;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.offset+=O&(1<<o.extra)-1,O>>>=o.extra,R-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){N.msg="invalid distance too far back",o.mode=30;break}o.mode=25;case 25:if(te===0)break e;if(H=V-te,o.offset>H){if((H=o.offset-H)>o.whave&&o.sane){N.msg="invalid distance too far back",o.mode=30;break}he=H>o.wnext?(H-=o.wnext,o.wsize-H):o.wnext-H,H>o.length&&(H=o.length),be=o.window}else be=X,he=ae-o.offset,H=o.length;for(te<H&&(H=te),te-=H,o.length-=H;X[ae++]=be[he++],--H;);o.length===0&&(o.mode=21);break;case 26:if(te===0)break e;X[ae++]=o.length,te--,o.mode=21;break;case 27:if(o.wrap){for(;R<32;){if(W===0)break e;W--,O|=B[$++]<<R,R+=8}if(V-=te,N.total_out+=V,o.total+=V,V&&(N.adler=o.check=o.flags?a(o.check,X,V,ae-V):s(o.check,X,V,ae-V)),V=te,(o.flags?O:p(O))!==o.check){N.msg="incorrect data check",o.mode=30;break}R=O=0}o.mode=28;case 28:if(o.wrap&&o.flags){for(;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(O!==(4294967295&o.total)){N.msg="incorrect length check",o.mode=30;break}R=O=0}o.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return h}return N.next_out=ae,N.avail_out=te,N.next_in=$,N.avail_in=W,o.hold=O,o.bits=R,(o.wsize||V!==N.avail_out&&o.mode<30&&(o.mode<27||I!==4))&&ee(N,N.output,N.next_out,V-N.avail_out)?(o.mode=31,-4):(re-=N.avail_in,V-=N.avail_out,N.total_in+=re,N.total_out+=V,o.total+=V,o.wrap&&V&&(N.adler=o.check=o.flags?a(o.check,X,V,N.next_out-V):s(o.check,X,V,N.next_out-V)),N.data_type=o.bits+(o.last?64:0)+(o.mode===12?128:0)+(o.mode===20||o.mode===15?256:0),(re==0&&V===0||I===4)&&U===x&&(U=-5),U)},f.inflateEnd=function(N){if(!N||!N.state)return h;var I=N.state;return I.window&&(I.window=null),N.state=null,x},f.inflateGetHeader=function(N,I){var o;return N&&N.state&&2&(o=N.state).wrap?((o.head=I).done=!1,x):h},f.inflateSetDictionary=function(N,I){var o,B=I.length;return N&&N.state?(o=N.state).wrap!==0&&o.mode!==11?h:o.mode===11&&s(1,I,B,0)!==o.check?-3:ee(N,I,B,B)?(o.mode=31,-4):(o.havedict=1,x):h},f.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,u,f){var i=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(m,v,x,h,w,l,g,p){var j,C,k,A,P,D,S,F,G,ee=p.bits,N=0,I=0,o=0,B=0,X=0,$=0,ae=0,W=0,te=0,O=0,R=null,re=0,V=new i.Buf16(16),H=new i.Buf16(16),he=null,be=0;for(N=0;N<=15;N++)V[N]=0;for(I=0;I<h;I++)V[v[x+I]]++;for(X=ee,B=15;1<=B&&V[B]===0;B--);if(B<X&&(X=B),B===0)return w[l++]=20971520,w[l++]=20971520,p.bits=1,0;for(o=1;o<B&&V[o]===0;o++);for(X<o&&(X=o),N=W=1;N<=15;N++)if(W<<=1,(W-=V[N])<0)return-1;if(0<W&&(m===0||B!==1))return-1;for(H[1]=0,N=1;N<15;N++)H[N+1]=H[N]+V[N];for(I=0;I<h;I++)v[x+I]!==0&&(g[H[v[x+I]]++]=I);if(D=m===0?(R=he=g,19):m===1?(R=s,re-=257,he=a,be-=257,256):(R=d,he=b,-1),N=o,P=l,ae=I=O=0,k=-1,A=(te=1<<($=X))-1,m===1&&852<te||m===2&&592<te)return 1;for(;;){for(S=N-ae,G=g[I]<D?(F=0,g[I]):g[I]>D?(F=he[be+g[I]],R[re+g[I]]):(F=96,0),j=1<<N-ae,o=C=1<<$;w[P+(O>>ae)+(C-=j)]=S<<24|F<<16|G|0,C!==0;);for(j=1<<N-1;O&j;)j>>=1;if(j!==0?(O&=j-1,O+=j):O=0,I++,--V[N]==0){if(N===B)break;N=v[x+g[I]]}if(X<N&&(O&A)!==k){for(ae===0&&(ae=X),P+=o,W=1<<($=N-ae);$+ae<B&&!((W-=V[$+ae])<=0);)$++,W<<=1;if(te+=1<<$,m===1&&852<te||m===2&&592<te)return 1;w[k=O&A]=X<<24|$<<16|P-l|0}}return O!==0&&(w[P+O]=N-ae<<24|64<<16|0),p.bits=X,0}},{"../utils/common":41}],51:[function(t,u,f){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,u,f){var i=t("../utils/common"),s=0,a=1;function d(y){for(var E=y.length;0<=--E;)y[E]=0}var b=0,m=29,v=256,x=v+1+m,h=30,w=19,l=2*x+1,g=15,p=16,j=7,C=256,k=16,A=17,P=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=new Array(2*(x+2));d(ee);var N=new Array(2*h);d(N);var I=new Array(512);d(I);var o=new Array(256);d(o);var B=new Array(m);d(B);var X,$,ae,W=new Array(h);function te(y,E,M,Z,z){this.static_tree=y,this.extra_bits=E,this.extra_base=M,this.elems=Z,this.max_length=z,this.has_stree=y&&y.length}function O(y,E){this.dyn_tree=y,this.max_code=0,this.stat_desc=E}function R(y){return y<256?I[y]:I[256+(y>>>7)]}function re(y,E){y.pending_buf[y.pending++]=255&E,y.pending_buf[y.pending++]=E>>>8&255}function V(y,E,M){y.bi_valid>p-M?(y.bi_buf|=E<<y.bi_valid&65535,re(y,y.bi_buf),y.bi_buf=E>>p-y.bi_valid,y.bi_valid+=M-p):(y.bi_buf|=E<<y.bi_valid&65535,y.bi_valid+=M)}function H(y,E,M){V(y,M[2*E],M[2*E+1])}function he(y,E){for(var M=0;M|=1&y,y>>>=1,M<<=1,0<--E;);return M>>>1}function be(y,E,M){var Z,z,q=new Array(g+1),J=0;for(Z=1;Z<=g;Z++)q[Z]=J=J+M[Z-1]<<1;for(z=0;z<=E;z++){var Y=y[2*z+1];Y!==0&&(y[2*z]=he(q[Y]++,Y))}}function oe(y){var E;for(E=0;E<x;E++)y.dyn_ltree[2*E]=0;for(E=0;E<h;E++)y.dyn_dtree[2*E]=0;for(E=0;E<w;E++)y.bl_tree[2*E]=0;y.dyn_ltree[2*C]=1,y.opt_len=y.static_len=0,y.last_lit=y.matches=0}function le(y){8<y.bi_valid?re(y,y.bi_buf):0<y.bi_valid&&(y.pending_buf[y.pending++]=y.bi_buf),y.bi_buf=0,y.bi_valid=0}function ve(y,E,M,Z){var z=2*E,q=2*M;return y[z]<y[q]||y[z]===y[q]&&Z[E]<=Z[M]}function ge(y,E,M){for(var Z=y.heap[M],z=M<<1;z<=y.heap_len&&(z<y.heap_len&&ve(E,y.heap[z+1],y.heap[z],y.depth)&&z++,!ve(E,Z,y.heap[z],y.depth));)y.heap[M]=y.heap[z],M=z,z<<=1;y.heap[M]=Z}function ke(y,E,M){var Z,z,q,J,Y=0;if(y.last_lit!==0)for(;Z=y.pending_buf[y.d_buf+2*Y]<<8|y.pending_buf[y.d_buf+2*Y+1],z=y.pending_buf[y.l_buf+Y],Y++,Z===0?H(y,z,E):(H(y,(q=o[z])+v+1,E),(J=D[q])!==0&&V(y,z-=B[q],J),H(y,q=R(--Z),M),(J=S[q])!==0&&V(y,Z-=W[q],J)),Y<y.last_lit;);H(y,C,E)}function Ee(y,E){var M,Z,z,q=E.dyn_tree,J=E.stat_desc.static_tree,Y=E.stat_desc.has_stree,se=E.stat_desc.elems,ye=-1;for(y.heap_len=0,y.heap_max=l,M=0;M<se;M++)q[2*M]!==0?(y.heap[++y.heap_len]=ye=M,y.depth[M]=0):q[2*M+1]=0;for(;y.heap_len<2;)q[2*(z=y.heap[++y.heap_len]=ye<2?++ye:0)]=1,y.depth[z]=0,y.opt_len--,Y&&(y.static_len-=J[2*z+1]);for(E.max_code=ye,M=y.heap_len>>1;1<=M;M--)ge(y,q,M);for(z=se;M=y.heap[1],y.heap[1]=y.heap[y.heap_len--],ge(y,q,1),Z=y.heap[1],y.heap[--y.heap_max]=M,y.heap[--y.heap_max]=Z,q[2*z]=q[2*M]+q[2*Z],y.depth[z]=(y.depth[M]>=y.depth[Z]?y.depth[M]:y.depth[Z])+1,q[2*M+1]=q[2*Z+1]=z,y.heap[1]=z++,ge(y,q,1),2<=y.heap_len;);y.heap[--y.heap_max]=y.heap[1],function(fe,ze){var We,Oe,Ze,we,Ye,Je,Fe=ze.dyn_tree,tt=ze.max_code,it=ze.stat_desc.static_tree,ot=ze.stat_desc.has_stree,lt=ze.stat_desc.extra_bits,rt=ze.stat_desc.extra_base,He=ze.stat_desc.max_length,Ke=0;for(we=0;we<=g;we++)fe.bl_count[we]=0;for(Fe[2*fe.heap[fe.heap_max]+1]=0,We=fe.heap_max+1;We<l;We++)He<(we=Fe[2*Fe[2*(Oe=fe.heap[We])+1]+1]+1)&&(we=He,Ke++),Fe[2*Oe+1]=we,tt<Oe||(fe.bl_count[we]++,Ye=0,rt<=Oe&&(Ye=lt[Oe-rt]),Je=Fe[2*Oe],fe.opt_len+=Je*(we+Ye),ot&&(fe.static_len+=Je*(it[2*Oe+1]+Ye)));if(Ke!==0){do{for(we=He-1;fe.bl_count[we]===0;)we--;fe.bl_count[we]--,fe.bl_count[we+1]+=2,fe.bl_count[He]--,Ke-=2}while(0<Ke);for(we=He;we!==0;we--)for(Oe=fe.bl_count[we];Oe!==0;)tt<(Ze=fe.heap[--We])||(Fe[2*Ze+1]!==we&&(fe.opt_len+=(we-Fe[2*Ze+1])*Fe[2*Ze],Fe[2*Ze+1]=we),Oe--)}}(y,E),be(q,ye,y.bl_count)}function n(y,E,M){var Z,z,q=-1,J=E[1],Y=0,se=7,ye=4;for(J===0&&(se=138,ye=3),E[2*(M+1)+1]=65535,Z=0;Z<=M;Z++)z=J,J=E[2*(Z+1)+1],++Y<se&&z===J||(Y<ye?y.bl_tree[2*z]+=Y:z!==0?(z!==q&&y.bl_tree[2*z]++,y.bl_tree[2*k]++):Y<=10?y.bl_tree[2*A]++:y.bl_tree[2*P]++,q=z,ye=(Y=0)===J?(se=138,3):z===J?(se=6,3):(se=7,4))}function U(y,E,M){var Z,z,q=-1,J=E[1],Y=0,se=7,ye=4;for(J===0&&(se=138,ye=3),Z=0;Z<=M;Z++)if(z=J,J=E[2*(Z+1)+1],!(++Y<se&&z===J)){if(Y<ye)for(;H(y,z,y.bl_tree),--Y!=0;);else z!==0?(z!==q&&(H(y,z,y.bl_tree),Y--),H(y,k,y.bl_tree),V(y,Y-3,2)):Y<=10?(H(y,A,y.bl_tree),V(y,Y-3,3)):(H(y,P,y.bl_tree),V(y,Y-11,7));q=z,ye=(Y=0)===J?(se=138,3):z===J?(se=6,3):(se=7,4)}}d(W);var T=!1;function _(y,E,M,Z){V(y,(b<<1)+(Z?1:0),3),function(z,q,J,Y){le(z),re(z,J),re(z,~J),i.arraySet(z.pending_buf,z.window,q,J,z.pending),z.pending+=J}(y,E,M)}f._tr_init=function(y){T||(function(){var E,M,Z,z,q,J=new Array(g+1);for(z=Z=0;z<m-1;z++)for(B[z]=Z,E=0;E<1<<D[z];E++)o[Z++]=z;for(o[Z-1]=z,z=q=0;z<16;z++)for(W[z]=q,E=0;E<1<<S[z];E++)I[q++]=z;for(q>>=7;z<h;z++)for(W[z]=q<<7,E=0;E<1<<S[z]-7;E++)I[256+q++]=z;for(M=0;M<=g;M++)J[M]=0;for(E=0;E<=143;)ee[2*E+1]=8,E++,J[8]++;for(;E<=255;)ee[2*E+1]=9,E++,J[9]++;for(;E<=279;)ee[2*E+1]=7,E++,J[7]++;for(;E<=287;)ee[2*E+1]=8,E++,J[8]++;for(be(ee,x+1,J),E=0;E<h;E++)N[2*E+1]=5,N[2*E]=he(E,5);X=new te(ee,D,v+1,x,g),$=new te(N,S,0,h,g),ae=new te(new Array(0),F,0,w,j)}(),T=!0),y.l_desc=new O(y.dyn_ltree,X),y.d_desc=new O(y.dyn_dtree,$),y.bl_desc=new O(y.bl_tree,ae),y.bi_buf=0,y.bi_valid=0,oe(y)},f._tr_stored_block=_,f._tr_flush_block=function(y,E,M,Z){var z,q,J=0;0<y.level?(y.strm.data_type===2&&(y.strm.data_type=function(Y){var se,ye=4093624447;for(se=0;se<=31;se++,ye>>>=1)if(1&ye&&Y.dyn_ltree[2*se]!==0)return s;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return a;for(se=32;se<v;se++)if(Y.dyn_ltree[2*se]!==0)return a;return s}(y)),Ee(y,y.l_desc),Ee(y,y.d_desc),J=function(Y){var se;for(n(Y,Y.dyn_ltree,Y.l_desc.max_code),n(Y,Y.dyn_dtree,Y.d_desc.max_code),Ee(Y,Y.bl_desc),se=w-1;3<=se&&Y.bl_tree[2*G[se]+1]===0;se--);return Y.opt_len+=3*(se+1)+5+5+4,se}(y),z=y.opt_len+3+7>>>3,(q=y.static_len+3+7>>>3)<=z&&(z=q)):z=q=M+5,M+4<=z&&E!==-1?_(y,E,M,Z):y.strategy===4||q===z?(V(y,2+(Z?1:0),3),ke(y,ee,N)):(V(y,4+(Z?1:0),3),function(Y,se,ye,fe){var ze;for(V(Y,se-257,5),V(Y,ye-1,5),V(Y,fe-4,4),ze=0;ze<fe;ze++)V(Y,Y.bl_tree[2*G[ze]+1],3);U(Y,Y.dyn_ltree,se-1),U(Y,Y.dyn_dtree,ye-1)}(y,y.l_desc.max_code+1,y.d_desc.max_code+1,J+1),ke(y,y.dyn_ltree,y.dyn_dtree)),oe(y),Z&&le(y)},f._tr_tally=function(y,E,M){return y.pending_buf[y.d_buf+2*y.last_lit]=E>>>8&255,y.pending_buf[y.d_buf+2*y.last_lit+1]=255&E,y.pending_buf[y.l_buf+y.last_lit]=255&M,y.last_lit++,E===0?y.dyn_ltree[2*M]++:(y.matches++,E--,y.dyn_ltree[2*(o[M]+v+1)]++,y.dyn_dtree[2*R(E)]++),y.last_lit===y.lit_bufsize-1},f._tr_align=function(y){V(y,2,3),H(y,C,ee),function(E){E.bi_valid===16?(re(E,E.bi_buf),E.bi_buf=0,E.bi_valid=0):8<=E.bi_valid&&(E.pending_buf[E.pending++]=255&E.bi_buf,E.bi_buf>>=8,E.bi_valid-=8)}(y)}},{"../utils/common":41}],53:[function(t,u,f){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,u,f){(function(i){(function(s,a){if(!s.setImmediate){var d,b,m,v,x=1,h={},w=!1,l=s.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(s);g=g&&g.setTimeout?g:s,d={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){j(k)})}:function(){if(s.postMessage&&!s.importScripts){var k=!0,A=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=A,k}}()?(v="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",C,!1):s.attachEvent("onmessage",C),function(k){s.postMessage(v+k,"*")}):s.MessageChannel?((m=new MessageChannel).port1.onmessage=function(k){j(k.data)},function(k){m.port2.postMessage(k)}):l&&"onreadystatechange"in l.createElement("script")?(b=l.documentElement,function(k){var A=l.createElement("script");A.onreadystatechange=function(){j(k),A.onreadystatechange=null,b.removeChild(A),A=null},b.appendChild(A)}):function(k){setTimeout(j,0,k)},g.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var A=new Array(arguments.length-1),P=0;P<A.length;P++)A[P]=arguments[P+1];var D={callback:k,args:A};return h[x]=D,d(x),x++},g.clearImmediate=p}function p(k){delete h[k]}function j(k){if(w)setTimeout(j,0,k);else{var A=h[k];if(A){w=!0;try{(function(P){var D=P.callback,S=P.args;switch(S.length){case 0:D();break;case 1:D(S[0]);break;case 2:D(S[0],S[1]);break;case 3:D(S[0],S[1],S[2]);break;default:D.apply(a,S)}})(A)}finally{p(k),w=!1}}}}function C(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(v)===0&&j(+k.data.slice(v.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(jr);var Ms=jr.exports;const Ws=Br(Ms);var Nr={exports:{}};(function(r,c){(function(t,u){u()})($e,function(){function t(b,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?new Blob(["\uFEFF",b],{type:b.type}):b}function u(b,m,v){var x=new XMLHttpRequest;x.open("GET",b),x.responseType="blob",x.onload=function(){d(x.response,m,v)},x.onerror=function(){console.error("could not download file")},x.send()}function f(b){var m=new XMLHttpRequest;m.open("HEAD",b,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function i(b){try{b.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),b.dispatchEvent(m)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $e=="object"&&$e.global===$e?$e:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,m,v){var x=s.URL||s.webkitURL,h=document.createElement("a");m=m||b.name||"download",h.download=m,h.rel="noopener",typeof b=="string"?(h.href=b,h.origin===location.origin?i(h):f(h.href)?u(b,m,v):i(h,h.target="_blank")):(h.href=x.createObjectURL(b),setTimeout(function(){x.revokeObjectURL(h.href)},4e4),setTimeout(function(){i(h)},0))}:"msSaveOrOpenBlob"in navigator?function(b,m,v){if(m=m||b.name||"download",typeof b!="string")navigator.msSaveOrOpenBlob(t(b,v),m);else if(f(b))u(b,m,v);else{var x=document.createElement("a");x.href=b,x.target="_blank",setTimeout(function(){i(x)})}}:function(b,m,v,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof b=="string")return u(b,m,v);var h=b.type==="application/octet-stream",w=/constructor/i.test(s.HTMLElement)||s.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||h&&w||a)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var C=g.result;C=l?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=C:location=C,x=null},g.readAsDataURL(b)}else{var p=s.URL||s.webkitURL,j=p.createObjectURL(b);x?x.location=j:location.href=j,x=null,setTimeout(function(){p.revokeObjectURL(j)},4e4)}});s.saveAs=d.saveAs=d,r.exports=d})})(Nr);var Zs=Nr.exports;const Hs="http://localhost:5000/api",Gs=({workspaceId:r,infraSpec:c,selectedProvider:t,costEstimation:u,onComplete:f,onBack:i})=>{var F,G,ee;const[s,a]=K.useState(!0),[d,b]=K.useState(null),[m,v]=K.useState("main.tf"),[x,h]=K.useState([]),[w,l]=K.useState(null),[g,p]=K.useState(!1);K.useEffect(()=>{(async()=>{var I,o,B,X,$,ae,W,te,O;try{if(!(c!=null&&c.sizing)){console.warn("[TERRAFORM] Skipping generation - Step 3 not completed (missing sizing)"),l("Cost analysis must be completed before generating Terraform. Please go back and complete Step 3."),a(!1);return}if(!((I=c==null?void 0:c.region)!=null&&I.resolved_region)){console.warn("[TERRAFORM] Skipping generation - Step 2 region resolution not completed"),l("Region resolution must be completed before generating Terraform. Please go back and ensure Step 2 is completed."),a(!1);return}const R=(o=u.provider_details)==null?void 0:o[t],re=((B=Object.entries(u.scenarios||{}).find(([V,H])=>{var he;return((he=H[t])==null?void 0:he.monthly_cost)===(R==null?void 0:R.total_monthly_cost)}))==null?void 0:B[0])||"standard";try{const V=await Be.post(`${Hs}/workflow/terraform`,{workspace_id:r,infraSpec:c,provider:t,profile:re,project_name:c.project_name||"cloudiverse-project",requirements:{}});V.data.success&&(V.data.terraform.structure==="modular"?(b(V.data.terraform.project),console.log("[TERRAFORM] Hash:",((X=V.data.terraform_hash)==null?void 0:X.substring(0,16))+"..."),console.log("[TERRAFORM] Manifest:",V.data.deployment_manifest)):b({"main.tf":V.data.terraform.code}),h(V.data.services||[]))}catch(V){console.warn("Terraform generation failed (non-blocking):",V),console.error("[TERRAFORM ERROR] Full error:",($=V.response)==null?void 0:$.data);const H=((W=(ae=V.response)==null?void 0:ae.data)==null?void 0:W.message)||V.message||"",he=((O=(te=V.response)==null?void 0:te.data)==null?void 0:O.details)||"";if(console.error("[TERRAFORM ERROR] Message:",H),console.error("[TERRAFORM ERROR] Details:",he),H.includes("No template for pattern")||H.includes("not available")||H.includes("under construction"))p(!0),console.log("[TERRAFORM UX] Pattern template not available - showing coming soon message");else{const be=`Failed to generate Terraform code: ${H}${he?`
`+he:""}`;l(be)}throw V}}catch(R){console.error("Terraform generation failed:",R),l("Failed to generate Terraform code. Please try again.")}finally{a(!1)}})()},[r,c,t,u]);const j=()=>{if(!d)return"";const N=m.split("/");let I=d;for(const o of N)if(typeof I=="object"&&I[o])I=I[o];else return"";return typeof I=="string"?I:""},C=(N,I="")=>{let o=[];for(const[B,X]of Object.entries(N)){const $=I?`${I}/${B}`:B;typeof X=="string"?o.push($):typeof X=="object"&&(o=o.concat(C(X,$)))}return o},k=(N,I="")=>{const o=[];for(const[B,X]of Object.entries(N)){const $=I?`${I}/${B}`:B;typeof X=="string"?o.push({path:$,name:B,type:"file",depth:$.split("/").length-1}):typeof X=="object"&&(o.push({path:$,name:B,type:"folder",depth:$.split("/").length-1}),o.push(...k(X,$)))}return o},A=()=>{const N=j();navigator.clipboard.writeText(N),ce.success(`Copied ${m} to clipboard`)},P=async()=>{if(!d)return;const N=new Ws,I=c.project_name||"cloudiverse-project",o=(X,$)=>{for(const[ae,W]of Object.entries(X))if(typeof W=="string")$.file(ae,W);else if(typeof W=="object"){const te=$.folder(ae);o(W,te)}};o(d,N);const B=await N.generateAsync({type:"blob"});Zs.saveAs(B,`${I}-terraform.zip`),ce.success("Downloaded Terraform project as ZIP")};if(s)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generating Infrastructure Code"}),e.jsxs("p",{className:"text-gray-400 mt-2",children:["Creating Terraform configuration for ",t,"..."]})]})]});if(g){const N=(c==null?void 0:c.architecture_pattern)||((F=c==null?void 0:c.service_classes)==null?void 0:F.pattern_name)||"this pattern";return e.jsx("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in pb-20",children:e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6",children:[e.jsx("div",{className:"text-amber-500 text-6xl material-icons",children:"construction"}),e.jsxs("div",{className:"text-center max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Terraform Generation Coming Soon"}),e.jsxs("p",{className:"text-gray-300 text-lg mb-2",children:["Terraform generation for ",e.jsx("span",{className:"text-primary font-semibold",children:N})," is not available yet."]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Your architecture and cost estimates are saved and validated. You can continue with manual infrastructure setup or check back later for automated Terraform generation."})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-6 w-full max-w-2xl",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Your Architecture Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Pattern"}),e.jsx("span",{className:"text-white font-semibold",children:N})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Provider"}),e.jsx("span",{className:"text-white font-semibold",children:t.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Services"}),e.jsx("span",{className:"text-white font-semibold",children:((ee=(G=c==null?void 0:c.service_classes)==null?void 0:G.required_services)==null?void 0:ee.length)||0})]})]})]}),e.jsxs("button",{onClick:f,className:"mt-6 px-8 py-3 bg-primary hover:bg-primary/90 rounded-xl text-white font-semibold transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"check_circle"}),e.jsx("span",{children:"Continue to Dashboard"})]})]})})}if(w)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsx("div",{className:"text-red-500 text-6xl material-icons",children:"error_outline"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generation Failed"}),e.jsx("p",{className:"text-red-400 mt-2",children:w}),e.jsx("button",{onClick:i,className:"mt-6 px-6 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors",children:"Go Back"})]})]});d&&C(d);const D=d?k(d):[],S=j();return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Your Infrastructure Code"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Modular Terraform project for ",t]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:A,className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"content_copy"}),e.jsx("span",{className:"text-sm",children:"Copy File"})]}),e.jsxs("button",{onClick:P,className:"px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg text-primary hover:bg-primary/20 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"download"}),e.jsx("span",{className:"text-sm",children:"Download ZIP"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-1 bg-surface border border-border rounded-xl p-4 max-h-[600px] overflow-y-auto",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Project Files"}),e.jsx("div",{className:"space-y-1",children:D.map(N=>{const I=N.type==="folder",o=N.path===m,B=N.depth*16;return e.jsxs("button",{onClick:()=>!I&&v(N.path),disabled:I,className:`w-full text-left px-2 py-1.5 rounded text-xs font-mono transition-colors flex items-center space-x-2 ${I?"text-amber-400 font-semibold cursor-default":o?"bg-primary/20 text-primary border border-primary/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,style:{paddingLeft:`${8+B}px`},children:[e.jsx("span",{className:"material-icons text-xs",children:I?"folder":N.name.endsWith(".tf")?"description":N.name.endsWith(".md")?"article":"insert_drive_file"}),e.jsx("span",{className:"truncate",children:N.name})]},N.path)})})]}),e.jsxs("div",{className:"col-span-3 bg-[#1e1e1e] rounded-xl border border-white/10 overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"flex items-center px-4 py-2 bg-white/5 border-b border-white/5",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/50"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/50"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]}),e.jsx("span",{className:"ml-4 text-xs font-mono text-gray-400",children:m})]}),e.jsx("div",{className:"p-4 overflow-x-auto max-h-[550px] overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm text-gray-300 leading-relaxed",children:S||"// Select a file to view"})})]})]}),x.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Included Resources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((N,I)=>e.jsx("div",{className:"px-3 py-1.5 bg-blue-500/10 border border-blue-500/20 rounded text-xs text-blue-300 font-mono",children:N.terraform_resource||N.cloud_service||N.generic_name||N},I))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5 mt-8",children:[e.jsxs("button",{onClick:i,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back"})]}),e.jsxs("button",{onClick:f,className:"px-8 py-4 bg-primary hover:bg-primary/90 border border-primary/20 rounded-xl text-black font-bold transition-all flex items-center space-x-3",children:[e.jsx("span",{className:"material-icons",children:"check_circle"}),e.jsx("span",{children:"Continue to Deployment"})]})]})]})},qs=({workspaceId:r,infraSpec:c,costEstimation:t,onNext:u,onBack:f,onRequirementsCaptured:i})=>{const[s,a]=K.useState({nfr:{availability:"99.5",latency:"medium",compliance:[],data_residency:"",cost_ceiling_usd:null,security_level:"standard"},region:{primary_region:"us-east-1",secondary_region:"",multi_region:!1},data_classes:{},data_retention:{},deployment_strategy:"rolling",downtime_allowed:!0,observability:{logs:!0,metrics:!0,alerts:!1}}),[d,b]=K.useState("region"),m=(l,g)=>{a(p=>({...p,region:{...p.region,[l]:g}}))},v=l=>{a(g=>({...g,deployment_strategy:l}))},x=(l,g)=>{a(p=>({...p,observability:{...p.observability,[l]:g}}))},h=()=>{try{if(!s||Object.keys(s).length===0){console.error("Requirements data is empty");return}i&&i(s),u()}catch(l){console.error("Error in handleSubmit:",l)}},w=[{id:"region",label:"Region",icon:"public"},{id:"data",label:"Data",icon:"database"},{id:"deployment",label:"Deployment",icon:"build"},{id:"observability",label:"Monitoring",icon:"monitoring"}];return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"System Requirements"}),e.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Configure region, data, deployment, and monitoring settings for your infrastructure."})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-white/10 pb-4",children:w.map(l=>e.jsxs("button",{onClick:()=>b(l.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center space-x-2 ${d===l.id?"bg-primary/20 text-white border border-primary/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:l.icon}),e.jsx("span",{children:l.label})]},l.id))}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[d==="region"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Region Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Primary Region"}),e.jsxs("select",{value:s.region.primary_region,onChange:l=>m("primary_region",l.target.value),className:"w-full bg-surface border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"us-east-1",children:"US East (N. Virginia)"}),e.jsx("option",{value:"us-west-2",children:"US West (Oregon)"}),e.jsx("option",{value:"eu-west-1",children:"EU (Ireland)"}),e.jsx("option",{value:"eu-central-1",children:"EU (Frankfurt)"}),e.jsx("option",{value:"ap-southeast-1",children:"Asia Pacific (Singapore)"}),e.jsx("option",{value:"ap-northeast-1",children:"Asia Pacific (Tokyo)"}),e.jsx("option",{value:"ca-central-1",children:"Canada (Central)"}),e.jsx("option",{value:"sa-east-1",children:"South America (So Paulo)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Secondary Region (Optional)"}),e.jsxs("select",{value:s.region.secondary_region,onChange:l=>m("secondary_region",l.target.value),className:"w-full bg-surface border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"us-east-1",children:"US East (N. Virginia)"}),e.jsx("option",{value:"us-west-2",children:"US West (Oregon)"}),e.jsx("option",{value:"eu-west-1",children:"EU (Ireland)"}),e.jsx("option",{value:"eu-central-1",children:"EU (Frankfurt)"}),e.jsx("option",{value:"ap-southeast-1",children:"Asia Pacific (Singapore)"}),e.jsx("option",{value:"ap-northeast-1",children:"Asia Pacific (Tokyo)"}),e.jsx("option",{value:"ca-central-1",children:"Canada (Central)"}),e.jsx("option",{value:"sa-east-1",children:"South America (So Paulo)"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-surface/50 rounded-xl border border-border",children:[e.jsx("input",{type:"checkbox",id:"multi-region",checked:s.region.multi_region,onChange:l=>m("multi_region",l.target.checked),className:"w-5 h-5 text-primary bg-surface border-border rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"multi-region",className:"text-white",children:"Enable multi-region deployment for high availability"})]}),s.nfr.compliance.includes("GDPR")&&e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-amber-200 mb-1",children:"Data Residency Notice"}),e.jsx("p",{className:"text-sm text-amber-200/80",children:"GDPR compliance requires data to be stored within EU regions. Primary region must be EU-based."})]})]})})]}),d==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Data Classification & Retention"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Data Classification"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Classify your data types to apply appropriate security measures"}),e.jsx("div",{className:"space-y-4",children:[{type:"user_profiles",label:"User Profiles",desc:"Names, emails, personal preferences, account details"},{type:"payment_data",label:"Payment Data",desc:"Credit cards, billing info, transaction history"},{type:"documents",label:"Documents",desc:"User-uploaded files, images, videos, PDFs"},{type:"logs",label:"System Logs",desc:"Application logs, access logs, error traces"},{type:"analytics",label:"Analytics",desc:"Usage metrics, user behavior, performance data"},{type:"backup",label:"Backup Data",desc:"Backup copies, snapshots, archived data"}].map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:l.label}),e.jsx("div",{className:"text-sm text-gray-400",children:l.desc})]}),e.jsxs("select",{value:s.data_classes[l.type]||"",onChange:g=>a(p=>({...p,data_classes:{...p.data_classes,[l.type]:g.target.value}})),className:"bg-surface border border-border rounded-lg px-3 py-2 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"Unclassified"}),e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"internal",children:"Internal"}),e.jsx("option",{value:"confidential",children:"Confidential"}),e.jsx("option",{value:"restricted",children:"Restricted"})]})]},l.type))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Data Retention"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Define how long different data types should be retained"}),e.jsx("div",{className:"space-y-4",children:[{type:"user_profiles",label:"User Profiles"},{type:"payment_data",label:"Payment Data"},{type:"logs",label:"System Logs"},{type:"analytics",label:"Analytics Data"}].map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsx("div",{children:e.jsx("div",{className:"font-medium text-white",children:l.label})}),e.jsx("input",{type:"text",placeholder:"e.g., 7 years, 90 days",value:s.data_retention[l.type]||"",onChange:g=>a(p=>({...p,data_retention:{...p.data_retention,[l.type]:g.target.value}})),className:"bg-surface border border-border rounded-lg px-3 py-2 text-white focus:outline-none focus:border-primary w-40"})]},l.type))})]})]})]}),d==="deployment"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Deployment Strategy"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Deployment Strategy"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[{value:"rolling",label:"Rolling",desc:"Instances updated gradually, minimal risk"},{value:"blue-green",label:"Blue/Green",desc:"Zero downtime with instant rollback capability"},{value:"canary",label:"Canary",desc:"Test with small traffic before full rollout"},{value:"batch",label:"Batch",desc:"All instances updated at once, fastest but risky"}].map(l=>e.jsxs("div",{onClick:()=>v(l.value),className:`p-4 rounded-xl border cursor-pointer transition-all ${s.deployment_strategy===l.value?"border-primary bg-primary/10 text-white":"border-white/10 text-gray-400 hover:border-white/20 hover:bg-white/5"}`,children:[e.jsx("div",{className:"font-medium",children:l.label}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:l.desc})]},l.value))})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-surface/50 rounded-xl border border-border",children:[e.jsx("input",{type:"checkbox",id:"downtime-allowed",checked:s.downtime_allowed,onChange:l=>a(g=>({...g,downtime_allowed:l.target.checked})),className:"w-5 h-5 text-primary bg-surface border-border rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"downtime-allowed",className:"text-white",children:"Downtime is allowed during deployment"})]}),e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-blue-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Strategy Recommendations"}),e.jsxs("p",{className:"text-sm text-blue-200/80",children:[" High availability systems: Blue/Green or Canary",e.jsx("br",{})," Development systems: Rolling",e.jsx("br",{})," Batch: Only for non-critical systems"]})]})]})})]})]}),d==="observability"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Observability & Monitoring"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Application Logging"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Capture application and system logs"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.logs,onChange:l=>x("logs",l.target.checked),className:"sr-only",id:"logs-toggle"}),e.jsx("label",{htmlFor:"logs-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.logs?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.logs?"transform translate-x-6":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Infrastructure Metrics"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Monitor CPU, memory, disk, and network"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.metrics,onChange:l=>x("metrics",l.target.checked),className:"sr-only",id:"metrics-toggle"}),e.jsx("label",{htmlFor:"metrics-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.metrics?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.metrics?"transform translate-x-6":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Alerting System"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Get notified of issues and anomalies"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.alerts,onChange:l=>x("alerts",l.target.checked),className:"sr-only",id:"alerts-toggle"}),e.jsx("label",{htmlFor:"alerts-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.alerts?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.alerts?"transform translate-x-6":""}`})})]})]})]}),e.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-green-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-green-200 mb-1",children:"Observability Benefits"}),e.jsx("p",{className:"text-sm text-green-200/80",children:"Monitoring and logging are essential for production systems. They help identify issues before they impact users."})]})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back"})]}),e.jsxs("button",{onClick:h,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Continue to Architecture"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]})},kr=({id:r,x:c,y:t,width:u,height:f,style:i,color:s,strokeColor:a,strokeWidth:d,className:b,borderRadius:m,shapeRendering:v,onClick:x,selected:h})=>{const{background:w,backgroundColor:l}=i||{},g=s||w||l;return Le.createElement("rect",{className:mr(["react-flow__minimap-node",{selected:h},b]),x:c,y:t,rx:m,ry:m,width:u,height:f,fill:g,stroke:a,strokeWidth:d,shapeRendering:v,onClick:x?p=>x(p,r):void 0})};kr.displayName="MiniMapNode";var Vs=K.memo(kr);const Ys=r=>r.nodeOrigin,Ks=r=>r.getNodes().filter(c=>!c.hidden&&c.width&&c.height),yt=r=>r instanceof Function?r:()=>r;function Xs({nodeStrokeColor:r="transparent",nodeColor:c="#e2e2e2",nodeClassName:t="",nodeBorderRadius:u=5,nodeStrokeWidth:f=2,nodeComponent:i=Vs,onClick:s}){const a=wt(Ks,pr),d=wt(Ys),b=yt(c),m=yt(r),v=yt(t),x=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Le.createElement(Le.Fragment,null,a.map(h=>{const{x:w,y:l}=Hr(h,d).positionAbsolute;return Le.createElement(i,{key:h.id,x:w,y:l,width:h.width,height:h.height,style:h.style,selected:h.selected,className:v(h),color:b(h),borderRadius:u,strokeColor:m(h),strokeWidth:f,shapeRendering:x,onClick:s,id:h.id})}))}var Js=K.memo(Xs);const Qs=200,ea=150,ta=r=>{const c=r.getNodes(),t={x:-r.transform[0]/r.transform[2],y:-r.transform[1]/r.transform[2],width:r.width/r.transform[2],height:r.height/r.transform[2]};return{viewBB:t,boundingRect:c.length>0?Gr(qr(c,r.nodeOrigin),t):t,rfId:r.rfId}},ra="react-flow__minimap-desc";function Cr({style:r,className:c,nodeStrokeColor:t="transparent",nodeColor:u="#e2e2e2",nodeClassName:f="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:a,maskColor:d="rgb(240, 240, 240, 0.6)",maskStrokeColor:b="none",maskStrokeWidth:m=1,position:v="bottom-right",onClick:x,onNodeClick:h,pannable:w=!1,zoomable:l=!1,ariaLabel:g="React Flow mini map",inversePan:p=!1,zoomStep:j=10,offsetScale:C=5}){const k=Ur(),A=K.useRef(null),{boundingRect:P,viewBB:D,rfId:S}=wt(ta,pr),F=(r==null?void 0:r.width)??Qs,G=(r==null?void 0:r.height)??ea,ee=P.width/F,N=P.height/G,I=Math.max(ee,N),o=I*F,B=I*G,X=C*I,$=P.x-(o-P.width)/2-X,ae=P.y-(B-P.height)/2-X,W=o+X*2,te=B+X*2,O=`${ra}-${S}`,R=K.useRef(0);R.current=I,K.useEffect(()=>{if(A.current){const H=$r(A.current),he=le=>{const{transform:ve,d3Selection:ge,d3Zoom:ke}=k.getState();if(le.sourceEvent.type!=="wheel"||!ge||!ke)return;const Ee=-le.sourceEvent.deltaY*(le.sourceEvent.deltaMode===1?.05:le.sourceEvent.deltaMode?1:.002)*j,n=ve[2]*Math.pow(2,Ee);ke.scaleTo(ge,n)},be=le=>{const{transform:ve,d3Selection:ge,d3Zoom:ke,translateExtent:Ee,width:n,height:U}=k.getState();if(le.sourceEvent.type!=="mousemove"||!ge||!ke)return;const T=R.current*Math.max(1,ve[2])*(p?-1:1),_={x:ve[0]-le.sourceEvent.movementX*T,y:ve[1]-le.sourceEvent.movementY*T},y=[[0,0],[n,U]],E=Wr.translate(_.x,_.y).scale(ve[2]),M=ke.constrain()(E,y,Ee);ke.transform(ge,M)},oe=Lr().on("zoom",w?be:null).on("zoom.wheel",l?he:null);return H.call(oe),()=>{H.on("zoom",null)}}},[w,l,p,j]);const re=x?H=>{const he=Zr(H);x(H,{x:he[0],y:he[1]})}:void 0,V=h?(H,he)=>{const be=k.getState().nodeInternals.get(he);h(H,be)}:void 0;return Le.createElement(Mr,{position:v,style:r,className:mr(["react-flow__minimap",c]),"data-testid":"rf__minimap"},Le.createElement("svg",{width:F,height:G,viewBox:`${$} ${ae} ${W} ${te}`,role:"img","aria-labelledby":O,ref:A,onClick:re},g&&Le.createElement("title",{id:O},g),Le.createElement(Js,{onClick:V,nodeColor:u,nodeStrokeColor:t,nodeBorderRadius:i,nodeClassName:f,nodeStrokeWidth:s,nodeComponent:a}),Le.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-X},${ae-X}h${W+X*2}v${te+X*2}h${-W-X*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fill:d,fillRule:"evenodd",stroke:b,strokeWidth:m,pointerEvents:"none"})))}Cr.displayName="MiniMap";var sa=K.memo(Cr);function aa(r,c){if(r.match(/^[a-z]+:\/\//i))return r;if(r.match(/^\/\//))return window.location.protocol+r;if(r.match(/^[a-z]+:/i))return r;const t=document.implementation.createHTMLDocument(),u=t.createElement("base"),f=t.createElement("a");return t.head.appendChild(u),t.body.appendChild(f),c&&(u.href=c),f.href=r,f.href}const na=(()=>{let r=0;const c=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(r+=1,`u${c()}${r}`)})();function qe(r){const c=[];for(let t=0,u=r.length;t<u;t++)c.push(r[t]);return c}let Qe=null;function Sr(r={}){return Qe||(r.includeStyleProperties?(Qe=r.includeStyleProperties,Qe):(Qe=qe(window.getComputedStyle(document.documentElement)),Qe))}function ft(r,c){const u=(r.ownerDocument.defaultView||window).getComputedStyle(r).getPropertyValue(c);return u?parseFloat(u.replace("px","")):0}function ia(r){const c=ft(r,"border-left-width"),t=ft(r,"border-right-width");return r.clientWidth+c+t}function oa(r){const c=ft(r,"border-top-width"),t=ft(r,"border-bottom-width");return r.clientHeight+c+t}function Er(r,c={}){const t=c.width||ia(r),u=c.height||oa(r);return{width:t,height:u}}function la(){let r,c;try{c=process}catch{}const t=c&&c.env?c.env.devicePixelRatio:null;return t&&(r=parseInt(t,10),Number.isNaN(r)&&(r=1)),r||window.devicePixelRatio||1}const Te=16384;function ca(r){(r.width>Te||r.height>Te)&&(r.width>Te&&r.height>Te?r.width>r.height?(r.height*=Te/r.width,r.width=Te):(r.width*=Te/r.height,r.height=Te):r.width>Te?(r.height*=Te/r.width,r.width=Te):(r.width*=Te/r.height,r.height=Te))}function mt(r){return new Promise((c,t)=>{const u=new Image;u.onload=()=>{u.decode().then(()=>{requestAnimationFrame(()=>c(u))})},u.onerror=t,u.crossOrigin="anonymous",u.decoding="async",u.src=r})}async function da(r){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(r)).then(encodeURIComponent).then(c=>`data:image/svg+xml;charset=utf-8,${c}`)}async function ua(r,c,t){const u="http://www.w3.org/2000/svg",f=document.createElementNS(u,"svg"),i=document.createElementNS(u,"foreignObject");return f.setAttribute("width",`${c}`),f.setAttribute("height",`${t}`),f.setAttribute("viewBox",`0 0 ${c} ${t}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),f.appendChild(i),i.appendChild(r),da(f)}const Ie=(r,c)=>{if(r instanceof c)return!0;const t=Object.getPrototypeOf(r);return t===null?!1:t.constructor.name===c.name||Ie(t,c)};function ha(r){const c=r.getPropertyValue("content");return`${r.cssText} content: '${c.replace(/'|"/g,"")}';`}function fa(r,c){return Sr(c).map(t=>{const u=r.getPropertyValue(t),f=r.getPropertyPriority(t);return`${t}: ${u}${f?" !important":""};`}).join(" ")}function ma(r,c,t,u){const f=`.${r}:${c}`,i=t.cssText?ha(t):fa(t,u);return document.createTextNode(`${f}{${i}}`)}function or(r,c,t,u){const f=window.getComputedStyle(r,t),i=f.getPropertyValue("content");if(i===""||i==="none")return;const s=na();try{c.className=`${c.className} ${s}`}catch{return}const a=document.createElement("style");a.appendChild(ma(s,t,f,u)),c.appendChild(a)}function pa(r,c,t){or(r,c,":before",t),or(r,c,":after",t)}const lr="application/font-woff",cr="image/jpeg",xa={woff:lr,woff2:lr,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:cr,jpeg:cr,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ga(r){const c=/\.([^./]*?)$/g.exec(r);return c?c[1]:""}function St(r){const c=ga(r).toLowerCase();return xa[c]||""}function ba(r){return r.split(/,/)[1]}function Nt(r){return r.search(/^(data:)/)!==-1}function ya(r,c){return`data:${c};base64,${r}`}async function Ar(r,c,t){const u=await fetch(r,c);if(u.status===404)throw new Error(`Resource "${u.url}" not found`);const f=await u.blob();return new Promise((i,s)=>{const a=new FileReader;a.onerror=s,a.onloadend=()=>{try{i(t({res:u,result:a.result}))}catch(d){s(d)}},a.readAsDataURL(f)})}const vt={};function va(r,c,t){let u=r.replace(/\?.*/,"");return t&&(u=r),/ttf|otf|eot|woff2?/i.test(u)&&(u=u.replace(/.*\//,"")),c?`[${c}]${u}`:u}async function Et(r,c,t){const u=va(r,c,t.includeQueryParams);if(vt[u]!=null)return vt[u];t.cacheBust&&(r+=(/\?/.test(r)?"&":"?")+new Date().getTime());let f;try{const i=await Ar(r,t.fetchRequestInit,({res:s,result:a})=>(c||(c=s.headers.get("Content-Type")||""),ba(a)));f=ya(i,c)}catch(i){f=t.imagePlaceholder||"";let s=`Failed to fetch resource: ${r}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return vt[u]=f,f}async function wa(r){const c=r.toDataURL();return c==="data:,"?r.cloneNode(!1):mt(c)}async function _a(r,c){if(r.currentSrc){const i=document.createElement("canvas"),s=i.getContext("2d");i.width=r.clientWidth,i.height=r.clientHeight,s==null||s.drawImage(r,0,0,i.width,i.height);const a=i.toDataURL();return mt(a)}const t=r.poster,u=St(t),f=await Et(t,u,c);return mt(f)}async function ja(r,c){var t;try{if(!((t=r==null?void 0:r.contentDocument)===null||t===void 0)&&t.body)return await gt(r.contentDocument.body,c,!0)}catch{}return r.cloneNode(!1)}async function Na(r,c){return Ie(r,HTMLCanvasElement)?wa(r):Ie(r,HTMLVideoElement)?_a(r,c):Ie(r,HTMLIFrameElement)?ja(r,c):r.cloneNode(Rr(r))}const ka=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SLOT",Rr=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SVG";async function Ca(r,c,t){var u,f;if(Rr(c))return c;let i=[];return ka(r)&&r.assignedNodes?i=qe(r.assignedNodes()):Ie(r,HTMLIFrameElement)&&(!((u=r.contentDocument)===null||u===void 0)&&u.body)?i=qe(r.contentDocument.body.childNodes):i=qe(((f=r.shadowRoot)!==null&&f!==void 0?f:r).childNodes),i.length===0||Ie(r,HTMLVideoElement)||await i.reduce((s,a)=>s.then(()=>gt(a,t)).then(d=>{d&&c.appendChild(d)}),Promise.resolve()),c}function Sa(r,c,t){const u=c.style;if(!u)return;const f=window.getComputedStyle(r);f.cssText?(u.cssText=f.cssText,u.transformOrigin=f.transformOrigin):Sr(t).forEach(i=>{let s=f.getPropertyValue(i);i==="font-size"&&s.endsWith("px")&&(s=`${Math.floor(parseFloat(s.substring(0,s.length-2)))-.1}px`),Ie(r,HTMLIFrameElement)&&i==="display"&&s==="inline"&&(s="block"),i==="d"&&c.getAttribute("d")&&(s=`path(${c.getAttribute("d")})`),u.setProperty(i,s,f.getPropertyPriority(i))})}function Ea(r,c){Ie(r,HTMLTextAreaElement)&&(c.innerHTML=r.value),Ie(r,HTMLInputElement)&&c.setAttribute("value",r.value)}function Aa(r,c){if(Ie(r,HTMLSelectElement)){const t=c,u=Array.from(t.children).find(f=>r.value===f.getAttribute("value"));u&&u.setAttribute("selected","")}}function Ra(r,c,t){return Ie(c,Element)&&(Sa(r,c,t),pa(r,c,t),Ea(r,c),Aa(r,c)),c}async function za(r,c){const t=r.querySelectorAll?r.querySelectorAll("use"):[];if(t.length===0)return r;const u={};for(let i=0;i<t.length;i++){const a=t[i].getAttribute("xlink:href");if(a){const d=r.querySelector(a),b=document.querySelector(a);!d&&b&&!u[a]&&(u[a]=await gt(b,c,!0))}}const f=Object.values(u);if(f.length){const i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";const a=document.createElementNS(i,"defs");s.appendChild(a);for(let d=0;d<f.length;d++)a.appendChild(f[d]);r.appendChild(s)}return r}async function gt(r,c,t){return!t&&c.filter&&!c.filter(r)?null:Promise.resolve(r).then(u=>Na(u,c)).then(u=>Ca(r,u,c)).then(u=>Ra(r,u,c)).then(u=>za(u,c))}const zr=/url\((['"]?)([^'"]+?)\1\)/g,Ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Oa=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Ta(r){const c=r.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${c})(['"]?\\))`,"g")}function Fa(r){const c=[];return r.replace(zr,(t,u,f)=>(c.push(f),t)),c.filter(t=>!Nt(t))}async function Ba(r,c,t,u,f){try{const i=t?aa(c,t):c,s=St(c);let a;return f||(a=await Et(i,s,u)),r.replace(Ta(c),`$1${a}$3`)}catch{}return r}function Da(r,{preferredFontFormat:c}){return c?r.replace(Oa,t=>{for(;;){const[u,,f]=Ia.exec(t)||[];if(!f)return"";if(f===c)return`src: ${u};`}}):r}function Ir(r){return r.search(zr)!==-1}async function Or(r,c,t){if(!Ir(r))return r;const u=Da(r,t);return Fa(u).reduce((i,s)=>i.then(a=>Ba(a,s,c,t)),Promise.resolve(u))}async function et(r,c,t){var u;const f=(u=c.style)===null||u===void 0?void 0:u.getPropertyValue(r);if(f){const i=await Or(f,null,t);return c.style.setProperty(r,i,c.style.getPropertyPriority(r)),!0}return!1}async function Pa(r,c){await et("background",r,c)||await et("background-image",r,c),await et("mask",r,c)||await et("-webkit-mask",r,c)||await et("mask-image",r,c)||await et("-webkit-mask-image",r,c)}async function Ua(r,c){const t=Ie(r,HTMLImageElement);if(!(t&&!Nt(r.src))&&!(Ie(r,SVGImageElement)&&!Nt(r.href.baseVal)))return;const u=t?r.src:r.href.baseVal,f=await Et(u,St(u),c);await new Promise((i,s)=>{r.onload=i,r.onerror=c.onImageErrorHandler?(...d)=>{try{i(c.onImageErrorHandler(...d))}catch(b){s(b)}}:s;const a=r;a.decode&&(a.decode=i),a.loading==="lazy"&&(a.loading="eager"),t?(r.srcset="",r.src=f):r.href.baseVal=f})}async function $a(r,c){const u=qe(r.childNodes).map(f=>Tr(f,c));await Promise.all(u).then(()=>r)}async function Tr(r,c){Ie(r,Element)&&(await Pa(r,c),await Ua(r,c),await $a(r,c))}function La(r,c){const{style:t}=r;c.backgroundColor&&(t.backgroundColor=c.backgroundColor),c.width&&(t.width=`${c.width}px`),c.height&&(t.height=`${c.height}px`);const u=c.style;return u!=null&&Object.keys(u).forEach(f=>{t[f]=u[f]}),r}const dr={};async function ur(r){let c=dr[r];if(c!=null)return c;const u=await(await fetch(r)).text();return c={url:r,cssText:u},dr[r]=c,c}async function hr(r,c){let t=r.cssText;const u=/url\(["']?([^"')]+)["']?\)/g,i=(t.match(/url\([^)]+\)/g)||[]).map(async s=>{let a=s.replace(u,"$1");return a.startsWith("https://")||(a=new URL(a,r.url).href),Ar(a,c.fetchRequestInit,({result:d})=>(t=t.replace(s,`url(${d})`),[s,d]))});return Promise.all(i).then(()=>t)}function fr(r){if(r==null)return[];const c=[],t=/(\/\*[\s\S]*?\*\/)/gi;let u=r.replace(t,"");const f=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=f.exec(u);if(d===null)break;c.push(d[0])}u=u.replace(f,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(s,"gi");for(;;){let d=i.exec(u);if(d===null){if(d=a.exec(u),d===null)break;i.lastIndex=a.lastIndex}else a.lastIndex=i.lastIndex;c.push(d[0])}return c}async function Ma(r,c){const t=[],u=[];return r.forEach(f=>{if("cssRules"in f)try{qe(f.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let a=s+1;const d=i.href,b=ur(d).then(m=>hr(m,c)).then(m=>fr(m).forEach(v=>{try{f.insertRule(v,v.startsWith("@import")?a+=1:f.cssRules.length)}catch(x){console.error("Error inserting rule from remote css",{rule:v,error:x})}})).catch(m=>{console.error("Error loading remote css",m.toString())});u.push(b)}})}catch(i){const s=r.find(a=>a.href==null)||document.styleSheets[0];f.href!=null&&u.push(ur(f.href).then(a=>hr(a,c)).then(a=>fr(a).forEach(d=>{s.insertRule(d,s.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",i)}}),Promise.all(u).then(()=>(r.forEach(f=>{if("cssRules"in f)try{qe(f.cssRules||[]).forEach(i=>{t.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${f.href}`,i)}}),t))}function Wa(r){return r.filter(c=>c.type===CSSRule.FONT_FACE_RULE).filter(c=>Ir(c.style.getPropertyValue("src")))}async function Za(r,c){if(r.ownerDocument==null)throw new Error("Provided element is not within a Document");const t=qe(r.ownerDocument.styleSheets),u=await Ma(t,c);return Wa(u)}function Fr(r){return r.trim().replace(/["']/g,"")}function Ha(r){const c=new Set;function t(u){(u.style.fontFamily||getComputedStyle(u).fontFamily).split(",").forEach(i=>{c.add(Fr(i))}),Array.from(u.children).forEach(i=>{i instanceof HTMLElement&&t(i)})}return t(r),c}async function Ga(r,c){const t=await Za(r,c),u=Ha(r);return(await Promise.all(t.filter(i=>u.has(Fr(i.style.fontFamily))).map(i=>{const s=i.parentStyleSheet?i.parentStyleSheet.href:null;return Or(i.cssText,s,c)}))).join(`
`)}async function qa(r,c){const t=c.fontEmbedCSS!=null?c.fontEmbedCSS:c.skipFonts?null:await Ga(r,c);if(t){const u=document.createElement("style"),f=document.createTextNode(t);u.appendChild(f),r.firstChild?r.insertBefore(u,r.firstChild):r.appendChild(u)}}async function Va(r,c={}){const{width:t,height:u}=Er(r,c),f=await gt(r,c,!0);return await qa(f,c),await Tr(f,c),La(f,c),await ua(f,t,u)}async function Ya(r,c={}){const{width:t,height:u}=Er(r,c),f=await Va(r,c),i=await mt(f),s=document.createElement("canvas"),a=s.getContext("2d"),d=c.pixelRatio||la(),b=c.canvasWidth||t,m=c.canvasHeight||u;return s.width=b*d,s.height=m*d,c.skipAutoScale||ca(s),s.style.width=`${b}`,s.style.height=`${m}`,c.backgroundColor&&(a.fillStyle=c.backgroundColor,a.fillRect(0,0,s.width,s.height)),a.drawImage(i,0,0,s.width,s.height),s}async function Ka(r,c={}){return(await Ya(r,c)).toDataURL()}const kt={client:{bg:"#4B5563",border:"#9CA3AF",text:"#F9FAFB"},network:{bg:"#1E40AF",border:"#3B82F6",text:"#DBEAFE"},compute:{bg:"#7C3AED",border:"#A78BFA",text:"#EDE9FE"},database:{bg:"#059669",border:"#10B981",text:"#D1FAE5"},storage:{bg:"#DC2626",border:"#EF4444",text:"#FEE2E2"},security:{bg:"#EA580C",border:"#F97316",text:"#FFEDD5"},messaging:{bg:"#DB2777",border:"#EC4899",text:"#FCE7F3"},observability:{bg:"#0891B2",border:"#06B6D4",text:"#CFFAFE"},integration:{bg:"#65A30D",border:"#84CC16",text:"#ECFCCB"},other:{bg:"#6B7280",border:"#9CA3AF",text:"#F3F4F6"}},Xa={client:"",cdn:"",load_balancer:"",api_gateway:"",websocket_gateway:"",app_compute:"",serverless_compute:"",compute_container:"",compute_vm:"",batch_compute:"",ml_inference_service:"",relational_database:"",nosql_database:"",analytical_database:"",cache:"",object_storage:"",block_storage:"",identity_auth:"",message_queue:"",messaging_queue:"",event_bus:"",logging:"",monitoring:"",payment_gateway:"",push_notification_service:"",secrets_management:"",networking:""};function Ja(r,c,t="LR"){const u=new nr.graphlib.Graph;return u.setDefaultEdgeLabel(()=>({})),u.setGraph({rankdir:t,nodesep:100,ranksep:150,marginx:50,marginy:50}),r.forEach(i=>{u.setNode(i.id,{width:200,height:80})}),c.forEach(i=>{u.setEdge(i.source,i.target)}),nr.layout(u),{nodes:r.map(i=>{const s=u.node(i.id);return{...i,position:{x:s.x-100,y:s.y-40}}}),edges:c}}function Qa(r){if(!(r!=null&&r.architecture))return{nodes:[],edges:[]};const{nodes:c=[],edges:t=[]}=r.architecture,u=c.map(i=>{const s=i.category||"other",a=kt[s]||kt.other,d=Xa[i.type]||"";return{id:i.id,type:"default",data:{label:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-1 p-3",children:[e.jsx("div",{className:"text-2xl",children:d}),e.jsx("div",{className:"text-xs font-bold text-center leading-tight",style:{color:a.text},children:i.label}),i.role&&e.jsx("div",{className:"text-[9px] opacity-70 italic",style:{color:a.text},children:i.role.replace(/_/g," ")})]})},position:{x:0,y:0},style:{background:a.bg,border:`2px solid ${a.border}`,borderRadius:"12px",padding:"8px",width:200,height:80,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 12px ${a.border}40`},draggable:!1}}),f=t.map((i,s)=>({id:`edge-${s}`,source:i.from,target:i.to,label:i.label||"",type:"smoothstep",animated:!0,style:{stroke:"#6B7280",strokeWidth:2},labelStyle:{fill:"#9CA3AF",fontSize:11,fontWeight:600},labelBgStyle:{fill:"#1F2937",fillOpacity:.8}}));return{nodes:u,edges:f}}const en=({architectureData:r,provider:c,pattern:t})=>{const{nodes:u,edges:f}=K.useMemo(()=>Qa(r),[r,c]),{nodes:i,edges:s}=K.useMemo(()=>Ja(u,f),[u,f]),[a,d,b]=Vr(i),[m,v,x]=Yr(s),h=K.useCallback(()=>{const w=document.querySelector(".react-flow");if(!w){console.error("Diagram element not found");return}Ka(w,{backgroundColor:"#0F172A",width:w.offsetWidth,height:w.offsetHeight,style:{width:`${w.offsetWidth}px`,height:`${w.offsetHeight}px`}}).then(l=>{const g=document.createElement("a");g.download=`architecture-${c}-${t}-${Date.now()}.png`,g.href=l,g.click()}).catch(l=>{console.error("Failed to export diagram:",l),alert("Failed to export diagram. Please try again.")})},[c,t]);return a.length===0?e.jsx("div",{className:"bg-black/20 rounded-xl p-12 min-h-[500px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("span",{className:"material-icons text-gray-500 text-6xl",children:"cloud_off"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No architecture data available"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:h,className:"px-4 py-2 bg-primary/20 border border-primary/40 text-primary rounded-lg hover:bg-primary/30 transition-colors flex items-center space-x-2 text-sm font-semibold",children:[e.jsx("span",{className:"material-icons text-lg",children:"download"}),e.jsx("span",{children:"Download PNG"})]})}),e.jsx("div",{className:"bg-[#0F172A] rounded-xl border border-white/10 overflow-hidden",style:{height:"600px"},children:e.jsxs(Kr,{nodes:a,edges:m,onNodesChange:b,onEdgesChange:x,fitView:!0,fitViewOptions:{padding:.2},minZoom:.5,maxZoom:2,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnDrag:!0,zoomOnScroll:!0,preventScrolling:!0,children:[e.jsx(Xr,{color:"#1E293B",gap:20,size:1}),e.jsx(Jr,{showInteractive:!1,style:{background:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(sa,{nodeColor:w=>(w.style||{}).background||"#6B7280",maskColor:"#0F172A99",style:{background:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}})]})}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Service Categories"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(kt).map(([w,l])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{background:l.bg,border:`2px solid ${l.border}`}}),e.jsx("span",{className:"text-xs text-gray-300 capitalize",children:w})]},w))})]})]})},tn="http://localhost:5000/api",rn=({workspaceId:r,infraSpec:c,costEstimation:t,selectedProvider:u,selectedProfile:f,usageProfile:i,requirementsData:s,architectureData:a,onArchitectureDataLoaded:d,onNext:b,onBack:m})=>{var l;const[v,x]=K.useState(!0),[h,w]=K.useState(null);return K.useEffect(()=>{(async()=>{if(!(!c||!u||!f))try{const p=localStorage.getItem("token"),j=p?{Authorization:`Bearer ${p}`}:{},C=await Be.post(`${tn}/workflow/architecture`,{workspace_id:r,infraSpec:c,provider:u,profile:f,usage_profile:(i==null?void 0:i.usage_profile)||{},intent:(c==null?void 0:c.locked_intent)||{},requirements:s||{}},{headers:j});if(!C.data||!C.data.data)throw new Error("Invalid response structure from architecture endpoint");d&&d(C.data.data),w(null)}catch(p){console.error("Architecture loading error:",p),w("Failed to load architecture diagram. Using fallback view."),ce.error("Failed to load architecture diagram")}finally{x(!1)}})()},[r,c,u,f,i,s,d]),h?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design"}),e.jsx("p",{className:"text-gray-400",children:"Architecture diagram could not be loaded, but you can continue to Terraform generation."})]}),e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"warning"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-200 mb-1",children:"Architecture Not Available"}),e.jsx("p",{className:"text-sm text-amber-200/80",children:"The architecture diagram could not be generated, but your infrastructure specification is ready for Terraform generation."})]})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:m,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Cost"})]}),e.jsxs("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Continue to Feedback"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]}):v&&!a?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design Confirmation"}),e.jsx("p",{className:"text-gray-400",children:"Generating your cloud architecture diagram..."})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generating Architecture"}),e.jsx("p",{className:"text-gray-400",children:"Creating your provider-specific diagram..."})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design Confirmation"}),e.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"This architecture reflects the recommended setup based on your requirements and usage."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Provider"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold
                            ${u==="AWS"?"bg-[#FF9900]/20 text-[#FF9900]":u==="GCP"?"bg-[#4285F4]/20 text-[#4285F4]":"bg-[#0078D4]/20 text-[#0078D4]"}`,children:u==="AWS"?"AWS":u==="GCP"?"GCP":"AZ"}),e.jsx("div",{children:e.jsx("div",{className:"font-bold text-white text-lg",children:u==="AZURE"?"Azure":u})})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Scenario"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/20 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-primary",children:"tune"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white text-lg capitalize",children:f==null?void 0:f.replace("_"," ")}),e.jsx("div",{className:"text-xs text-gray-400",children:"Cost optimization profile"})]})]})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"design_services"}),"Architecture Diagram"]}),e.jsx(en,{architectureData:a,provider:u,pattern:(c==null?void 0:c.architecture_pattern)||"SERVERLESS_WEB_APP"}),e.jsx("div",{className:"text-xs text-gray-500 mt-4 text-center italic",children:'Interactive architecture diagram. Use mouse wheel to zoom, drag to pan. Click "Download PNG" to export.'})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"inventory"}),"Services Used (",u==="AZURE"?"Azure":u,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(l=a==null?void 0:a.services)==null?void 0:l.map((g,p)=>{var j;return e.jsx("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:g.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:g.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 capitalize",children:[g.category," service"]})]}),e.jsx("div",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full capitalize",children:(j=g.type)==null?void 0:j.replace("_"," ")})]})},p)})})]}),(a==null?void 0:a.notes)&&e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"sticky_note_2"}),"Architecture Notes"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.notes.map((g,p)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-primary text-sm mt-0.5",children:"info"}),e.jsx("p",{className:"text-sm text-gray-300",children:g})]},p))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:m,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Cost"})]}),e.jsxs("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Confirm Architecture"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]})},Xe="http://localhost:5000",cn=()=>{var T,_,y,E,M,Z,z,q,J,Y,se,ye,fe,ze,We,Oe,Ze,we,Ye,Je,Fe,tt,it,ot,lt,rt,He,Ke,At,Rt,zt,It,Ot,Tt,Ft,Bt,Dt,Pt,Ut,$t,Lt,Mt,Wt,Zt,Ht,Gt,qt,Vt,Yt,Kt,Xt,Jt,Qt,er,tr,rr,sr,ar;const{id:r}=Dr(),c=Pr(),[t,u]=K.useState("input"),[f,i]=K.useState(""),[s,a]=K.useState([]),[d,b]=K.useState(null),[m,v]=K.useState(null),[x,h]=K.useState(null),[w,l]=K.useState(!1),[g,p]=K.useState(null),[j,C]=K.useState(!1),[k,A]=K.useState(null),[P,D]=K.useState(null),[S,F]=K.useState(null),[G,ee]=K.useState("cost_effective"),[N,I]=K.useState(r==="new"?null:r),[o,B]=K.useState(null),[X,$]=K.useState(null),[ae,W]=K.useState(!1),[te,O]=K.useState(null),[R,re]=K.useState(!1),[V,H]=K.useState(!1),[he,be]=K.useState(!1),[oe,le]=K.useState("");K.useEffect(()=>{S&&oe&&f!==oe?H(!0):S&&oe&&f===oe&&H(!1)},[f,oe,S]);const ve=async()=>{if(k){console.log("Usage profile already exists, skipping redundant AI call."),u("usage_review");return}l(!0),u("processing_usage");try{const L=localStorage.getItem("token"),Q=L?{Authorization:`Bearer ${L}`}:{},ne=await Be.post(`${Xe}/api/workflow/predict-usage`,{intent:P,infraSpec:m},{headers:Q});setTimeout(()=>{A(ne.data.data),u("usage_review"),l(!1),ce.success("Usage estimates generated!")},1e3)}catch(L){console.error("Usage Prediction Error:",L),l(!1),u("review_spec"),ce.error("Failed to estimate usage. Skipping to manual mode.")}},ge=async()=>{var L,Q,ne,ue,xe,de,_e,Ae,je,Ce,pe;if(!m||!P){ce.error("Missing infrastructure data. Please restart.");return}l(!0),u("processing_cost"),ce.loading("Analyzing costs across providers...",{id:"cost-analysis"});try{const me=localStorage.getItem("token"),ie=me?{Authorization:`Bearer ${me}`}:{},Ne={infraSpec:m,intent:P,cost_profile:G,usage_profile:{...k==null?void 0:k.usage_profile,source:he?"user_provided":"ai_inferred"}};H(!1),le(f);const De=await Be.post(`${Xe}/api/workflow/cost-analysis`,Ne,{headers:ie});if(ce.dismiss("cost-analysis"),De.data.step==="cost_estimation")setTimeout(()=>{var st;const Re=De.data.data;F(Re),Re.sizing&&v(at=>({...at,sizing:Re.sizing})),B(((st=Re.recommended)==null?void 0:st.provider)||Re.recommended_provider),u("cost_estimation"),ce.success("Cost analysis complete!")},100);else throw new Error("Unexpected response from cost analysis")}catch(me){console.error("[COST ANALYSIS ERROR]",me),ce.dismiss("cost-analysis"),u("usage_review");let ie="Failed to analyze costs.";((L=me.response)==null?void 0:L.status)===400?ie=((ne=(Q=me.response)==null?void 0:Q.data)==null?void 0:ne.msg)||"Invalid infrastructure data. Please review your architecture.":((ue=me.response)==null?void 0:ue.status)===401?(ie="Session expired. Please login again.",setTimeout(()=>c("/"),1500)):((xe=me.response)==null?void 0:xe.status)===500?ie=((_e=(de=me.response)==null?void 0:de.data)==null?void 0:_e.error)||"Server error during cost calculation. Please try again.":me.code==="ECONNABORTED"?ie="Cost analysis timed out. Please try again.":me.response?ie=((je=(Ae=me.response)==null?void 0:Ae.data)==null?void 0:je.msg)||((pe=(Ce=me.response)==null?void 0:Ce.data)==null?void 0:pe.error)||ie:ie="Cannot reach cost analysis service. Check your connection.",ce.error(ie,{duration:6e3,icon:""})}finally{l(!1)}};K.useEffect(()=>{(async()=>{var Q,ne,ue,xe;if(r)try{const de=localStorage.getItem("token"),_e=de?{Authorization:`Bearer ${de}`}:{},je=(await Be.get(`${Xe}/api/workspaces/${r}`,{headers:_e})).data;if(((((ne=(Q=je.state_json)==null?void 0:Q.deployment)==null?void 0:ne.status)||je.step)==="active"||je.step==="active_deployment")&&(re(!0),console.log("[WORKSPACE] Deployed workspace - editing disabled")),I(je.id),h({id:je.project_id,name:je.name}),je.state_json){const pe=je.state_json;let me=pe.step||je.step||"input";me==="confirm_intent"&&(me="input"),u(me),i(pe.description||""),a(pe.history||[]),b(pe.currentQuestion||null),v(pe.infraSpec||null),pe.aiSnapshot&&D(pe.aiSnapshot),pe.costEstimation&&F(pe.costEstimation),pe.costProfile&&ee(pe.costProfile),pe.selectedProvider?B(pe.selectedProvider):(xe=(ue=pe.costEstimation)==null?void 0:ue.recommended)!=null&&xe.provider&&B(pe.costEstimation.recommended.provider),pe.projectData&&h(ie=>({...ie,...pe.projectData}))}le(f),console.log("Workspace loaded:",je.name)}catch(de){console.error("Load Error:",de),de.response?de.response.status===401?(ce.error("Session expired. Please login again."),c("/")):de.response.status===403?(ce.error("You do not have permission to view this workspace."),c("/workspaces")):de.response.status===404?(ce.error("Workspace not found. It may have been deleted."),c("/workspaces")):ce.error("Failed to load workspace. Server error."):ce.error("Connection failed. Please check your internet.")}})()},[r,c]);const ke=async()=>{var L,Q,ne,ue,xe,de,_e,Ae,je,Ce,pe;if(!f.trim()){ce.error("Please describe your project first!");return}l(!0),u("processing");try{const me=localStorage.getItem("token"),ie=me?{Authorization:`Bearer ${me}`}:{},Ne=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:f,conversationHistory:s,input_type:"DESCRIPTION"},{headers:ie});setTimeout(()=>{const{step:De,data:Re}=Ne.data;l(!1),Re!=null&&Re.full_analysis&&D(Re.full_analysis),De==="refine_requirements"?(b(Re),u("question")):De==="confirm_intent"?(b(Re),u("confirm_intent")):De==="infra_spec_generated"?(v(Re),h({name:Re.project_name}),u("review_spec"),ce.success("Architecture Generated Successfully!")):(console.warn("Unknown Step:",De),!De&&!Re&&(ce.error("Server returned empty response."),u("input")))},1200)}catch(me){console.error("[ANALYZE ERROR]",me),l(!1),u("input");let ie="Failed to analyze your request.";((L=me.response)==null?void 0:L.status)===401?(ie="Your session has expired. Please login again.",ce.error(ie,{duration:4e3}),setTimeout(()=>c("/"),1500)):((Q=me.response)==null?void 0:Q.status)===400?(ie=((ue=(ne=me.response)==null?void 0:ne.data)==null?void 0:ue.msg)||((de=(xe=me.response)==null?void 0:xe.data)==null?void 0:de.error)||"Invalid request. Please check your input.",ce.error(ie,{duration:5e3})):((_e=me.response)==null?void 0:_e.status)===500?(ie="Server error occurred. Please try again or contact support.",ce.error(ie,{duration:5e3})):me.code==="ECONNABORTED"||me.message.includes("timeout")?(ie="Request timeout. Please check your connection and try again.",ce.error(ie,{duration:5e3})):me.response?(ie=((je=(Ae=me.response)==null?void 0:Ae.data)==null?void 0:je.msg)||((pe=(Ce=me.response)==null?void 0:Ce.data)==null?void 0:pe.error)||ie,ce.error(ie,{duration:5e3})):(ie="Cannot connect to server. Please check your internet connection.",ce.error(ie,{duration:5e3}))}},Ee=async L=>{var Q,ne,ue,xe,de,_e,Ae,je,Ce,pe,me;l(!0),u("processing");try{const ie=localStorage.getItem("token"),Ne=ie?{Authorization:`Bearer ${ie}`}:{},De=f||(x==null?void 0:x.name)||"User confirmed intent",Re=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:De,conversationHistory:s,input_type:"CONFIRMATION",approvedIntent:L},{headers:Ne});setTimeout(()=>{const{step:st,data:at}=Re.data;l(!1),st==="refine_requirements"?(b(at),u("question")):st==="infra_spec_generated"&&(v(at),h({name:at.project_name}),u("review_spec"),ce.success("Architecture Generated Successfully!"))},1e3)}catch(ie){console.error("[CONFIRMATION ERROR]",ie),l(!1),u("confirm_intent");let Ne="Failed to confirm and generate architecture.";((Q=ie.response)==null?void 0:Q.status)===400?Ne=((ue=(ne=ie.response)==null?void 0:ne.data)==null?void 0:ue.msg)||((de=(xe=ie.response)==null?void 0:xe.data)==null?void 0:de.error)||"Invalid confirmation data. Please try again.":((_e=ie.response)==null?void 0:_e.status)===401?(Ne="Session expired. Please login again.",setTimeout(()=>c("/"),1500)):((Ae=ie.response)==null?void 0:Ae.status)===500?Ne="Server error during architecture generation. Please try again.":ie.response?Ne=((Ce=(je=ie.response)==null?void 0:je.data)==null?void 0:Ce.msg)||((me=(pe=ie.response)==null?void 0:pe.data)==null?void 0:me.error)||Ne:Ne="Network error. Please check your connection.",ce.error(Ne,{duration:5e3})}},n=async L=>{p(L),setTimeout(async()=>{var ne,ue,xe,de,_e,Ae,je;const Q=[...s,{role:"user",content:f},{role:"assistant",content:d.clarifying_question},{role:"user",content:L}];a(Q),b(null),p(null),l(!0),u("processing_spec");try{const Ce=localStorage.getItem("token"),pe=Ce?{Authorization:`Bearer ${Ce}`}:{},me=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:f,conversationHistory:Q,input_type:"AXIS_ANSWER",ai_snapshot:P||(d==null?void 0:d.full_analysis)},{headers:pe});setTimeout(()=>{const{step:ie,data:Ne}=me.data;l(!1),Ne!=null&&Ne.full_analysis&&D(Ne.full_analysis),ie==="refine_requirements"?(b(Ne),u("question")):ie==="confirm_intent"?(b(Ne),u("confirm_intent")):ie==="infra_spec_generated"&&(v(Ne),h({name:Ne.project_name}),u("review_spec"),ce.success("Architecture Refined & Generated!"))},1200)}catch(Ce){console.error("[ANSWER QUESTION ERROR]",Ce),l(!1),u("question");let pe="Failed to process your answer.";((ne=Ce.response)==null?void 0:ne.status)===400?pe="Invalid answer format. Please select a valid option.":((ue=Ce.response)==null?void 0:ue.status)===401?(pe="Session expired. Redirecting to login...",setTimeout(()=>c("/"),1500)):((xe=Ce.response)==null?void 0:xe.status)===500?pe="Server error processing your answer. Please try again.":Ce.response?pe=((_e=(de=Ce.response)==null?void 0:de.data)==null?void 0:_e.msg)||((je=(Ae=Ce.response)==null?void 0:Ae.data)==null?void 0:je.error)||pe:pe="Network error. Please check your connection.",ce.error(pe,{duration:5e3})}},600)},U=async(L=!1)=>{var Q,ne;try{const ue=localStorage.getItem("token"),xe={workspaceId:N,projectId:x==null?void 0:x.id,name:(x==null?void 0:x.name)||`Draft ${new Date().toLocaleTimeString()}`,step:t,state:{history:s,description:f,currentQuestion:d,infraSpec:m,projectData:x,aiSnapshot:P,costEstimation:S,costProfile:G,step:t}},de=ue?{Authorization:`Bearer ${ue}`}:{},_e=await Be.post(`${Xe}/api/workspaces/save`,xe,{headers:de});I(_e.data.workspaceId),_e.data.projectId&&h(Ae=>({...Ae,id:_e.data.projectId})),L||ce.success(`Draft ${N?"Updated":"Saved"} Successfully!`)}catch(ue){if(console.error("Save Error:",ue),!L){const xe=((ne=(Q=ue.response)==null?void 0:Q.data)==null?void 0:ne.msg)||ue.message||"Unknown error";ce.error(`Failed to save draft: ${xe}`)}}};return K.useEffect(()=>{if(t&&N&&t!=="input"&&t!=="processing"){const L=setTimeout(()=>{U(!0),console.log(`[Auto-save] Step: ${t}`)},1500);return()=>clearTimeout(L)}},[t,m,S]),e.jsxs("div",{className:"flex h-screen bg-background text-white font-inter overflow-hidden relative selection:bg-primary/30",children:[e.jsx($s,{position:"top-right",toastOptions:{style:{background:"var(--color-surface, #171E2B)",color:"#fff",border:"1px solid var(--color-border, #2E3645)"}}}),e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-primary/5 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[30%] h-[30%] bg-blue-500/5 rounded-full blur-[100px]"})]}),e.jsx("div",{className:"w-64 bg-surface/80 backdrop-blur-xl border-r border-border flex flex-col justify-between p-6 hidden md:flex z-10",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-primary font-bold text-xl tracking-tight",children:[e.jsx("span",{className:"material-icons text-2xl",children:"cloud_circle"}),e.jsx("span",{children:"Cloudiverse"})]}),e.jsxs("nav",{className:"space-y-3",children:[e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all cursor-pointer 
                            ${t==="input"||t==="question"||t==="processing"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":"text-gray-400 hover:bg-white/5"}`,onClick:()=>u("input"),children:[e.jsx("span",{className:"material-icons text-sm",children:"edit_note"}),e.jsx("span",{children:"Requirements"}),m&&t!=="input"&&t!=="question"&&t!=="processing"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="review_spec"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!m&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(m||R)&&u("review_spec"),children:[e.jsx("span",{className:"material-icons text-sm",children:"schema"}),e.jsx("span",{children:"Specification"}),(m||R)&&t!=="review_spec"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="cost_estimation"||t==="processing_cost"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!m&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(S||R)&&u("cost_estimation"),children:[e.jsx("span",{className:"material-icons text-sm",children:"savings"}),e.jsx("span",{children:"Cost Estimator"}),(S||R)&&t!=="cost_estimation"&&t!=="processing_cost"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="architecture"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!S&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(S||R)&&u("architecture"),children:[e.jsx("span",{className:"material-icons text-sm",children:"design_services"}),e.jsx("span",{children:"Architecture"}),(X||R)&&t!=="architecture"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="terraform_view"||t==="deployment_ready"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!ae&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(ae||R)&&u("terraform_view"),children:[e.jsx("span",{className:"material-icons text-sm",children:"code"}),e.jsx("span",{children:"Terraform"}),(ae||R)&&t!=="terraform_view"&&t!=="deployment_ready"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:"px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all cursor-pointer text-gray-400 hover:bg-white/5",onClick:()=>c(`/workspace/${N}/settings`),children:[e.jsx("span",{className:"material-icons text-sm",children:"settings"}),e.jsx("span",{children:"Settings"})]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col relative overflow-y-auto z-10 backdrop-blur-sm",children:[e.jsxs("header",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-black/20 backdrop-blur-md sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-lg font-medium text-gray-200 tracking-wide",children:(x==null?void 0:x.name)||"Untitled Project"}),e.jsx("div",{className:"flex items-center space-x-2",children:R?e.jsxs("span",{className:"px-3 py-1 rounded-full bg-green-500/10 border border-green-500/20 text-[10px] font-bold text-green-400 tracking-wider uppercase flex items-center space-x-1",children:[e.jsx("span",{className:"material-icons text-[10px]",children:"check_circle"}),e.jsx("span",{children:"Deployed"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold text-gray-400 tracking-wider uppercase",children:"Draft Mode"}),e.jsxs("button",{onClick:()=>U(!1),className:"px-3 py-1 rounded-full bg-primary/10 border border-primary/20 text-[10px] font-bold text-primary hover:bg-primary/20 transition-colors uppercase tracking-wider flex items-center space-x-1",children:[e.jsx("span",{className:"material-icons text-[10px]",children:"save"}),e.jsx("span",{children:N?"Update Draft":"Save Draft"})]})]})})]}),e.jsxs("button",{onClick:()=>c("/workspaces"),className:"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-sm font-medium text-gray-400 hover:bg-white/10 hover:text-white transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"dashboard"}),e.jsx("span",{children:"Workspace Dashboard"})]})]}),e.jsx("div",{className:"flex-1 p-8 flex",children:e.jsxs("div",{className:"w-full max-w-5xl space-y-12 mx-auto",children:[V&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 flex items-center justify-between animate-shake",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"material-icons text-yellow-500",children:"warning"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("b",{children:"Assumption Drift:"})," The project description has changed. Previous cost estimates may no longer be valid."]})]}),e.jsx("button",{onClick:()=>ke(),className:"px-4 py-2 bg-yellow-500 text-black font-bold text-xs rounded-lg hover:bg-yellow-400 transition-colors",children:"Re-Analyze"})]}),(t==="processing"||t==="processing_spec")&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-white/10 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-primary rounded-full border-t-transparent animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-4xl text-white animate-pulse",children:"grain"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t==="processing"?"Analyzing Intent...":"Generating Blueprint..."}),e.jsx("p",{className:"text-gray-400 animate-pulse",children:"Architecting your production-grade infrastructure"})]})]}),t==="input"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up mt-10",children:[R&&e.jsxs("div",{className:"bg-green-500/10 border-2 border-green-500/30 rounded-2xl p-6 flex items-start space-x-4 shadow-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"material-icons text-green-400 text-4xl",children:"check_circle"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-green-400 mb-2 flex items-center space-x-2",children:[e.jsx("span",{children:"Project Successfully Deployed"}),e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-300 text-xs rounded-full",children:"Read-Only Mode"})]}),e.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:"This workspace has been deployed and is now in read-only mode. You can view all details and download Terraform files, but cannot modify the architecture or configuration."})]})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-200 to-gray-500 tracking-tight",children:R?"Deployed Architecture":"Architect Your Vision"}),e.jsx("p",{className:"text-lg text-gray-400 max-w-2xl mx-auto leading-relaxed",children:R?"Review your deployed infrastructure configuration below.":"Describe your application in plain English. Our AI Discovery Engine will analyze your intent and generate a production-grade infrastructure specification."})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary to-blue-600 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"}),e.jsxs("div",{className:"relative bg-surface border border-border rounded-2xl p-2 shadow-2xl",children:[e.jsx("textarea",{className:"w-full h-48 bg-transparent text-xl p-8 focus:outline-none resize-none placeholder-gray-600 text-gray-200 font-light leading-relaxed disabled:opacity-60 disabled:cursor-not-allowed",placeholder:"e.g., I need a highly scalable e-commerce backend with microservices, handling 50k concurrent users, and strict PCI compliance...",value:f,onChange:L=>i(L.target.value),disabled:R,readOnly:R}),e.jsxs("div",{className:"flex justify-between items-center px-8 py-5 bg-white/5 rounded-b-xl border-t border-white/5",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 disabled:opacity-40 disabled:cursor-not-allowed",disabled:R,children:e.jsx("span",{className:"material-icons text-xl",children:"mic"})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 disabled:opacity-40 disabled:cursor-not-allowed",disabled:R,children:e.jsx("span",{className:"material-icons text-xl",children:"attach_file"})})]}),!R&&e.jsxs("button",{onClick:ke,className:"flex items-center space-x-3 px-8 py-3 bg-primary hover:bg-primary-hover text-black font-bold rounded-xl transition-all transform hover:scale-[1.02] shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Generate Architecture"}),e.jsx("span",{className:"material-icons text-lg",children:"auto_awesome"})]})]})]})]})]}),t==="question"&&d&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up max-w-2xl mx-auto mt-12 pb-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"material-icons text-primary text-3xl",children:"psychology"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Clarifying Requirements"}),e.jsx("p",{className:"text-gray-400",children:d.clarifying_question})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:(T=d.suggested_options)==null?void 0:T.map((L,Q)=>e.jsxs("button",{onClick:()=>n(typeof L=="object"?L.value||L.label:L),className:`p-6 bg-surface border rounded-2xl text-left transition-all group relative overflow-hidden
                                                ${g===(typeof L=="object"?L.value||L.label:L)?"border-primary ring-1 ring-primary":"border-border hover:border-white/20"}`,children:[e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:typeof L=="object"?L.label:L}),L.description&&e.jsx("div",{className:"text-sm text-gray-400 line-clamp-2",children:L.description})]}),e.jsx("span",{className:"material-icons text-gray-600 group-hover:text-primary transition-colors",children:"arrow_forward"})]}),g===(typeof L=="object"?L.value||L.label:L)&&e.jsx("div",{className:"absolute inset-0 bg-primary/5 animate-pulse"})]},Q))})]}),t==="confirm_intent"&&d&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up max-w-3xl mx-auto mt-12 pb-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Confirm Project Scope"}),e.jsx("p",{className:"text-gray-400",children:"We've analyzed your requirements. Please confirm this summary before we generate the infrastructure."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-3xl p-8 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full blur-[100px] -mr-32 -mt-32"}),e.jsxs("div",{className:"space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/10 border border-primary/20 text-primary rounded-full text-[10px] font-bold uppercase tracking-widest",children:"AI Intent Snapshot"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:"Confirmed"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:"Excluded"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Goal"}),e.jsx("p",{className:"text-white font-medium capitalize prose prose-invert",children:((y=(_=d.intent)==null?void 0:_.primary_domain)==null?void 0:y.replace(/_/g," "))||"Building an application"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Workload Pattern"}),e.jsx("p",{className:"text-white/80 text-sm italic",children:((M=(E=d.intent)==null?void 0:E.workload_type)==null?void 0:M.replace(/_/g," "))||"Standard Workload"})]}),d.exclusions&&d.exclusions.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-red-500/70 uppercase tracking-widest mb-2 flex items-center",children:[e.jsx("span",{className:"material-icons text-xs mr-1",children:"block"}),"Explicit Exclusions"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.exclusions.map((L,Q)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/10 text-red-400 border border-red-500/20 rounded text-[10px] font-bold uppercase tracking-wider line-through decoration-red-500/50",children:L.replace(/_/g," ")},Q))})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 rounded-2xl p-5 border border-white/5",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Feature Resolution"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[10px] text-green-500 font-bold uppercase",children:"Confirmed Present"}),e.jsxs("ul",{className:"grid grid-cols-1 gap-1.5",children:[Object.entries(d.features||{}).filter(([L,Q])=>Q===!0).map(([L,Q],ne)=>e.jsxs("li",{className:"flex items-center text-xs text-gray-200 bg-green-500/5 px-2 py-1 rounded",children:[e.jsx("span",{className:"material-icons text-[12px] text-green-500 mr-2",children:"check_circle"}),e.jsx("span",{className:"capitalize",children:L.replace(/_/g," ")})]},ne)),Object.values(d.features||{}).filter(L=>L===!0).length===0&&e.jsx("li",{className:"text-xs text-gray-500 italic",children:"None detected."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 font-bold uppercase",children:"What we did NOT assume"}),e.jsx("ul",{className:"grid grid-cols-1 gap-1.5 opacity-60",children:Object.entries(d.features||{}).filter(([L,Q])=>Q==="unknown"||Q===!1).map(([L,Q],ne)=>e.jsxs("li",{className:"flex items-center text-xs text-gray-400",children:[e.jsx("span",{className:"material-icons text-[12px] text-gray-600 mr-2",children:Q===!1?"block":"help_outline"}),e.jsx("span",{className:"capitalize",children:L.replace(/_/g," ")})]},ne))})]})]})]})})]}),e.jsxs("div",{className:"pt-6 border-t border-white/5 flex flex-col space-y-4",children:[e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:[e.jsx("span",{className:"material-icons text-[10px] align-middle mr-1",children:"lock"}),"Confirming locks this intent as the ",e.jsx("b",{children:"Single Source of Truth"}),"."]}),e.jsxs("button",{onClick:()=>Ee(d.full_analysis),className:"w-full py-4 bg-primary hover:bg-primary-hover text-black font-extrabold rounded-2xl transition-all transform hover:scale-[1.01] shadow-xl shadow-primary/20 flex items-center justify-center space-x-3",children:[e.jsx("span",{children:"Confirm & Generate Blueprint"}),e.jsx("span",{className:"material-icons",children:"rocket_launch"})]})]})]})]})]}),t==="review_spec"&&m&&e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary/5 rounded-full blur-[60px] -mr-10 -mt-10"}),e.jsx("button",{onClick:()=>c(`/workspace/${N}/settings`),className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors rounded-lg p-2 hover:bg-white/5",children:e.jsx("span",{className:"material-icons text-sm",children:"settings"})}),e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Project Snapshot"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 relative z-10",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Project Name"}),e.jsx("div",{className:"text-xl font-bold text-white tracking-tight flex items-center space-x-2 group",children:e.jsx("span",{children:(x==null?void 0:x.name)||m.project_name||"My Cloud Project"})}),e.jsxs("div",{className:"mt-2 group",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",title:x==null?void 0:x.description,children:(x==null?void 0:x.description)||m.project_summary||f||"No description provided."})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Project Type"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 bg-white/5 rounded-full text-sm text-gray-300 border border-white/5",children:[e.jsx("span",{className:"material-icons text-xs",children:"category"}),e.jsx("span",{className:"capitalize",children:((Z=m.architecture_pattern)==null?void 0:Z.replace(/_/g," "))||"Web App"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Client Type"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 bg-white/5 rounded-full text-sm text-gray-300 border border-white/5",children:[e.jsx("span",{className:"material-icons text-xs",children:"devices"}),e.jsx("span",{className:"capitalize",children:((z=P==null?void 0:P.intent)==null?void 0:z.client_type)||"Web"})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(P==null?void 0:P.features)&&Object.entries(P.features).filter(([L,Q])=>Q===!0).map(([L])=>e.jsx("span",{className:"px-2 py-1 bg-blue-500/10 text-blue-400 border border-blue-500/20 rounded text-[10px] font-bold uppercase tracking-wider",children:L.replace(/_/g," ")},L))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 text-xs font-bold",children:""}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"How we understood your project"})]}),e.jsxs("div",{className:"bg-surface/50 border border-border rounded-2xl p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(q=m.explanations)==null?void 0:q.slice(0,4).map((L,Q)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mt-0.5",children:"check"}),e.jsx("span",{className:"text-sm text-gray-300 leading-relaxed",children:L})]},Q)),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mt-0.5",children:"check"}),e.jsxs("span",{className:"text-sm text-gray-300 leading-relaxed",children:["Traffic scale assumption: ",e.jsx("span",{className:"text-white font-medium",children:((J=m.assumptions)==null?void 0:J.traffic_tier)||"Medium"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4 italic",children:"Based on your description and selected options."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-primary",children:"schema"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Architecture Overview"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 relative overflow-hidden group hover:border-primary/30 transition-all duration-500",children:[e.jsxs("p",{className:"text-white font-medium text-lg leading-relaxed border-b border-white/5 pb-4 mb-6",children:['"',m.project_summary||"Optimized cloud infrastructure.",'"']}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Included Services & Infrastructure"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(Y=m.modules)==null?void 0:Y.map((L,Q)=>e.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/20 transition-colors",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mr-3",children:L.category==="compute"?"memory":L.category==="storage"?"storage":L.category==="database"?"database":"cloud"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-bold text-white",children:L.service_name||L.type}),e.jsx("div",{className:"text-xs text-primary/80 uppercase font-bold tracking-wider",children:L.category})]})]},Q))})]}),e.jsxs("div",{className:"flex items-start space-x-2 bg-blue-500/5 p-4 rounded-xl border border-blue-500/10",children:[e.jsx("span",{className:"material-icons text-blue-400 text-sm mt-0.5",children:"info"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["This architecture is designed for ",e.jsx("strong",{children:(se=m.assumptions)==null?void 0:se.traffic_tier})," traffic. Proceed to usage estimation to see detailed costs."]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:ve,disabled:w,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50",children:[e.jsx("span",{children:"Estimate Usage & Costs"}),e.jsx("span",{className:"material-icons",children:"analytics"})]})})]}),t==="processing_usage"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Analyzing Usage Patterns"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"AI is predicting realistic user traffic, storage, and bandwidth..."})]})]}),t==="usage_review"&&k&&e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Estimated Usage Profile"}),e.jsxs("p",{className:"text-gray-400 max-w-2xl mx-auto",children:['Based on your project description ("',x==null?void 0:x.name,`"), we've inferred the following usage patterns to generate accurate costs.`]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-primary/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-primary/20 group-hover:text-primary/40 transition-colors text-4xl",children:"group"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Scale: Monthly Users"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-primary outline-none transition-colors",value:k.usage_profile.monthly_users.min,onChange:L=>{const Q=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,monthly_users:{...k.usage_profile.monthly_users,min:Q}}}),be(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-primary outline-none transition-colors",value:k.usage_profile.monthly_users.max,onChange:L=>{const Q=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,monthly_users:{...k.usage_profile.monthly_users,max:Q}}}),be(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[10px] text-green-400 font-bold uppercase tracking-wider",children:"Expected Traffic"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((ye=k.rationale)==null?void 0:ye.monthly_users)||"Based on typical growth for this workload type.",'"']})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-blue-500/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-blue-500/20 group-hover:text-blue-500/40 transition-colors text-4xl",children:"swap_horiz"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Network: Data Transfer (GB)"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-blue-500 outline-none transition-colors",value:k.usage_profile.data_transfer_gb.min,onChange:L=>{const Q=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,data_transfer_gb:{...k.usage_profile.data_transfer_gb,min:Q}}}),be(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-blue-500 outline-none transition-colors",value:k.usage_profile.data_transfer_gb.max,onChange:L=>{const Q=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,data_transfer_gb:{...k.usage_profile.data_transfer_gb,max:Q}}}),be(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-wider",children:"Egress/Bandwidth"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((fe=k.rationale)==null?void 0:fe.data_transfer_gb)||"Simulates content delivery and API interactions.",'"']})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-purple-500/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-purple-500/20 group-hover:text-purple-500/40 transition-colors text-4xl",children:"storage"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Capacity: Storage (GB)"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-purple-500 outline-none transition-colors",value:k.usage_profile.data_storage_gb.min,onChange:L=>{const Q=parseInt(L.target.value)||0;A(ne=>({...ne,usage_profile:{...ne.usage_profile,data_storage_gb:{...ne.usage_profile.data_storage_gb,min:Q}}})),be(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-purple-500 outline-none transition-colors",value:k.usage_profile.data_storage_gb.max,onChange:L=>{const Q=parseInt(L.target.value)||0;A(ne=>({...ne,usage_profile:{...ne.usage_profile,data_storage_gb:{...ne.usage_profile.data_storage_gb,max:Q}}})),be(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),e.jsx("span",{className:"text-[10px] text-purple-400 font-bold uppercase tracking-wider",children:"Data Footprint"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((ze=k.rationale)==null?void 0:ze.data_storage_gb)||((We=k.rationale)==null?void 0:We.storage_gb)||"Accounts for both database and file assets.",'"']})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>u("review_spec"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Architecture"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("button",{onClick:()=>{ee("cost_effective"),ge()},disabled:w,className:"px-8 py-4 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-green-500/20 disabled:opacity-50",children:[e.jsx("span",{children:"Cost Effective"}),e.jsx("span",{className:"material-icons",children:"trending_down"})]}),e.jsxs("button",{onClick:()=>{ee("high_performance"),ge()},disabled:w,className:"px-8 py-4 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-blue-500/20 disabled:opacity-50",children:[e.jsx("span",{children:"High Performance"}),e.jsx("span",{className:"material-icons",children:"speed"})]})]})]})]}),t==="cost_estimation"&&S&&e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-primary",children:"cloud"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Cloud Provider Comparison"})]}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:"Select a provider to see specific details"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(S.rankings||[]).map(L=>{var ne;const Q=o===L.provider;return e.jsxs("div",{onClick:()=>B(L.provider),className:`cursor-pointer rounded-2xl p-5 border transition-all relative overflow-hidden flex flex-col justify-between
                                                        ${Q?"bg-primary/10 border-primary shadow-lg shadow-primary/20 scale-[1.02]":"bg-surface border-border hover:border-white/20"}`,children:[L.recommended&&e.jsx("div",{className:"absolute top-0 right-0 px-3 py-1 bg-gradient-to-r from-yellow-400 to-amber-500 text-[10px] font-bold text-black uppercase tracking-tighter rounded-bl-xl shadow-lg",children:"Recommended"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold
                                                            ${L.provider==="AWS"?"bg-[#FF9900]/20 text-[#FF9900]":L.provider==="GCP"?"bg-[#4285F4]/20 text-[#4285F4]":"bg-[#0078D4]/20 text-[#0078D4]"}`,children:L.provider==="AWS"?"AWS":L.provider==="GCP"?"GCP":"AZ"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:L.provider==="AZURE"?"Azure":L.provider}),e.jsxs("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest",children:[L.score,"% Score"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-white leading-tight",children:[((ne=L.cost_range)==null?void 0:ne.formatted)||L.formatted_cost,L.monthly_cost&&L.monthly_cost<1&&e.jsx("div",{className:"text-[10px] text-amber-400",children:L.cost_intent==="hobby"?"Hobby-scale lower bound":"Estimated minimum"})]}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:L.recommended?"Recommended configuration (Cost-Effective)":"Estimated Monthly Cost"}),(()=>{let ue="standard";if(S.scenarios){for(const[xe,de]of Object.entries(S.scenarios))if(de[L.provider]){ue=xe;break}}return e.jsxs("div",{className:"text-[10px] text-gray-400",children:[ue.replace("_"," ").replace(/\b\w/g,xe=>xe.toUpperCase())," profile"]})})(),L.recommended&&(S==null?void 0:S.recommendation_facts)&&e.jsx("div",{className:"text-[10px] text-amber-400 italic mt-1",children:S.recommendation_facts.facts.dominant_drivers[0]?`${S.recommendation_facts.facts.dominant_drivers[0].name} is a key cost driver at your usage level.`:"Based on your usage patterns and cost optimization."})]}),Q&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-primary/20 flex items-center justify-between text-[10px] text-primary font-bold uppercase tracking-wider",children:[e.jsx("span",{children:"Selected"}),e.jsx("span",{className:"material-icons text-[12px]",children:"check_circle"})]})]},L.provider)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-green-400",children:"paid"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Cost Details & Confidence"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col justify-center items-center text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mb-3",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#2E3645",strokeWidth:"4"}),e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:typeof S.confidence=="number"&&S.confidence>.8?"#22c55e":typeof S.confidence=="number"&&S.confidence>.5?"#eab308":"#ef4444",strokeWidth:"4",strokeDasharray:`${(S.confidence||0)*100}, 100`})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsxs("span",{className:"text-xl font-bold text-white",children:[typeof S.confidence=="number"?(S.confidence*100).toFixed(0):"0","%"]})})]}),e.jsxs("div",{className:"text-sm font-bold text-white uppercase tracking-wider flex items-center space-x-2",children:[e.jsx("span",{children:"Confidence"}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"material-icons text-xs text-gray-400 cursor-help",children:"info"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg shadow-lg w-64 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[((Oe=S.confidence_explanation)==null?void 0:Oe.join(". "))||"Confidence based on service resolution, data quality, and estimate type.",e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 line-clamp-2",children:((Ze=S.confidence_explanation)==null?void 0:Ze[0])||"Based on architecture completeness and data quality."}),(((we=S.recommended)==null?void 0:we.estimate_type)||((Je=(Ye=S.providers)==null?void 0:Ye[o])==null?void 0:Je.estimate_type))&&e.jsx("div",{className:"mt-3 w-full",children:e.jsx("div",{className:`px-3 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider ${((Fe=S.recommended)==null?void 0:Fe.estimate_type)==="exact"||((it=(tt=S.providers)==null?void 0:tt[o])==null?void 0:it.estimate_type)==="exact"?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-amber-500/20 text-amber-400 border border-amber-500/30"}`,children:((ot=S.recommended)==null?void 0:ot.estimate_type)==="exact"||((rt=(lt=S.providers)==null?void 0:lt[o])==null?void 0:rt.estimate_type)==="exact"?" Exact (Terraform-based)":" Estimated (Heuristic)"})})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col justify-center items-center text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-3",children:(()=>{var Q,ne;const L=(Q=S.rankings)==null?void 0:Q.find(ue=>ue.provider===o);if(!(L!=null&&L.score)){const ue=S.scenarios?Object.values(S.scenarios).map(xe=>xe[o]).find(xe=>xe):null;return(ue==null?void 0:ue.score)||((ne=S.recommended)==null?void 0:ne.score)||"N/A"}return L.score})()}),e.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider",children:"% Score"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[o||"Provider"," competitiveness"]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase font-bold mb-4",children:"Estimate Based On"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(He=k==null?void 0:k.usage_profile)!=null&&He.monthly_users?typeof k.usage_profile.monthly_users=="object"?`${(k.usage_profile.monthly_users.min||0).toLocaleString()} - ${(k.usage_profile.monthly_users.max||0).toLocaleString()}`:k.usage_profile.monthly_users.toLocaleString():(Rt=(At=(Ke=S==null?void 0:S.recommendation_facts)==null?void 0:Ke.facts)==null?void 0:At.usage)!=null&&Rt.monthly_users?typeof S.recommendation_facts.facts.usage.monthly_users=="object"?`${(S.recommendation_facts.facts.usage.monthly_users.min||0).toLocaleString()} - ${(S.recommendation_facts.facts.usage.monthly_users.max||0).toLocaleString()}`:S.recommendation_facts.facts.usage.monthly_users.toLocaleString():"5,000"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Monthly Users"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(zt=k==null?void 0:k.usage_profile)!=null&&zt.data_transfer_gb?typeof k.usage_profile.data_transfer_gb=="object"?`${k.usage_profile.data_transfer_gb.min||0} - ${k.usage_profile.data_transfer_gb.max||0} GB`:`${k.usage_profile.data_transfer_gb} GB`:(Tt=(Ot=(It=S==null?void 0:S.recommendation_facts)==null?void 0:It.facts)==null?void 0:Ot.usage)!=null&&Tt.data_transfer_gb?typeof S.recommendation_facts.facts.usage.data_transfer_gb=="object"?`${S.recommendation_facts.facts.usage.data_transfer_gb.min||0} - ${S.recommendation_facts.facts.usage.data_transfer_gb.max||0} GB`:`${S.recommendation_facts.facts.usage.data_transfer_gb} GB`:"50 GB"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Data Transfer"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(Ft=k==null?void 0:k.usage_profile)!=null&&Ft.data_storage_gb?typeof k.usage_profile.data_storage_gb=="object"?`${k.usage_profile.data_storage_gb.min||0} - ${k.usage_profile.data_storage_gb.max||0} GB`:`${k.usage_profile.data_storage_gb} GB`:(Pt=(Dt=(Bt=S==null?void 0:S.recommendation_facts)==null?void 0:Bt.facts)==null?void 0:Dt.usage)!=null&&Pt.data_storage_gb?typeof S.recommendation_facts.facts.usage.data_storage_gb=="object"?`${S.recommendation_facts.facts.usage.data_storage_gb.min||0} - ${S.recommendation_facts.facts.usage.data_storage_gb.max||0} GB`:`${S.recommendation_facts.facts.usage.data_storage_gb} GB`:"10 GB"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Storage"})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{var ne,ue,xe;return((((ne=S.recommended)==null?void 0:ne.provider)===o?S.recommended.services:null)||((xe=(ue=S.provider_details)==null?void 0:ue[o||"aws"])==null?void 0:xe.services)||[]).slice(0,6).map((de,_e)=>e.jsx("span",{className:"px-3 py-1 bg-white/5 border border-white/10 rounded-full text-xs text-gray-300",children:de.cloud_service||de.display_name},_e))})()})}),(S==null?void 0:S.recommendation_facts)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-amber-500/20",children:[e.jsxs("div",{className:"text-xs text-amber-400 font-bold uppercase tracking-wider mb-2",children:["Why ",S.recommendation_facts.provider.toUpperCase(),"?"]}),e.jsx("div",{className:"space-y-1 text-xs text-gray-300",children:S.recommendation_facts.pros.map((L,Q)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-400 mr-1",children:""}),e.jsx("span",{children:L})]},Q))})]}),e.jsxs("button",{onClick:()=>u("usage_review"),className:"mt-4 w-full py-2 text-gray-400 text-xs font-medium hover:text-white hover:bg-white/5 rounded-lg transition-colors flex items-center justify-center space-x-1",children:[e.jsx("span",{className:"material-icons text-xs",children:"edit"}),e.jsx("span",{children:"Refine assumptions"})]})]})]})]}),e.jsxs("div",{className:"border border-white/5 rounded-2xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(g==="scenarios"?null:"scenarios"),className:"w-full p-4 bg-white/5 hover:bg-white/10 flex items-center justify-between transition-colors",children:[e.jsx("span",{className:"font-medium text-gray-300",children:"Scaling Scenarios"}),e.jsx("span",{className:`material-icons text-gray-400 transition-transform ${g==="scenarios"?"rotate-180":""}`,children:"expand_more"})]}),g==="scenarios"&&e.jsxs("div",{className:"p-6 bg-surface animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"If traffic doubles?"}),e.jsx("span",{className:"text-[10px] font-bold text-red-400 bg-red-400/10 px-2 py-0.5 rounded uppercase",children:"+25%"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Cost scales with bandwidth and API requests."})]}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"If storage doubles?"}),e.jsx("span",{className:"text-[10px] font-bold text-green-400 bg-green-400/10 px-2 py-0.5 rounded uppercase",children:"+5%"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Storage is generally the most cost-effective component."})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-xl p-4",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:"Estimated Cost Range"}),e.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:((Ut=S.cost_range)==null?void 0:Ut.formatted)||"$0.00 - $0.00/month"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Depends on scaling, availability, and performance choices"})]})]})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-xl p-4 flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"warning"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-xs text-amber-200/90 leading-relaxed",children:(()=>{var ne,ue,xe,de,_e,Ae;const L=((ne=S.recommended)==null?void 0:ne.estimate_type)||((xe=(ue=S.providers)==null?void 0:ue[o])==null?void 0:xe.estimate_type)||"heuristic",Q=((de=S.recommended)==null?void 0:de.estimate_reason)||((Ae=(_e=S.providers)==null?void 0:_e[o])==null?void 0:Ae.estimate_reason);return L==="exact"||L==="infracost"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:"font-bold",children:"Exact Pricing:"})," These costs are calculated using real Terraform + Infracost CLI and represent actual provider pricing. Final costs may vary based on actual resource usage, region selection, and any enterprise discounts."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:"font-bold",children:"Estimated Pricing:"})," This is an approximate cost estimate based on formula-driven provider pricing for ",o||"the selected provider",".",Q&&e.jsxs("span",{className:"block mt-1 text-[10px] italic",children:["(",Q,")"]}),e.jsx("span",{className:"block mt-1",children:"Exact costs will be calculated when Terraform is generated and will depend on actual resource usage, region selection, and any enterprise discounts."})]})})()})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>u("usage_review"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Usage"})]}),e.jsxs("button",{onClick:()=>{u("architecture")},className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Review Architecture"}),e.jsx("span",{className:"material-icons",children:"design_services"})]})]})]}),t==="requirements"&&e.jsx(qs,{workspaceId:r,infraSpec:m,costEstimation:S,onNext:()=>u("architecture"),onBack:()=>u("cost_estimation"),onRequirementsCaptured:O}),t==="architecture"&&e.jsx(rn,{workspaceId:r,infraSpec:m,costEstimation:S,selectedProvider:o,selectedProfile:G,usageProfile:k,requirementsData:te,architectureData:X,onArchitectureDataLoaded:$,onNext:()=>u("feedback"),onBack:()=>u("requirements")}),t==="feedback"&&e.jsx(Ls,{workspaceId:r,costEstimation:S,selectedProvider:o,costIntent:k==null?void 0:k.intent,onFeedbackSubmitted:()=>W(!0),onNext:()=>u("terraform_view"),onBack:()=>u("architecture")}),t==="terraform_view"&&e.jsx(Gs,{workspaceId:r,infraSpec:m,selectedProvider:o,costEstimation:S,onComplete:()=>u("deployment_ready"),onBack:()=>u("feedback")}),t==="processing_cost"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Analyzing Cloud Costs"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Comparing AWS, GCP, and Azure pricing..."})]})]}),t==="deployment_ready"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-500/20 mb-6",children:e.jsx("span",{className:"material-icons text-4xl text-green-400",children:"check_circle"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Ready for Deployment"}),e.jsx("p",{className:"text-gray-400 mt-3 max-w-md",children:"Your infrastructure is ready. Choose your deployment method below."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 max-w-lg w-full",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Deployment Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Project"}),e.jsx("span",{className:"text-white font-medium",children:(m==null?void 0:m.project_name)||(x==null?void 0:x.name)||"Untitled Project"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Architecture"}),e.jsx("span",{className:"text-white font-medium capitalize",children:((Lt=($t=m==null?void 0:m.canonical_architecture)==null?void 0:$t.pattern_name)==null?void 0:Lt.replace(/_/g," "))||((Mt=m==null?void 0:m.pattern_key)==null?void 0:Mt.replace(/_/g," "))||"Custom"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cloud Provider"}),e.jsx("span",{className:"text-white font-medium",children:(o==null?void 0:o.toUpperCase())||"Not Selected"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Region"}),e.jsx("span",{className:"text-white font-medium",children:((Wt=m==null?void 0:m.resolved_region)==null?void 0:Wt.resolved)||((Ht=(Zt=m==null?void 0:m.resolved_region)==null?void 0:Zt.logical)==null?void 0:Ht.replace(/_/g," "))||"Default"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Services"}),e.jsxs("span",{className:"text-white font-medium",children:[((qt=(Gt=m==null?void 0:m.canonical_architecture)==null?void 0:Gt.deployable_services)==null?void 0:qt.length)||((Vt=S==null?void 0:S.recommended)==null?void 0:Vt.service_count)||((Kt=(Yt=S==null?void 0:S.provider_details)==null?void 0:Yt[o])==null?void 0:Kt.service_count)||((Jt=(Xt=m==null?void 0:m.service_classes)==null?void 0:Xt.required_services)==null?void 0:Jt.length)||0," services"]})]}),e.jsxs("div",{className:"flex justify-between border-t border-border pt-3 mt-3",children:[e.jsx("span",{className:"text-gray-400",children:"Monthly Estimate"}),e.jsx("span",{className:"text-green-400 font-bold text-lg",children:((er=(Qt=S==null?void 0:S.rankings)==null?void 0:Qt.find(L=>{var Q;return((Q=L.provider)==null?void 0:Q.toLowerCase())===(o==null?void 0:o.toLowerCase())}))==null?void 0:er.formatted_cost)||((tr=S==null?void 0:S.recommended)==null?void 0:tr.formatted_cost)||((sr=(rr=S==null?void 0:S.provider_details)==null?void 0:rr[o])==null?void 0:sr.formatted_cost)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cost Profile"}),e.jsx("span",{className:"text-white font-medium capitalize",children:((ar=S==null?void 0:S.cost_profile)==null?void 0:ar.replace("_"," ").toLowerCase())||"standard"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-4 w-full max-w-2xl",children:[e.jsx("div",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deployment Options"}),e.jsxs("div",{className:"flex space-x-4 w-full justify-center",children:[e.jsxs("button",{onClick:async()=>{var L,Q,ne,ue,xe;try{const de=localStorage.getItem("token"),_e=de?{Authorization:`Bearer ${de}`}:{};await Be.put(`http://localhost:5000/api/workspaces/${r}/deploy`,{deployment_method:"self",provider:o},{headers:_e}),ce.success(" Deployment confirmed! Check your email for details.",{duration:4e3}),c("/workspaces")}catch(de){console.error("Failed to update deployment readiness:",de),((L=de.response)==null?void 0:L.status)===401?(ce.error("Session expired. Please log in again."),c("/login")):((Q=de.response)==null?void 0:Q.status)===404?ce.error("Workspace not found. It may have been deleted."):((ne=de.response)==null?void 0:ne.status)===500?ce.error(((xe=(ue=de.response)==null?void 0:ue.data)==null?void 0:xe.msg)||"Server error. Please try again later."):de.response?ce.error("Failed to mark deployment. Please try again."):ce.error("Network error. Please check your connection.")}},className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-lg",children:"download_done"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold",children:"Self Deployment"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Download & deploy manually"})]})]}),e.jsxs("button",{disabled:!0,className:"px-6 py-3 bg-gradient-to-r from-primary/10 to-blue-500/10 border border-primary/20 rounded-xl text-primary/50 font-medium cursor-not-allowed flex items-center space-x-2 relative",children:[e.jsx("span",{className:"material-icons text-lg",children:"rocket_launch"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("span",{className:"text-sm font-bold flex items-center space-x-2",children:[e.jsx("span",{children:"One-Click Deployment"}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 rounded text-xs text-primary",children:"Coming Soon"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Automated cloud deployment"})]})]})]})]}),e.jsxs("button",{onClick:()=>u("terraform_view"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Terraform"})]})]})]})})]})]})};export{cn as default};
