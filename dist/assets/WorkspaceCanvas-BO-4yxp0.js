import{j as e}from"./index-lHb7DQJg.js";import{r as K,g as Er,c as $e,f as Le,e as Ar,u as Rr}from"./vendor-rtOnKvnR.js";import{a as Be}from"./utils-_x9ZSjUA.js";import{c as lt,u as zr,a as wt,s as Ir,z as Or,P as Tr,b as ir,i as Fr,p as Br,g as Dr,d as or,e as Pr,f as Ur,h as $r,j as Lr,R as Mr,B as Wr,C as Zr,k as Xt}from"./style-Bcu4uS8F.js";import"./ui-CG_uZszz.js";let Hr={data:""},Gr=r=>{if(typeof window=="object"){let c=(r?r.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return c.nonce=window.__nonce__,c.parentNode||(r||document.head).appendChild(c),c.firstChild}return r||Hr},qr=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Vr=/\/\*[^]*?\*\/|  +/g,Jt=/\n+/g,Ge=(r,c)=>{let t="",u="",f="";for(let i in r){let s=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+s+";":u+=i[1]=="f"?Ge(s,i):i+"{"+Ge(s,i[1]=="k"?"":c)+"}":typeof s=="object"?u+=Ge(s,c?c.replace(/([^,])+/g,n=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,n):n?n+" "+d:d)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),f+=Ge.p?Ge.p(i,s):i+":"+s+";")}return t+(c&&f?c+"{"+f+"}":f)+u},Ue={},lr=r=>{if(typeof r=="object"){let c="";for(let t in r)c+=t+lr(r[t]);return c}return r},Yr=(r,c,t,u,f)=>{let i=lr(r),s=Ue[i]||(Ue[i]=(d=>{let b=0,p=11;for(;b<d.length;)p=101*p+d.charCodeAt(b++)>>>0;return"go"+p})(i));if(!Ue[s]){let d=i!==r?r:(b=>{let p,v,g=[{}];for(;p=qr.exec(b.replace(Vr,""));)p[4]?g.shift():p[3]?(v=p[3].replace(Jt," ").trim(),g.unshift(g[0][v]=g[0][v]||{})):g[0][p[1]]=p[2].replace(Jt," ").trim();return g[0]})(r);Ue[s]=Ge(f?{["@keyframes "+s]:d}:d,t?"":"."+s)}let n=t&&Ue.g?Ue.g:null;return t&&(Ue.g=Ue[s]),((d,b,p,v)=>{v?b.data=b.data.replace(v,d):b.data.indexOf(d)===-1&&(b.data=p?d+b.data:b.data+d)})(Ue[s],c,u,n),s},Kr=(r,c,t)=>r.reduce((u,f,i)=>{let s=c[i];if(s&&s.call){let n=s(t),d=n&&n.props&&n.props.className||/^go/.test(n)&&n;s=d?"."+d:n&&typeof n=="object"?n.props?"":Ge(n,""):n===!1?"":n}return u+f+(s??"")},"");function mt(r){let c=this||{},t=r.call?r(c.p):r;return Yr(t.unshift?t.raw?Kr(t,[].slice.call(arguments,1),c.p):t.reduce((u,f)=>Object.assign(u,f&&f.call?f(c.p):f),{}):t,Gr(c.target),c.g,c.o,c.k)}let cr,_t,jt;mt.bind({g:1});let Me=mt.bind({k:1});function Xr(r,c,t,u){Ge.p=c,cr=r,_t=t,jt=u}function Ve(r,c){let t=this||{};return function(){let u=arguments;function f(i,s){let n=Object.assign({},i),d=n.className||f.className;t.p=Object.assign({theme:_t&&_t()},n),t.o=/ *go\d+/.test(d),n.className=mt.apply(t,u)+(d?" "+d:"");let b=r;return r[0]&&(b=n.as||r,delete n.as),jt&&b[0]&&jt(n),cr(b,n)}return c?c(f):f}}var Jr=r=>typeof r=="function",ut=(r,c)=>Jr(r)?r(c):r,Qr=(()=>{let r=0;return()=>(++r).toString()})(),dr=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let c=matchMedia("(prefers-reduced-motion: reduce)");r=!c||c.matches}return r}})(),es=20,St="default",ur=(r,c)=>{let{toastLimit:t}=r.settings;switch(c.type){case 0:return{...r,toasts:[c.toast,...r.toasts].slice(0,t)};case 1:return{...r,toasts:r.toasts.map(s=>s.id===c.toast.id?{...s,...c.toast}:s)};case 2:let{toast:u}=c;return ur(r,{type:r.toasts.find(s=>s.id===u.id)?1:0,toast:u});case 3:let{toastId:f}=c;return{...r,toasts:r.toasts.map(s=>s.id===f||f===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return c.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(s=>s.id!==c.toastId)};case 5:return{...r,pausedAt:c.time};case 6:let i=c.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},dt=[],hr={toasts:[],pausedAt:void 0,settings:{toastLimit:es}},Pe={},fr=(r,c=St)=>{Pe[c]=ur(Pe[c]||hr,r),dt.forEach(([t,u])=>{t===c&&u(Pe[c])})},mr=r=>Object.keys(Pe).forEach(c=>fr(r,c)),ts=r=>Object.keys(Pe).find(c=>Pe[c].toasts.some(t=>t.id===r)),pt=(r=St)=>c=>{fr(c,r)},rs={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ss=(r={},c=St)=>{let[t,u]=K.useState(Pe[c]||hr),f=K.useRef(Pe[c]);K.useEffect(()=>(f.current!==Pe[c]&&u(Pe[c]),dt.push([c,u]),()=>{let s=dt.findIndex(([n])=>n===c);s>-1&&dt.splice(s,1)}),[c]);let i=t.toasts.map(s=>{var n,d,b;return{...r,...r[s.type],...s,removeDelay:s.removeDelay||((n=r[s.type])==null?void 0:n.removeDelay)||(r==null?void 0:r.removeDelay),duration:s.duration||((d=r[s.type])==null?void 0:d.duration)||(r==null?void 0:r.duration)||rs[s.type],style:{...r.style,...(b=r[s.type])==null?void 0:b.style,...s.style}}});return{...t,toasts:i}},as=(r,c="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:c,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Qr()}),at=r=>(c,t)=>{let u=as(c,r,t);return pt(u.toasterId||ts(u.id))({type:2,toast:u}),u.id},Ce=(r,c)=>at("blank")(r,c);Ce.error=at("error");Ce.success=at("success");Ce.loading=at("loading");Ce.custom=at("custom");Ce.dismiss=(r,c)=>{let t={type:3,toastId:r};c?pt(c)(t):mr(t)};Ce.dismissAll=r=>Ce.dismiss(void 0,r);Ce.remove=(r,c)=>{let t={type:4,toastId:r};c?pt(c)(t):mr(t)};Ce.removeAll=r=>Ce.remove(void 0,r);Ce.promise=(r,c,t)=>{let u=Ce.loading(c.loading,{...t,...t==null?void 0:t.loading});return typeof r=="function"&&(r=r()),r.then(f=>{let i=c.success?ut(c.success,f):void 0;return i?Ce.success(i,{id:u,...t,...t==null?void 0:t.success}):Ce.dismiss(u),f}).catch(f=>{let i=c.error?ut(c.error,f):void 0;i?Ce.error(i,{id:u,...t,...t==null?void 0:t.error}):Ce.dismiss(u)}),r};var ns=1e3,is=(r,c="default")=>{let{toasts:t,pausedAt:u}=ss(r,c),f=K.useRef(new Map).current,i=K.useCallback((v,g=ns)=>{if(f.has(v))return;let h=setTimeout(()=>{f.delete(v),s({type:4,toastId:v})},g);f.set(v,h)},[]);K.useEffect(()=>{if(u)return;let v=Date.now(),g=t.map(h=>{if(h.duration===1/0)return;let w=(h.duration||0)+h.pauseDuration-(v-h.createdAt);if(w<0){h.visible&&Ce.dismiss(h.id);return}return setTimeout(()=>Ce.dismiss(h.id,c),w)});return()=>{g.forEach(h=>h&&clearTimeout(h))}},[t,u,c]);let s=K.useCallback(pt(c),[c]),n=K.useCallback(()=>{s({type:5,time:Date.now()})},[s]),d=K.useCallback((v,g)=>{s({type:1,toast:{id:v,height:g}})},[s]),b=K.useCallback(()=>{u&&s({type:6,time:Date.now()})},[u,s]),p=K.useCallback((v,g)=>{let{reverseOrder:h=!1,gutter:w=8,defaultPosition:l}=g||{},x=t.filter(S=>(S.position||l)===(v.position||l)&&S.height),m=x.findIndex(S=>S.id===v.id),j=x.filter((S,k)=>k<m&&S.visible).length;return x.filter(S=>S.visible).slice(...h?[j+1]:[0,j]).reduce((S,k)=>S+(k.height||0)+w,0)},[t]);return K.useEffect(()=>{t.forEach(v=>{if(v.dismissed)i(v.id,v.removeDelay);else{let g=f.get(v.id);g&&(clearTimeout(g),f.delete(v.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:d,startPause:n,endPause:b,calculateOffset:p}}},os=Me`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ls=Me`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,cs=Me`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ds=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${os} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ls} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${cs} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,us=Me`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,hs=Ve("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${us} 1s linear infinite;
`,fs=Me`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ms=Me`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ps=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${fs} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ms} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,xs=Ve("div")`
  position: absolute;
`,gs=Ve("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,bs=Me`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ys=Ve("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${bs} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,vs=({toast:r})=>{let{icon:c,type:t,iconTheme:u}=r;return c!==void 0?typeof c=="string"?K.createElement(ys,null,c):c:t==="blank"?null:K.createElement(gs,null,K.createElement(hs,{...u}),t!=="loading"&&K.createElement(xs,null,t==="error"?K.createElement(ds,{...u}):K.createElement(ps,{...u})))},ws=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,_s=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,js="0%{opacity:0;} 100%{opacity:1;}",Ns="0%{opacity:1;} 100%{opacity:0;}",ks=Ve("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Ss=Ve("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Cs=(r,c)=>{let t=r.includes("top")?1:-1,[u,f]=dr()?[js,Ns]:[ws(t),_s(t)];return{animation:c?`${Me(u)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Me(f)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Es=K.memo(({toast:r,position:c,style:t,children:u})=>{let f=r.height?Cs(r.position||c||"top-center",r.visible):{opacity:0},i=K.createElement(vs,{toast:r}),s=K.createElement(Ss,{...r.ariaProps},ut(r.message,r));return K.createElement(ks,{className:r.className,style:{...f,...t,...r.style}},typeof u=="function"?u({icon:i,message:s}):K.createElement(K.Fragment,null,i,s))});Xr(K.createElement);var As=({id:r,className:c,style:t,onHeightUpdate:u,children:f})=>{let i=K.useCallback(s=>{if(s){let n=()=>{let d=s.getBoundingClientRect().height;u(r,d)};n(),new MutationObserver(n).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[r,u]);return K.createElement("div",{ref:i,className:c,style:t},f)},Rs=(r,c)=>{let t=r.includes("top"),u=t?{top:0}:{bottom:0},f=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:dr()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${c*(t?1:-1)}px)`,...u,...f}},zs=mt`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ct=16,Is=({reverseOrder:r,position:c="top-center",toastOptions:t,gutter:u,children:f,toasterId:i,containerStyle:s,containerClassName:n})=>{let{toasts:d,handlers:b}=is(t,i);return K.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:ct,left:ct,right:ct,bottom:ct,pointerEvents:"none",...s},className:n,onMouseEnter:b.startPause,onMouseLeave:b.endPause},d.map(p=>{let v=p.position||c,g=b.calculateOffset(p,{reverseOrder:r,gutter:u,defaultPosition:c}),h=Rs(v,g);return K.createElement(As,{id:p.id,key:p.id,onHeightUpdate:b.updateHeight,className:p.visible?zs:"",style:h},p.type==="custom"?ut(p.message,p):f?f(p):K.createElement(Es,{toast:p,position:v}))}))},ue=Ce;const bt="http://localhost:5000/api",Os=({workspaceId:r,costEstimation:c,selectedProvider:t,onNext:u,onBack:f,costIntent:i,onFeedbackSubmitted:s})=>{const[n,d]=K.useState(null),[b,p]=K.useState(!1),v=async()=>{var g;if(!n){ue.error("Please select an option");return}p(!0);try{const h=(g=c.provider_details)==null?void 0:g[t],w=(h==null?void 0:h.cost_range)||{min:0,max:0};let l="cost_effective";if(c.cost_profile)l=c.cost_profile;else if(c.selected_profile)l=c.selected_profile;else if(c.scenarios){const m=h==null?void 0:h.total_monthly_cost;for(const[j,S]of Object.entries(c.scenarios)){const k=S[t];if(k&&m){const A=k.monthly_cost||k.estimated_cost;if(A&&Math.abs(m-A)<.01){l=j;break}}}}l==="costeffective"||l==="cost_effective"||l==="costEffective"?l="cost_effective":l==="highperformance"||l==="high_performance"||l==="highPerformance"?l="high_performance":l==="standard"||l==="Standard"?l="standard":l="cost_effective";const x=bt.endsWith("/")?bt.slice(0,-1):bt;try{await Be.post(`${x}/feedback`,{workspace_id:r,cost_intent:(i==null?void 0:i.type)||"startup",estimated_min:w.min||0,estimated_max:w.max||0,selected_provider:t,selected_profile:l,user_feedback:n}),ue.success("Feedback recorded"),s&&s()}catch(m){console.warn("Feedback failed (non-blocking):",m),ue.success("Proceeding to code generation..."),s&&s()}u()}catch(h){console.error("Feedback submission error:",h),ue.error("Failed to submit feedback")}finally{p(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"One Quick Question"}),e.jsx("p",{className:"text-gray-400",children:"Before we generate your Terraform code, help us calibrate our estimator."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-6 text-center",children:"Is this cost estimate within your expected budget?"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("button",{onClick:()=>d("within_budget"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="within_budget"?"bg-green-500/10 border-green-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"Yes, it looks reasonable"}),n==="within_budget"&&e.jsx("span",{className:"material-icons text-green-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("slightly_high"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="slightly_high"?"bg-yellow-500/10 border-yellow-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"It's a bit higher than expected"}),n==="slightly_high"&&e.jsx("span",{className:"material-icons text-yellow-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("too_high"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="too_high"?"bg-red-500/10 border-red-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"No, it's significantly too high"}),n==="too_high"&&e.jsx("span",{className:"material-icons text-red-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("unknown"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="unknown"?"bg-blue-500/10 border-blue-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"I'm not sure / I have no baseline"}),n==="unknown"&&e.jsx("span",{className:"material-icons text-blue-500",children:"check_circle"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Estimate"})]}),e.jsx("button",{onClick:v,disabled:!n||b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Generate Terraform"}),e.jsx("span",{className:"material-icons",children:"code"})]})})]})]})};var pr={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,c){(function(t){r.exports=t()})(function(){return function t(u,f,i){function s(b,p){if(!f[b]){if(!u[b]){var v=typeof lt=="function"&&lt;if(!p&&v)return v(b,!0);if(n)return n(b,!0);var g=new Error("Cannot find module '"+b+"'");throw g.code="MODULE_NOT_FOUND",g}var h=f[b]={exports:{}};u[b][0].call(h.exports,function(w){var l=u[b][1][w];return s(l||w)},h,h.exports,t,u,f,i)}return f[b].exports}for(var n=typeof lt=="function"&&lt,d=0;d<i.length;d++)s(i[d]);return s}({1:[function(t,u,f){var i=t("./utils"),s=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(d){for(var b,p,v,g,h,w,l,x=[],m=0,j=d.length,S=j,k=i.getTypeOf(d)!=="string";m<d.length;)S=j-m,v=k?(b=d[m++],p=m<j?d[m++]:0,m<j?d[m++]:0):(b=d.charCodeAt(m++),p=m<j?d.charCodeAt(m++):0,m<j?d.charCodeAt(m++):0),g=b>>2,h=(3&b)<<4|p>>4,w=1<S?(15&p)<<2|v>>6:64,l=2<S?63&v:64,x.push(n.charAt(g)+n.charAt(h)+n.charAt(w)+n.charAt(l));return x.join("")},f.decode=function(d){var b,p,v,g,h,w,l=0,x=0,m="data:";if(d.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var j,S=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===n.charAt(64)&&S--,d.charAt(d.length-2)===n.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(j=s.uint8array?new Uint8Array(0|S):new Array(0|S);l<d.length;)b=n.indexOf(d.charAt(l++))<<2|(g=n.indexOf(d.charAt(l++)))>>4,p=(15&g)<<4|(h=n.indexOf(d.charAt(l++)))>>2,v=(3&h)<<6|(w=n.indexOf(d.charAt(l++))),j[x++]=b,h!==64&&(j[x++]=p),w!==64&&(j[x++]=v);return j}},{"./support":30,"./utils":32}],2:[function(t,u,f){var i=t("./external"),s=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function b(p,v,g,h,w){this.compressedSize=p,this.uncompressedSize=v,this.crc32=g,this.compression=h,this.compressedContent=w}b.prototype={getContentWorker:function(){var p=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),v=this;return p.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(p,v,g){return p.pipe(new n).pipe(new d("uncompressedSize")).pipe(v.compressWorker(g)).pipe(new d("compressedSize")).withStreamInfo("compression",v)},u.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,u,f){var i=t("./stream/GenericWorker");f.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},f.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,u,f){var i=t("./utils"),s=function(){for(var n,d=[],b=0;b<256;b++){n=b;for(var p=0;p<8;p++)n=1&n?3988292384^n>>>1:n>>>1;d[b]=n}return d}();u.exports=function(n,d){return n!==void 0&&n.length?i.getTypeOf(n)!=="string"?function(b,p,v,g){var h=s,w=g+v;b^=-1;for(var l=g;l<w;l++)b=b>>>8^h[255&(b^p[l])];return-1^b}(0|d,n,n.length,0):function(b,p,v,g){var h=s,w=g+v;b^=-1;for(var l=g;l<w;l++)b=b>>>8^h[255&(b^p.charCodeAt(l))];return-1^b}(0|d,n,n.length,0):0}},{"./utils":32}],5:[function(t,u,f){f.base64=!1,f.binary=!1,f.dir=!1,f.createFolders=!0,f.date=null,f.compression=null,f.compressionOptions=null,f.comment=null,f.unixPermissions=null,f.dosPermissions=null},{}],6:[function(t,u,f){var i=null;i=typeof Promise<"u"?Promise:t("lie"),u.exports={Promise:i}},{lie:37}],7:[function(t,u,f){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),n=t("./utils"),d=t("./stream/GenericWorker"),b=i?"uint8array":"array";function p(v,g){d.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=g,this.meta={}}f.magic="\b\0",n.inherits(p,d),p.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(b,v.data),!1)},p.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(g){v.push({data:g,meta:v.meta})}},f.compressWorker=function(v){return new p("Deflate",v)},f.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,u,f){function i(h,w){var l,x="";for(l=0;l<w;l++)x+=String.fromCharCode(255&h),h>>>=8;return x}function s(h,w,l,x,m,j){var S,k,A=h.file,P=h.compression,D=j!==b.utf8encode,C=n.transformTo("string",j(A.name)),F=n.transformTo("string",b.utf8encode(A.name)),G=A.comment,te=n.transformTo("string",j(G)),N=n.transformTo("string",b.utf8encode(G)),I=F.length!==A.name.length,o=N.length!==G.length,B="",J="",$="",ae=A.dir,W=A.date,re={crc32:0,compressedSize:0,uncompressedSize:0};w&&!l||(re.crc32=h.crc32,re.compressedSize=h.compressedSize,re.uncompressedSize=h.uncompressedSize);var O=0;w&&(O|=8),D||!I&&!o||(O|=2048);var R=0,X=0;ae&&(R|=16),m==="UNIX"?(X=798,R|=function(H,me){var ye=H;return H||(ye=me?16893:33204),(65535&ye)<<16}(A.unixPermissions,ae)):(X=20,R|=function(H){return 63&(H||0)}(A.dosPermissions)),S=W.getUTCHours(),S<<=6,S|=W.getUTCMinutes(),S<<=5,S|=W.getUTCSeconds()/2,k=W.getUTCFullYear()-1980,k<<=4,k|=W.getUTCMonth()+1,k<<=5,k|=W.getUTCDate(),I&&(J=i(1,1)+i(p(C),4)+F,B+="up"+i(J.length,2)+J),o&&($=i(1,1)+i(p(te),4)+N,B+="uc"+i($.length,2)+$);var Y="";return Y+=`
\0`,Y+=i(O,2),Y+=P.magic,Y+=i(S,2),Y+=i(k,2),Y+=i(re.crc32,4),Y+=i(re.compressedSize,4),Y+=i(re.uncompressedSize,4),Y+=i(C.length,2),Y+=i(B.length,2),{fileRecord:v.LOCAL_FILE_HEADER+Y+C+B,dirRecord:v.CENTRAL_FILE_HEADER+i(X,2)+Y+i(te.length,2)+"\0\0\0\0"+i(R,4)+i(x,4)+C+B+te}}var n=t("../utils"),d=t("../stream/GenericWorker"),b=t("../utf8"),p=t("../crc32"),v=t("../signature");function g(h,w,l,x){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=l,this.encodeFileName=x,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(g,d),g.prototype.push=function(h){var w=h.meta.percent||0,l=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,d.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:l?(w+100*(l-x-1))/l:100}}))},g.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var w=this.streamFiles&&!h.file.dir;if(w){var l=s(h,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(h){this.accumulate=!1;var w=this.streamFiles&&!h.file.dir,l=s(h,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),w)this.push({data:function(x){return v.DATA_DESCRIPTOR+i(x.crc32,4)+i(x.compressedSize,4)+i(x.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var h=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var l=this.bytesWritten-h,x=function(m,j,S,k,A){var P=n.transformTo("string",A(k));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(m,2)+i(m,2)+i(j,4)+i(S,4)+i(P.length,2)+P}(this.dirRecords.length,l,h,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(h){this._sources.push(h);var w=this;return h.on("data",function(l){w.processChunk(l)}),h.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),h.on("error",function(l){w.error(l)}),this},g.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(h){var w=this._sources;if(!d.prototype.error.call(this,h))return!1;for(var l=0;l<w.length;l++)try{w[l].error(h)}catch{}return!0},g.prototype.lock=function(){d.prototype.lock.call(this);for(var h=this._sources,w=0;w<h.length;w++)h[w].lock()},u.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,u,f){var i=t("../compressions"),s=t("./ZipFileWorker");f.generateWorker=function(n,d,b){var p=new s(d.streamFiles,b,d.platform,d.encodeFileName),v=0;try{n.forEach(function(g,h){v++;var w=function(j,S){var k=j||S,A=i[k];if(!A)throw new Error(k+" is not a valid compression method !");return A}(h.options.compression,d.compression),l=h.options.compressionOptions||d.compressionOptions||{},x=h.dir,m=h.date;h._compressWorker(w,l).withStreamInfo("file",{name:g,dir:x,date:m,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(p)}),p.entriesCount=v}catch(g){p.error(g)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,u,f){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var n in this)typeof this[n]!="function"&&(s[n]=this[n]);return s}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(s,n){return new i().loadAsync(s,n)},i.external=t("./external"),u.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,u,f){var i=t("./utils"),s=t("./external"),n=t("./utf8"),d=t("./zipEntries"),b=t("./stream/Crc32Probe"),p=t("./nodejsUtils");function v(g){return new s.Promise(function(h,w){var l=g.decompressed.getContentWorker().pipe(new b);l.on("error",function(x){w(x)}).on("end",function(){l.streamInfo.crc32!==g.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}u.exports=function(g,h){var w=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),p.isNode&&p.isStream(g)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",g,!0,h.optimizedBinaryString,h.base64).then(function(l){var x=new d(h);return x.load(l),x}).then(function(l){var x=[s.Promise.resolve(l)],m=l.files;if(h.checkCRC32)for(var j=0;j<m.length;j++)x.push(v(m[j]));return s.Promise.all(x)}).then(function(l){for(var x=l.shift(),m=x.files,j=0;j<m.length;j++){var S=m[j],k=S.fileNameStr,A=i.resolve(S.fileNameStr);w.file(A,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:h.createFolders}),S.dir||(w.file(A).unsafeOriginalName=k)}return x.zipComment.length&&(w.comment=x.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,u,f){var i=t("../utils"),s=t("../stream/GenericWorker");function n(d,b){s.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(b)}i.inherits(n,s),n.prototype._bindStream=function(d){var b=this;(this._stream=d).pause(),d.on("data",function(p){b.push({data:p,meta:{percent:0}})}).on("error",function(p){b.isPaused?this.generatedError=p:b.error(p)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},n.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,u,f){var i=t("readable-stream").Readable;function s(n,d,b){i.call(this,d),this._helper=n;var p=this;n.on("data",function(v,g){p.push(v)||p._helper.pause(),b&&b(g)}).on("error",function(v){p.emit("error",v)}).on("end",function(){p.push(null)})}t("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},u.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,u,f){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,u,f){function i(A,P,D){var C,F=n.getTypeOf(P),G=n.extend(D||{},p);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(A=m(A)),G.createFolders&&(C=x(A))&&j.call(this,C,!0);var te=F==="string"&&G.binary===!1&&G.base64===!1;D&&D.binary!==void 0||(G.binary=!te),(P instanceof v&&P.uncompressedSize===0||G.dir||!P||P.length===0)&&(G.base64=!1,G.binary=!0,P="",G.compression="STORE",F="string");var N=null;N=P instanceof v||P instanceof d?P:w.isNode&&w.isStream(P)?new l(A,P):n.prepareContent(A,P,G.binary,G.optimizedBinaryString,G.base64);var I=new g(A,N,G);this.files[A]=I}var s=t("./utf8"),n=t("./utils"),d=t("./stream/GenericWorker"),b=t("./stream/StreamHelper"),p=t("./defaults"),v=t("./compressedObject"),g=t("./zipObject"),h=t("./generate"),w=t("./nodejsUtils"),l=t("./nodejs/NodejsStreamInputAdapter"),x=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var P=A.lastIndexOf("/");return 0<P?A.substring(0,P):""},m=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},j=function(A,P){return P=P!==void 0?P:p.createFolders,A=m(A),this.files[A]||i.call(this,A,null,{dir:!0,createFolders:P}),this.files[A]};function S(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var P,D,C;for(P in this.files)C=this.files[P],(D=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&A(D,C)},filter:function(A){var P=[];return this.forEach(function(D,C){A(D,C)&&P.push(C)}),P},file:function(A,P,D){if(arguments.length!==1)return A=this.root+A,i.call(this,A,P,D),this;if(S(A)){var C=A;return this.filter(function(G,te){return!te.dir&&C.test(G)})}var F=this.files[this.root+A];return F&&!F.dir?F:null},folder:function(A){if(!A)return this;if(S(A))return this.filter(function(F,G){return G.dir&&A.test(F)});var P=this.root+A,D=j.call(this,P),C=this.clone();return C.root=D.name,C},remove:function(A){A=this.root+A;var P=this.files[A];if(P||(A.slice(-1)!=="/"&&(A+="/"),P=this.files[A]),P&&!P.dir)delete this.files[A];else for(var D=this.filter(function(F,G){return G.name.slice(0,A.length)===A}),C=0;C<D.length;C++)delete this.files[D[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var P,D={};try{if((D=n.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");n.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var C=D.comment||this.comment||"";P=h.generateWorker(this,D,C)}catch(F){(P=new d("error")).error(F)}return new b(P,D.type||"string",D.mimeType)},generateAsync:function(A,P){return this.generateInternalStream(A).accumulate(P)},generateNodeStream:function(A,P){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(P)}};u.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,u,f){u.exports=t("stream")},{stream:void 0}],17:[function(t,u,f){var i=t("./DataReader");function s(n){i.call(this,n);for(var d=0;d<this.data.length;d++)n[d]=255&n[d]}t("../utils").inherits(s,i),s.prototype.byteAt=function(n){return this.data[this.zero+n]},s.prototype.lastIndexOfSignature=function(n){for(var d=n.charCodeAt(0),b=n.charCodeAt(1),p=n.charCodeAt(2),v=n.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===d&&this.data[g+1]===b&&this.data[g+2]===p&&this.data[g+3]===v)return g-this.zero;return-1},s.prototype.readAndCheckSignature=function(n){var d=n.charCodeAt(0),b=n.charCodeAt(1),p=n.charCodeAt(2),v=n.charCodeAt(3),g=this.readData(4);return d===g[0]&&b===g[1]&&p===g[2]&&v===g[3]},s.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,u,f){var i=t("../utils");function s(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var d,b=0;for(this.checkOffset(n),d=this.index+n-1;d>=this.index;d--)b=(b<<8)+this.byteAt(d);return this.index+=n,b},readString:function(n){return i.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},u.exports=s},{"../utils":32}],19:[function(t,u,f){var i=t("./Uint8ArrayReader");function s(n){i.call(this,n)}t("../utils").inherits(s,i),s.prototype.readData=function(n){this.checkOffset(n);var d=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,u,f){var i=t("./DataReader");function s(n){i.call(this,n)}t("../utils").inherits(s,i),s.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},s.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},s.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},s.prototype.readData=function(n){this.checkOffset(n);var d=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,u,f){var i=t("./ArrayReader");function s(n){i.call(this,n)}t("../utils").inherits(s,i),s.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,u,f){var i=t("../utils"),s=t("../support"),n=t("./ArrayReader"),d=t("./StringReader"),b=t("./NodeBufferReader"),p=t("./Uint8ArrayReader");u.exports=function(v){var g=i.getTypeOf(v);return i.checkSupport(g),g!=="string"||s.uint8array?g==="nodebuffer"?new b(v):s.uint8array?new p(i.transformTo("uint8array",v)):new n(i.transformTo("array",v)):new d(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,u,f){f.LOCAL_FILE_HEADER="PK",f.CENTRAL_FILE_HEADER="PK",f.CENTRAL_DIRECTORY_END="PK",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",f.ZIP64_CENTRAL_DIRECTORY_END="PK",f.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,u,f){var i=t("./GenericWorker"),s=t("../utils");function n(d){i.call(this,"ConvertWorker to "+d),this.destType=d}s.inherits(n,i),n.prototype.processChunk=function(d){this.push({data:s.transformTo(this.destType,d.data),meta:d.meta})},u.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,u,f){var i=t("./GenericWorker"),s=t("../crc32");function n(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,i),n.prototype.processChunk=function(d){this.streamInfo.crc32=s(d.data,this.streamInfo.crc32||0),this.push(d)},u.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,u,f){var i=t("../utils"),s=t("./GenericWorker");function n(d){s.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(n,s),n.prototype.processChunk=function(d){if(d){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+d.data.length}s.prototype.processChunk.call(this,d)},u.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,u,f){var i=t("../utils"),s=t("./GenericWorker");function n(d){s.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(p){b.dataIsReady=!0,b.data=p,b.max=p&&p.length||0,b.type=i.getTypeOf(p),b.isPaused||b._tickAndRepeat()},function(p){b.error(p)})}i.inherits(n,s),n.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,b);break;case"uint8array":d=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":d=this.data.slice(this.index,b)}return this.index=b,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,u,f){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,n){return this._listeners[s].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,n){if(this._listeners[s])for(var d=0;d<this._listeners[s].length;d++)this._listeners[s][d].call(this,n)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var n=this;return s.on("data",function(d){n.processChunk(d)}),s.on("end",function(){n.end()}),s.on("error",function(d){n.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,n){return this.extraStreamInfo[s]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},u.exports=i},{}],29:[function(t,u,f){var i=t("../utils"),s=t("./ConvertWorker"),n=t("./GenericWorker"),d=t("../base64"),b=t("../support"),p=t("../external"),v=null;if(b.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(w,l){return new p.Promise(function(x,m){var j=[],S=w._internalType,k=w._outputType,A=w._mimeType;w.on("data",function(P,D){j.push(P),l&&l(D)}).on("error",function(P){j=[],m(P)}).on("end",function(){try{var P=function(D,C,F){switch(D){case"blob":return i.newBlob(i.transformTo("arraybuffer",C),F);case"base64":return d.encode(C);default:return i.transformTo(D,C)}}(k,function(D,C){var F,G=0,te=null,N=0;for(F=0;F<C.length;F++)N+=C[F].length;switch(D){case"string":return C.join("");case"array":return Array.prototype.concat.apply([],C);case"uint8array":for(te=new Uint8Array(N),F=0;F<C.length;F++)te.set(C[F],G),G+=C[F].length;return te;case"nodebuffer":return Buffer.concat(C);default:throw new Error("concat : unsupported type '"+D+"'")}}(S,j),A);x(P)}catch(D){m(D)}j=[]}).resume()})}function h(w,l,x){var m=l;switch(l){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=l,this._mimeType=x,i.checkSupport(m),this._worker=w.pipe(new s(m)),w.lock()}catch(j){this._worker=new n("error"),this._worker.error(j)}}h.prototype={accumulate:function(w){return g(this,w)},on:function(w,l){var x=this;return w==="data"?this._worker.on(w,function(m){l.call(x,m.data,m.meta)}):this._worker.on(w,function(){i.delay(l,arguments,x)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},w)}},u.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,u,f){if(f.base64=!0,f.array=!0,f.string=!0,f.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",f.nodebuffer=typeof Buffer<"u",f.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")f.blob=!1;else{var i=new ArrayBuffer(0);try{f.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),f.blob=s.getBlob("application/zip").size===0}catch{f.blob=!1}}}try{f.nodestream=!!t("readable-stream").Readable}catch{f.nodestream=!1}},{"readable-stream":16}],31:[function(t,u,f){for(var i=t("./utils"),s=t("./support"),n=t("./nodejsUtils"),d=t("./stream/GenericWorker"),b=new Array(256),p=0;p<256;p++)b[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;b[254]=b[254]=1;function v(){d.call(this,"utf-8 decode"),this.leftOver=null}function g(){d.call(this,"utf-8 encode")}f.utf8encode=function(h){return s.nodebuffer?n.newBufferFrom(h,"utf-8"):function(w){var l,x,m,j,S,k=w.length,A=0;for(j=0;j<k;j++)(64512&(x=w.charCodeAt(j)))==55296&&j+1<k&&(64512&(m=w.charCodeAt(j+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),j++),A+=x<128?1:x<2048?2:x<65536?3:4;for(l=s.uint8array?new Uint8Array(A):new Array(A),j=S=0;S<A;j++)(64512&(x=w.charCodeAt(j)))==55296&&j+1<k&&(64512&(m=w.charCodeAt(j+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),j++),x<128?l[S++]=x:(x<2048?l[S++]=192|x>>>6:(x<65536?l[S++]=224|x>>>12:(l[S++]=240|x>>>18,l[S++]=128|x>>>12&63),l[S++]=128|x>>>6&63),l[S++]=128|63&x);return l}(h)},f.utf8decode=function(h){return s.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(w){var l,x,m,j,S=w.length,k=new Array(2*S);for(l=x=0;l<S;)if((m=w[l++])<128)k[x++]=m;else if(4<(j=b[m]))k[x++]=65533,l+=j-1;else{for(m&=j===2?31:j===3?15:7;1<j&&l<S;)m=m<<6|63&w[l++],j--;1<j?k[x++]=65533:m<65536?k[x++]=m:(m-=65536,k[x++]=55296|m>>10&1023,k[x++]=56320|1023&m)}return k.length!==x&&(k.subarray?k=k.subarray(0,x):k.length=x),i.applyFromCharCode(k)}(h=i.transformTo(s.uint8array?"uint8array":"array",h))},i.inherits(v,d),v.prototype.processChunk=function(h){var w=i.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var l=w;(w=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),w.set(l,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var x=function(j,S){var k;for((S=S||j.length)>j.length&&(S=j.length),k=S-1;0<=k&&(192&j[k])==128;)k--;return k<0||k===0?S:k+b[j[k]]>S?k:S}(w),m=w;x!==w.length&&(s.uint8array?(m=w.subarray(0,x),this.leftOver=w.subarray(x,w.length)):(m=w.slice(0,x),this.leftOver=w.slice(x,w.length))),this.push({data:f.utf8decode(m),meta:h.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:f.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},f.Utf8DecodeWorker=v,i.inherits(g,d),g.prototype.processChunk=function(h){this.push({data:f.utf8encode(h.data),meta:h.meta})},f.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,u,f){var i=t("./support"),s=t("./base64"),n=t("./nodejsUtils"),d=t("./external");function b(l){return l}function p(l,x){for(var m=0;m<l.length;++m)x[m]=255&l.charCodeAt(m);return x}t("setimmediate"),f.newBlob=function(l,x){f.checkSupport("blob");try{return new Blob([l],{type:x})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(l),m.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(l,x,m){var j=[],S=0,k=l.length;if(k<=m)return String.fromCharCode.apply(null,l);for(;S<k;)x==="array"||x==="nodebuffer"?j.push(String.fromCharCode.apply(null,l.slice(S,Math.min(S+m,k)))):j.push(String.fromCharCode.apply(null,l.subarray(S,Math.min(S+m,k)))),S+=m;return j.join("")},stringifyByChar:function(l){for(var x="",m=0;m<l.length;m++)x+=String.fromCharCode(l[m]);return x},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function g(l){var x=65536,m=f.getTypeOf(l),j=!0;if(m==="uint8array"?j=v.applyCanBeUsed.uint8array:m==="nodebuffer"&&(j=v.applyCanBeUsed.nodebuffer),j)for(;1<x;)try{return v.stringifyByChunk(l,m,x)}catch{x=Math.floor(x/2)}return v.stringifyByChar(l)}function h(l,x){for(var m=0;m<l.length;m++)x[m]=l[m];return x}f.applyFromCharCode=g;var w={};w.string={string:b,array:function(l){return p(l,new Array(l.length))},arraybuffer:function(l){return w.string.uint8array(l).buffer},uint8array:function(l){return p(l,new Uint8Array(l.length))},nodebuffer:function(l){return p(l,n.allocBuffer(l.length))}},w.array={string:g,array:b,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return n.newBufferFrom(l)}},w.arraybuffer={string:function(l){return g(new Uint8Array(l))},array:function(l){return h(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:b,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return n.newBufferFrom(new Uint8Array(l))}},w.uint8array={string:g,array:function(l){return h(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:b,nodebuffer:function(l){return n.newBufferFrom(l)}},w.nodebuffer={string:g,array:function(l){return h(l,new Array(l.length))},arraybuffer:function(l){return w.nodebuffer.uint8array(l).buffer},uint8array:function(l){return h(l,new Uint8Array(l.length))},nodebuffer:b},f.transformTo=function(l,x){if(x=x||"",!l)return x;f.checkSupport(l);var m=f.getTypeOf(x);return w[m][l](x)},f.resolve=function(l){for(var x=l.split("/"),m=[],j=0;j<x.length;j++){var S=x[j];S==="."||S===""&&j!==0&&j!==x.length-1||(S===".."?m.pop():m.push(S))}return m.join("/")},f.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":i.nodebuffer&&n.isBuffer(l)?"nodebuffer":i.uint8array&&l instanceof Uint8Array?"uint8array":i.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},f.checkSupport=function(l){if(!i[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},f.MAX_VALUE_16BITS=65535,f.MAX_VALUE_32BITS=-1,f.pretty=function(l){var x,m,j="";for(m=0;m<(l||"").length;m++)j+="\\x"+((x=l.charCodeAt(m))<16?"0":"")+x.toString(16).toUpperCase();return j},f.delay=function(l,x,m){setImmediate(function(){l.apply(m||null,x||[])})},f.inherits=function(l,x){function m(){}m.prototype=x.prototype,l.prototype=new m},f.extend=function(){var l,x,m={};for(l=0;l<arguments.length;l++)for(x in arguments[l])Object.prototype.hasOwnProperty.call(arguments[l],x)&&m[x]===void 0&&(m[x]=arguments[l][x]);return m},f.prepareContent=function(l,x,m,j,S){return d.Promise.resolve(x).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new d.Promise(function(A,P){var D=new FileReader;D.onload=function(C){A(C.target.result)},D.onerror=function(C){P(C.target.error)},D.readAsArrayBuffer(k)}):k}).then(function(k){var A=f.getTypeOf(k);return A?(A==="arraybuffer"?k=f.transformTo("uint8array",k):A==="string"&&(S?k=s.decode(k):m&&j!==!0&&(k=function(P){return p(P,i.uint8array?new Uint8Array(P.length):new Array(P.length))}(k))),k):d.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,u,f){var i=t("./reader/readerFor"),s=t("./utils"),n=t("./signature"),d=t("./zipEntry"),b=t("./support");function p(v){this.files=[],this.loadOptions=v}p.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(g)+", expected "+s.pretty(v)+")")}},isSignature:function(v,g){var h=this.reader.index;this.reader.setIndex(v);var w=this.reader.readString(4)===g;return this.reader.setIndex(h),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),g=b.uint8array?"uint8array":"array",h=s.transformTo(g,v);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,g,h,w=this.zip64EndOfCentralSize-44;0<w;)v=this.reader.readInt(2),g=this.reader.readInt(4),h=this.reader.readData(g),this.zip64ExtensibleData[v]={id:v,length:g,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,g;for(v=0;v<this.files.length;v++)g=this.files[v],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(v=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var g=v;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var w=g-h;if(0<w)this.isSignature(g,n.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(v){this.reader=i(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,u,f){var i=t("./reader/readerFor"),s=t("./utils"),n=t("./compressedObject"),d=t("./crc32"),b=t("./utf8"),p=t("./compressions"),v=t("./support");function g(h,w){this.options=h,this.loadOptions=w}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var w,l;if(h.skip(22),this.fileNameLength=h.readInt(2),l=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(x){for(var m in p)if(Object.prototype.hasOwnProperty.call(p,m)&&p[m].magic===x)return p[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,w,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var w=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(w),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var w,l,x,m=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<m;)w=h.readInt(2),l=h.readInt(2),x=h.readData(l),this.extraFields[w]={id:w,length:l,value:x};h.setIndex(m)},handleUTF8:function(){var h=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var l=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var m=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var w=i(h.value);return w.readInt(1)!==1||d(this.fileName)!==w.readInt(4)?null:b.utf8decode(w.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var w=i(h.value);return w.readInt(1)!==1||d(this.fileComment)!==w.readInt(4)?null:b.utf8decode(w.readData(h.length-5))}return null}},u.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,u,f){function i(w,l,x){this.name=w,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=l,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var s=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),d=t("./utf8"),b=t("./compressedObject"),p=t("./stream/GenericWorker");i.prototype={internalStream:function(w){var l=null,x="string";try{if(!w)throw new Error("No output type specified.");var m=(x=w.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),l=this._decompressWorker();var j=!this._dataBinary;j&&!m&&(l=l.pipe(new d.Utf8EncodeWorker)),!j&&m&&(l=l.pipe(new d.Utf8DecodeWorker))}catch(S){(l=new p("error")).error(S)}return new s(l,x,"")},async:function(w,l){return this.internalStream(w).accumulate(l)},nodeStream:function(w,l){return this.internalStream(w||"nodebuffer").toNodejsStream(l)},_compressWorker:function(w,l){if(this._data instanceof b&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new d.Utf8EncodeWorker)),b.createWorkerFrom(x,w,l)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof p?this._data:new n(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<v.length;h++)i.prototype[v[h]]=g;u.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,u,f){(function(i){var s,n,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var b=0,p=new d(w),v=i.document.createTextNode("");p.observe(v,{characterData:!0}),s=function(){v.data=b=++b%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var l=i.document.createElement("script");l.onreadystatechange=function(){w(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},i.document.documentElement.appendChild(l)}:function(){setTimeout(w,0)};else{var g=new i.MessageChannel;g.port1.onmessage=w,s=function(){g.port2.postMessage(0)}}var h=[];function w(){var l,x;n=!0;for(var m=h.length;m;){for(x=h,h=[],l=-1;++l<m;)x[l]();m=h.length}n=!1}u.exports=function(l){h.push(l)!==1||n||s()}}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,u,f){var i=t("immediate");function s(){}var n={},d=["REJECTED"],b=["FULFILLED"],p=["PENDING"];function v(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,m!==s&&l(this,m)}function g(m,j,S){this.promise=m,typeof j=="function"&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function h(m,j,S){i(function(){var k;try{k=j(S)}catch(A){return n.reject(m,A)}k===m?n.reject(m,new TypeError("Cannot resolve promise with itself")):n.resolve(m,k)})}function w(m){var j=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof j=="function")return function(){j.apply(m,arguments)}}function l(m,j){var S=!1;function k(D){S||(S=!0,n.reject(m,D))}function A(D){S||(S=!0,n.resolve(m,D))}var P=x(function(){j(A,k)});P.status==="error"&&k(P.value)}function x(m,j){var S={};try{S.value=m(j),S.status="success"}catch(k){S.status="error",S.value=k}return S}(u.exports=v).prototype.finally=function(m){if(typeof m!="function")return this;var j=this.constructor;return this.then(function(S){return j.resolve(m()).then(function(){return S})},function(S){return j.resolve(m()).then(function(){throw S})})},v.prototype.catch=function(m){return this.then(null,m)},v.prototype.then=function(m,j){if(typeof m!="function"&&this.state===b||typeof j!="function"&&this.state===d)return this;var S=new this.constructor(s);return this.state!==p?h(S,this.state===b?m:j,this.outcome):this.queue.push(new g(S,m,j)),S},g.prototype.callFulfilled=function(m){n.resolve(this.promise,m)},g.prototype.otherCallFulfilled=function(m){h(this.promise,this.onFulfilled,m)},g.prototype.callRejected=function(m){n.reject(this.promise,m)},g.prototype.otherCallRejected=function(m){h(this.promise,this.onRejected,m)},n.resolve=function(m,j){var S=x(w,j);if(S.status==="error")return n.reject(m,S.value);var k=S.value;if(k)l(m,k);else{m.state=b,m.outcome=j;for(var A=-1,P=m.queue.length;++A<P;)m.queue[A].callFulfilled(j)}return m},n.reject=function(m,j){m.state=d,m.outcome=j;for(var S=-1,k=m.queue.length;++S<k;)m.queue[S].callRejected(j);return m},v.resolve=function(m){return m instanceof this?m:n.resolve(new this(s),m)},v.reject=function(m){var j=new this(s);return n.reject(j,m)},v.all=function(m){var j=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,k=!1;if(!S)return this.resolve([]);for(var A=new Array(S),P=0,D=-1,C=new this(s);++D<S;)F(m[D],D);return C;function F(G,te){j.resolve(G).then(function(N){A[te]=N,++P!==S||k||(k=!0,n.resolve(C,A))},function(N){k||(k=!0,n.reject(C,N))})}},v.race=function(m){var j=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,k=!1;if(!S)return this.resolve([]);for(var A=-1,P=new this(s);++A<S;)D=m[A],j.resolve(D).then(function(C){k||(k=!0,n.resolve(P,C))},function(C){k||(k=!0,n.reject(P,C))});var D;return P}},{immediate:36}],38:[function(t,u,f){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),u.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,u,f){var i=t("./zlib/deflate"),s=t("./utils/common"),n=t("./utils/strings"),d=t("./zlib/messages"),b=t("./zlib/zstream"),p=Object.prototype.toString,v=0,g=-1,h=0,w=8;function l(m){if(!(this instanceof l))return new l(m);this.options=s.assign({level:g,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},m||{});var j=this.options;j.raw&&0<j.windowBits?j.windowBits=-j.windowBits:j.gzip&&0<j.windowBits&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(S!==v)throw new Error(d[S]);if(j.header&&i.deflateSetHeader(this.strm,j.header),j.dictionary){var k;if(k=typeof j.dictionary=="string"?n.string2buf(j.dictionary):p.call(j.dictionary)==="[object ArrayBuffer]"?new Uint8Array(j.dictionary):j.dictionary,(S=i.deflateSetDictionary(this.strm,k))!==v)throw new Error(d[S]);this._dict_set=!0}}function x(m,j){var S=new l(j);if(S.push(m,!0),S.err)throw S.msg||d[S.err];return S.result}l.prototype.push=function(m,j){var S,k,A=this.strm,P=this.options.chunkSize;if(this.ended)return!1;k=j===~~j?j:j===!0?4:0,typeof m=="string"?A.input=n.string2buf(m):p.call(m)==="[object ArrayBuffer]"?A.input=new Uint8Array(m):A.input=m,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(P),A.next_out=0,A.avail_out=P),(S=i.deflate(A,k))!==1&&S!==v)return this.onEnd(S),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(s.shrinkBuf(A.output,A.next_out))):this.onData(s.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&S!==1);return k===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===v):k!==2||(this.onEnd(v),!(A.avail_out=0))},l.prototype.onData=function(m){this.chunks.push(m)},l.prototype.onEnd=function(m){m===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},f.Deflate=l,f.deflate=x,f.deflateRaw=function(m,j){return(j=j||{}).raw=!0,x(m,j)},f.gzip=function(m,j){return(j=j||{}).gzip=!0,x(m,j)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,u,f){var i=t("./zlib/inflate"),s=t("./utils/common"),n=t("./utils/strings"),d=t("./zlib/constants"),b=t("./zlib/messages"),p=t("./zlib/zstream"),v=t("./zlib/gzheader"),g=Object.prototype.toString;function h(l){if(!(this instanceof h))return new h(l);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},l||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||l&&l.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var m=i.inflateInit2(this.strm,x.windowBits);if(m!==d.Z_OK)throw new Error(b[m]);this.header=new v,i.inflateGetHeader(this.strm,this.header)}function w(l,x){var m=new h(x);if(m.push(l,!0),m.err)throw m.msg||b[m.err];return m.result}h.prototype.push=function(l,x){var m,j,S,k,A,P,D=this.strm,C=this.options.chunkSize,F=this.options.dictionary,G=!1;if(this.ended)return!1;j=x===~~x?x:x===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof l=="string"?D.input=n.binstring2buf(l):g.call(l)==="[object ArrayBuffer]"?D.input=new Uint8Array(l):D.input=l,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new s.Buf8(C),D.next_out=0,D.avail_out=C),(m=i.inflate(D,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&F&&(P=typeof F=="string"?n.string2buf(F):g.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,m=i.inflateSetDictionary(this.strm,P)),m===d.Z_BUF_ERROR&&G===!0&&(m=d.Z_OK,G=!1),m!==d.Z_STREAM_END&&m!==d.Z_OK)return this.onEnd(m),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&m!==d.Z_STREAM_END&&(D.avail_in!==0||j!==d.Z_FINISH&&j!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=n.utf8border(D.output,D.next_out),k=D.next_out-S,A=n.buf2string(D.output,S),D.next_out=k,D.avail_out=C-k,k&&s.arraySet(D.output,D.output,S,k,0),this.onData(A)):this.onData(s.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(G=!0)}while((0<D.avail_in||D.avail_out===0)&&m!==d.Z_STREAM_END);return m===d.Z_STREAM_END&&(j=d.Z_FINISH),j===d.Z_FINISH?(m=i.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===d.Z_OK):j!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(D.avail_out=0))},h.prototype.onData=function(l){this.chunks.push(l)},h.prototype.onEnd=function(l){l===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},f.Inflate=h,f.inflate=w,f.inflateRaw=function(l,x){return(x=x||{}).raw=!0,w(l,x)},f.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,u,f){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";f.assign=function(d){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var p=b.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var v in p)p.hasOwnProperty(v)&&(d[v]=p[v])}}return d},f.shrinkBuf=function(d,b){return d.length===b?d:d.subarray?d.subarray(0,b):(d.length=b,d)};var s={arraySet:function(d,b,p,v,g){if(b.subarray&&d.subarray)d.set(b.subarray(p,p+v),g);else for(var h=0;h<v;h++)d[g+h]=b[p+h]},flattenChunks:function(d){var b,p,v,g,h,w;for(b=v=0,p=d.length;b<p;b++)v+=d[b].length;for(w=new Uint8Array(v),b=g=0,p=d.length;b<p;b++)h=d[b],w.set(h,g),g+=h.length;return w}},n={arraySet:function(d,b,p,v,g){for(var h=0;h<v;h++)d[g+h]=b[p+h]},flattenChunks:function(d){return[].concat.apply([],d)}};f.setTyped=function(d){d?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,s)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,n))},f.setTyped(i)},{}],42:[function(t,u,f){var i=t("./common"),s=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var d=new i.Buf8(256),b=0;b<256;b++)d[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function p(v,g){if(g<65537&&(v.subarray&&n||!v.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(v,g));for(var h="",w=0;w<g;w++)h+=String.fromCharCode(v[w]);return h}d[254]=d[254]=1,f.string2buf=function(v){var g,h,w,l,x,m=v.length,j=0;for(l=0;l<m;l++)(64512&(h=v.charCodeAt(l)))==55296&&l+1<m&&(64512&(w=v.charCodeAt(l+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),l++),j+=h<128?1:h<2048?2:h<65536?3:4;for(g=new i.Buf8(j),l=x=0;x<j;l++)(64512&(h=v.charCodeAt(l)))==55296&&l+1<m&&(64512&(w=v.charCodeAt(l+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),l++),h<128?g[x++]=h:(h<2048?g[x++]=192|h>>>6:(h<65536?g[x++]=224|h>>>12:(g[x++]=240|h>>>18,g[x++]=128|h>>>12&63),g[x++]=128|h>>>6&63),g[x++]=128|63&h);return g},f.buf2binstring=function(v){return p(v,v.length)},f.binstring2buf=function(v){for(var g=new i.Buf8(v.length),h=0,w=g.length;h<w;h++)g[h]=v.charCodeAt(h);return g},f.buf2string=function(v,g){var h,w,l,x,m=g||v.length,j=new Array(2*m);for(h=w=0;h<m;)if((l=v[h++])<128)j[w++]=l;else if(4<(x=d[l]))j[w++]=65533,h+=x-1;else{for(l&=x===2?31:x===3?15:7;1<x&&h<m;)l=l<<6|63&v[h++],x--;1<x?j[w++]=65533:l<65536?j[w++]=l:(l-=65536,j[w++]=55296|l>>10&1023,j[w++]=56320|1023&l)}return p(j,w)},f.utf8border=function(v,g){var h;for((g=g||v.length)>v.length&&(g=v.length),h=g-1;0<=h&&(192&v[h])==128;)h--;return h<0||h===0?g:h+d[v[h]]>g?h:g}},{"./common":41}],43:[function(t,u,f){u.exports=function(i,s,n,d){for(var b=65535&i|0,p=i>>>16&65535|0,v=0;n!==0;){for(n-=v=2e3<n?2e3:n;p=p+(b=b+s[d++]|0)|0,--v;);b%=65521,p%=65521}return b|p<<16|0}},{}],44:[function(t,u,f){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,u,f){var i=function(){for(var s,n=[],d=0;d<256;d++){s=d;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;n[d]=s}return n}();u.exports=function(s,n,d,b){var p=i,v=b+d;s^=-1;for(var g=b;g<v;g++)s=s>>>8^p[255&(s^n[g])];return-1^s}},{}],46:[function(t,u,f){var i,s=t("../utils/common"),n=t("./trees"),d=t("./adler32"),b=t("./crc32"),p=t("./messages"),v=0,g=4,h=0,w=-2,l=-1,x=4,m=2,j=8,S=9,k=286,A=30,P=19,D=2*k+1,C=15,F=3,G=258,te=G+F+1,N=42,I=113,o=1,B=2,J=3,$=4;function ae(a,U){return a.msg=p[U],U}function W(a){return(a<<1)-(4<a?9:0)}function re(a){for(var U=a.length;0<=--U;)a[U]=0}function O(a){var U=a.state,T=U.pending;T>a.avail_out&&(T=a.avail_out),T!==0&&(s.arraySet(a.output,U.pending_buf,U.pending_out,T,a.next_out),a.next_out+=T,U.pending_out+=T,a.total_out+=T,a.avail_out-=T,U.pending-=T,U.pending===0&&(U.pending_out=0))}function R(a,U){n._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,U),a.block_start=a.strstart,O(a.strm)}function X(a,U){a.pending_buf[a.pending++]=U}function Y(a,U){a.pending_buf[a.pending++]=U>>>8&255,a.pending_buf[a.pending++]=255&U}function H(a,U){var T,_,y=a.max_chain_length,E=a.strstart,M=a.prev_length,Z=a.nice_match,z=a.strstart>a.w_size-te?a.strstart-(a.w_size-te):0,q=a.window,Q=a.w_mask,V=a.prev,se=a.strstart+G,be=q[E+M-1],ce=q[E+M];a.prev_length>=a.good_match&&(y>>=2),Z>a.lookahead&&(Z=a.lookahead);do if(q[(T=U)+M]===ce&&q[T+M-1]===be&&q[T]===q[E]&&q[++T]===q[E+1]){E+=2,T++;do;while(q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&q[++E]===q[++T]&&E<se);if(_=G-(se-E),E=se-G,M<_){if(a.match_start=U,Z<=(M=_))break;be=q[E+M-1],ce=q[E+M]}}while((U=V[U&Q])>z&&--y!=0);return M<=a.lookahead?M:a.lookahead}function me(a){var U,T,_,y,E,M,Z,z,q,Q,V=a.w_size;do{if(y=a.window_size-a.lookahead-a.strstart,a.strstart>=V+(V-te)){for(s.arraySet(a.window,a.window,V,V,0),a.match_start-=V,a.strstart-=V,a.block_start-=V,U=T=a.hash_size;_=a.head[--U],a.head[U]=V<=_?_-V:0,--T;);for(U=T=V;_=a.prev[--U],a.prev[U]=V<=_?_-V:0,--T;);y+=V}if(a.strm.avail_in===0)break;if(M=a.strm,Z=a.window,z=a.strstart+a.lookahead,q=y,Q=void 0,Q=M.avail_in,q<Q&&(Q=q),T=Q===0?0:(M.avail_in-=Q,s.arraySet(Z,M.input,M.next_in,Q,z),M.state.wrap===1?M.adler=d(M.adler,Z,Q,z):M.state.wrap===2&&(M.adler=b(M.adler,Z,Q,z)),M.next_in+=Q,M.total_in+=Q,Q),a.lookahead+=T,a.lookahead+a.insert>=F)for(E=a.strstart-a.insert,a.ins_h=a.window[E],a.ins_h=(a.ins_h<<a.hash_shift^a.window[E+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[E+F-1])&a.hash_mask,a.prev[E&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=E,E++,a.insert--,!(a.lookahead+a.insert<F)););}while(a.lookahead<te&&a.strm.avail_in!==0)}function ye(a,U){for(var T,_;;){if(a.lookahead<te){if(me(a),a.lookahead<te&&U===v)return o;if(a.lookahead===0)break}if(T=0,a.lookahead>=F&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,T=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),T!==0&&a.strstart-T<=a.w_size-te&&(a.match_length=H(a,T)),a.match_length>=F)if(_=n._tr_tally(a,a.strstart-a.match_start,a.match_length-F),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=F){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,T=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else _=n._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(_&&(R(a,!1),a.strm.avail_out===0))return o}return a.insert=a.strstart<F-1?a.strstart:F-1,U===g?(R(a,!0),a.strm.avail_out===0?J:$):a.last_lit&&(R(a,!1),a.strm.avail_out===0)?o:B}function oe(a,U){for(var T,_,y;;){if(a.lookahead<te){if(me(a),a.lookahead<te&&U===v)return o;if(a.lookahead===0)break}if(T=0,a.lookahead>=F&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,T=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=F-1,T!==0&&a.prev_length<a.max_lazy_match&&a.strstart-T<=a.w_size-te&&(a.match_length=H(a,T),a.match_length<=5&&(a.strategy===1||a.match_length===F&&4096<a.strstart-a.match_start)&&(a.match_length=F-1)),a.prev_length>=F&&a.match_length<=a.prev_length){for(y=a.strstart+a.lookahead-F,_=n._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-F),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=y&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,T=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=F-1,a.strstart++,_&&(R(a,!1),a.strm.avail_out===0))return o}else if(a.match_available){if((_=n._tr_tally(a,0,a.window[a.strstart-1]))&&R(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return o}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(_=n._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<F-1?a.strstart:F-1,U===g?(R(a,!0),a.strm.avail_out===0?J:$):a.last_lit&&(R(a,!1),a.strm.avail_out===0)?o:B}function le(a,U,T,_,y){this.good_length=a,this.max_lazy=U,this.nice_length=T,this.max_chain=_,this.func=y}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=j,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*D),this.dyn_dtree=new s.Buf16(2*(2*A+1)),this.bl_tree=new s.Buf16(2*(2*P+1)),re(this.dyn_ltree),re(this.dyn_dtree),re(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(C+1),this.heap=new s.Buf16(2*k+1),re(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),re(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ge(a){var U;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=m,(U=a.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?N:I,a.adler=U.wrap===2?0:1,U.last_flush=v,n._tr_init(U),h):ae(a,w)}function ke(a){var U=ge(a);return U===h&&function(T){T.window_size=2*T.w_size,re(T.head),T.max_lazy_match=i[T.level].max_lazy,T.good_match=i[T.level].good_length,T.nice_match=i[T.level].nice_length,T.max_chain_length=i[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=F-1,T.match_available=0,T.ins_h=0}(a.state),U}function Ee(a,U,T,_,y,E){if(!a)return w;var M=1;if(U===l&&(U=6),_<0?(M=0,_=-_):15<_&&(M=2,_-=16),y<1||S<y||T!==j||_<8||15<_||U<0||9<U||E<0||x<E)return ae(a,w);_===8&&(_=9);var Z=new ve;return(a.state=Z).strm=a,Z.wrap=M,Z.gzhead=null,Z.w_bits=_,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=y+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+F-1)/F),Z.window=new s.Buf8(2*Z.w_size),Z.head=new s.Buf16(Z.hash_size),Z.prev=new s.Buf16(Z.w_size),Z.lit_bufsize=1<<y+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new s.Buf8(Z.pending_buf_size),Z.d_buf=1*Z.lit_bufsize,Z.l_buf=3*Z.lit_bufsize,Z.level=U,Z.strategy=E,Z.method=T,ke(a)}i=[new le(0,0,0,0,function(a,U){var T=65535;for(T>a.pending_buf_size-5&&(T=a.pending_buf_size-5);;){if(a.lookahead<=1){if(me(a),a.lookahead===0&&U===v)return o;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var _=a.block_start+T;if((a.strstart===0||a.strstart>=_)&&(a.lookahead=a.strstart-_,a.strstart=_,R(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-te&&(R(a,!1),a.strm.avail_out===0))return o}return a.insert=0,U===g?(R(a,!0),a.strm.avail_out===0?J:$):(a.strstart>a.block_start&&(R(a,!1),a.strm.avail_out),o)}),new le(4,4,8,4,ye),new le(4,5,16,8,ye),new le(4,6,32,32,ye),new le(4,4,16,16,oe),new le(8,16,32,32,oe),new le(8,16,128,128,oe),new le(8,32,128,256,oe),new le(32,128,258,1024,oe),new le(32,258,258,4096,oe)],f.deflateInit=function(a,U){return Ee(a,U,j,15,8,0)},f.deflateInit2=Ee,f.deflateReset=ke,f.deflateResetKeep=ge,f.deflateSetHeader=function(a,U){return a&&a.state?a.state.wrap!==2?w:(a.state.gzhead=U,h):w},f.deflate=function(a,U){var T,_,y,E;if(!a||!a.state||5<U||U<0)return a?ae(a,w):w;if(_=a.state,!a.output||!a.input&&a.avail_in!==0||_.status===666&&U!==g)return ae(a,a.avail_out===0?-5:w);if(_.strm=a,T=_.last_flush,_.last_flush=U,_.status===N)if(_.wrap===2)a.adler=0,X(_,31),X(_,139),X(_,8),_.gzhead?(X(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),X(_,255&_.gzhead.time),X(_,_.gzhead.time>>8&255),X(_,_.gzhead.time>>16&255),X(_,_.gzhead.time>>24&255),X(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),X(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(X(_,255&_.gzhead.extra.length),X(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(a.adler=b(a.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(X(_,0),X(_,0),X(_,0),X(_,0),X(_,0),X(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),X(_,3),_.status=I);else{var M=j+(_.w_bits-8<<4)<<8;M|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&(M|=32),M+=31-M%31,_.status=I,Y(_,M),_.strstart!==0&&(Y(_,a.adler>>>16),Y(_,65535&a.adler)),a.adler=1}if(_.status===69)if(_.gzhead.extra){for(y=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),O(a),y=_.pending,_.pending!==_.pending_buf_size));)X(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),O(a),y=_.pending,_.pending===_.pending_buf_size)){E=1;break}E=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,X(_,E)}while(E!==0);_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),E===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),O(a),y=_.pending,_.pending===_.pending_buf_size)){E=1;break}E=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,X(_,E)}while(E!==0);_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),E===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&O(a),_.pending+2<=_.pending_buf_size&&(X(_,255&a.adler),X(_,a.adler>>8&255),a.adler=0,_.status=I)):_.status=I),_.pending!==0){if(O(a),a.avail_out===0)return _.last_flush=-1,h}else if(a.avail_in===0&&W(U)<=W(T)&&U!==g)return ae(a,-5);if(_.status===666&&a.avail_in!==0)return ae(a,-5);if(a.avail_in!==0||_.lookahead!==0||U!==v&&_.status!==666){var Z=_.strategy===2?function(z,q){for(var Q;;){if(z.lookahead===0&&(me(z),z.lookahead===0)){if(q===v)return o;break}if(z.match_length=0,Q=n._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,Q&&(R(z,!1),z.strm.avail_out===0))return o}return z.insert=0,q===g?(R(z,!0),z.strm.avail_out===0?J:$):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?o:B}(_,U):_.strategy===3?function(z,q){for(var Q,V,se,be,ce=z.window;;){if(z.lookahead<=G){if(me(z),z.lookahead<=G&&q===v)return o;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=F&&0<z.strstart&&(V=ce[se=z.strstart-1])===ce[++se]&&V===ce[++se]&&V===ce[++se]){be=z.strstart+G;do;while(V===ce[++se]&&V===ce[++se]&&V===ce[++se]&&V===ce[++se]&&V===ce[++se]&&V===ce[++se]&&V===ce[++se]&&V===ce[++se]&&se<be);z.match_length=G-(be-se),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=F?(Q=n._tr_tally(z,1,z.match_length-F),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(Q=n._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),Q&&(R(z,!1),z.strm.avail_out===0))return o}return z.insert=0,q===g?(R(z,!0),z.strm.avail_out===0?J:$):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?o:B}(_,U):i[_.level].func(_,U);if(Z!==J&&Z!==$||(_.status=666),Z===o||Z===J)return a.avail_out===0&&(_.last_flush=-1),h;if(Z===B&&(U===1?n._tr_align(_):U!==5&&(n._tr_stored_block(_,0,0,!1),U===3&&(re(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),O(a),a.avail_out===0))return _.last_flush=-1,h}return U!==g?h:_.wrap<=0?1:(_.wrap===2?(X(_,255&a.adler),X(_,a.adler>>8&255),X(_,a.adler>>16&255),X(_,a.adler>>24&255),X(_,255&a.total_in),X(_,a.total_in>>8&255),X(_,a.total_in>>16&255),X(_,a.total_in>>24&255)):(Y(_,a.adler>>>16),Y(_,65535&a.adler)),O(a),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?h:1)},f.deflateEnd=function(a){var U;return a&&a.state?(U=a.state.status)!==N&&U!==69&&U!==73&&U!==91&&U!==103&&U!==I&&U!==666?ae(a,w):(a.state=null,U===I?ae(a,-3):h):w},f.deflateSetDictionary=function(a,U){var T,_,y,E,M,Z,z,q,Q=U.length;if(!a||!a.state||(E=(T=a.state).wrap)===2||E===1&&T.status!==N||T.lookahead)return w;for(E===1&&(a.adler=d(a.adler,U,Q,0)),T.wrap=0,Q>=T.w_size&&(E===0&&(re(T.head),T.strstart=0,T.block_start=0,T.insert=0),q=new s.Buf8(T.w_size),s.arraySet(q,U,Q-T.w_size,T.w_size,0),U=q,Q=T.w_size),M=a.avail_in,Z=a.next_in,z=a.input,a.avail_in=Q,a.next_in=0,a.input=U,me(T);T.lookahead>=F;){for(_=T.strstart,y=T.lookahead-(F-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[_+F-1])&T.hash_mask,T.prev[_&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=_,_++,--y;);T.strstart=_,T.lookahead=F-1,me(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=F-1,T.match_available=0,a.next_in=Z,a.input=z,a.avail_in=M,T.wrap=E,h},f.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,u,f){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,u,f){u.exports=function(i,s){var n,d,b,p,v,g,h,w,l,x,m,j,S,k,A,P,D,C,F,G,te,N,I,o,B;n=i.state,d=i.next_in,o=i.input,b=d+(i.avail_in-5),p=i.next_out,B=i.output,v=p-(s-i.avail_out),g=p+(i.avail_out-257),h=n.dmax,w=n.wsize,l=n.whave,x=n.wnext,m=n.window,j=n.hold,S=n.bits,k=n.lencode,A=n.distcode,P=(1<<n.lenbits)-1,D=(1<<n.distbits)-1;e:do{S<15&&(j+=o[d++]<<S,S+=8,j+=o[d++]<<S,S+=8),C=k[j&P];t:for(;;){if(j>>>=F=C>>>24,S-=F,(F=C>>>16&255)===0)B[p++]=65535&C;else{if(!(16&F)){if(!(64&F)){C=k[(65535&C)+(j&(1<<F)-1)];continue t}if(32&F){n.mode=12;break e}i.msg="invalid literal/length code",n.mode=30;break e}G=65535&C,(F&=15)&&(S<F&&(j+=o[d++]<<S,S+=8),G+=j&(1<<F)-1,j>>>=F,S-=F),S<15&&(j+=o[d++]<<S,S+=8,j+=o[d++]<<S,S+=8),C=A[j&D];r:for(;;){if(j>>>=F=C>>>24,S-=F,!(16&(F=C>>>16&255))){if(!(64&F)){C=A[(65535&C)+(j&(1<<F)-1)];continue r}i.msg="invalid distance code",n.mode=30;break e}if(te=65535&C,S<(F&=15)&&(j+=o[d++]<<S,(S+=8)<F&&(j+=o[d++]<<S,S+=8)),h<(te+=j&(1<<F)-1)){i.msg="invalid distance too far back",n.mode=30;break e}if(j>>>=F,S-=F,(F=p-v)<te){if(l<(F=te-F)&&n.sane){i.msg="invalid distance too far back",n.mode=30;break e}if(I=m,(N=0)===x){if(N+=w-F,F<G){for(G-=F;B[p++]=m[N++],--F;);N=p-te,I=B}}else if(x<F){if(N+=w+x-F,(F-=x)<G){for(G-=F;B[p++]=m[N++],--F;);if(N=0,x<G){for(G-=F=x;B[p++]=m[N++],--F;);N=p-te,I=B}}}else if(N+=x-F,F<G){for(G-=F;B[p++]=m[N++],--F;);N=p-te,I=B}for(;2<G;)B[p++]=I[N++],B[p++]=I[N++],B[p++]=I[N++],G-=3;G&&(B[p++]=I[N++],1<G&&(B[p++]=I[N++]))}else{for(N=p-te;B[p++]=B[N++],B[p++]=B[N++],B[p++]=B[N++],2<(G-=3););G&&(B[p++]=B[N++],1<G&&(B[p++]=B[N++]))}break}}break}}while(d<b&&p<g);d-=G=S>>3,j&=(1<<(S-=G<<3))-1,i.next_in=d,i.next_out=p,i.avail_in=d<b?b-d+5:5-(d-b),i.avail_out=p<g?g-p+257:257-(p-g),n.hold=j,n.bits=S}},{}],49:[function(t,u,f){var i=t("../utils/common"),s=t("./adler32"),n=t("./crc32"),d=t("./inffast"),b=t("./inftrees"),p=1,v=2,g=0,h=-2,w=1,l=852,x=592;function m(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(N){var I;return N&&N.state?(I=N.state,N.total_in=N.total_out=I.total=0,N.msg="",I.wrap&&(N.adler=1&I.wrap),I.mode=w,I.last=0,I.havedict=0,I.dmax=32768,I.head=null,I.hold=0,I.bits=0,I.lencode=I.lendyn=new i.Buf32(l),I.distcode=I.distdyn=new i.Buf32(x),I.sane=1,I.back=-1,g):h}function k(N){var I;return N&&N.state?((I=N.state).wsize=0,I.whave=0,I.wnext=0,S(N)):h}function A(N,I){var o,B;return N&&N.state?(B=N.state,I<0?(o=0,I=-I):(o=1+(I>>4),I<48&&(I&=15)),I&&(I<8||15<I)?h:(B.window!==null&&B.wbits!==I&&(B.window=null),B.wrap=o,B.wbits=I,k(N))):h}function P(N,I){var o,B;return N?(B=new j,(N.state=B).window=null,(o=A(N,I))!==g&&(N.state=null),o):h}var D,C,F=!0;function G(N){if(F){var I;for(D=new i.Buf32(512),C=new i.Buf32(32),I=0;I<144;)N.lens[I++]=8;for(;I<256;)N.lens[I++]=9;for(;I<280;)N.lens[I++]=7;for(;I<288;)N.lens[I++]=8;for(b(p,N.lens,0,288,D,0,N.work,{bits:9}),I=0;I<32;)N.lens[I++]=5;b(v,N.lens,0,32,C,0,N.work,{bits:5}),F=!1}N.lencode=D,N.lenbits=9,N.distcode=C,N.distbits=5}function te(N,I,o,B){var J,$=N.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new i.Buf8($.wsize)),B>=$.wsize?(i.arraySet($.window,I,o-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(B<(J=$.wsize-$.wnext)&&(J=B),i.arraySet($.window,I,o-B,J,$.wnext),(B-=J)?(i.arraySet($.window,I,o-B,B,0),$.wnext=B,$.whave=$.wsize):($.wnext+=J,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=J))),0}f.inflateReset=k,f.inflateReset2=A,f.inflateResetKeep=S,f.inflateInit=function(N){return P(N,15)},f.inflateInit2=P,f.inflate=function(N,I){var o,B,J,$,ae,W,re,O,R,X,Y,H,me,ye,oe,le,ve,ge,ke,Ee,a,U,T,_,y=0,E=new i.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return h;(o=N.state).mode===12&&(o.mode=13),ae=N.next_out,J=N.output,re=N.avail_out,$=N.next_in,B=N.input,W=N.avail_in,O=o.hold,R=o.bits,X=W,Y=re,U=g;e:for(;;)switch(o.mode){case w:if(o.wrap===0){o.mode=13;break}for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(2&o.wrap&&O===35615){E[o.check=0]=255&O,E[1]=O>>>8&255,o.check=n(o.check,E,2,0),R=O=0,o.mode=2;break}if(o.flags=0,o.head&&(o.head.done=!1),!(1&o.wrap)||(((255&O)<<8)+(O>>8))%31){N.msg="incorrect header check",o.mode=30;break}if((15&O)!=8){N.msg="unknown compression method",o.mode=30;break}if(R-=4,a=8+(15&(O>>>=4)),o.wbits===0)o.wbits=a;else if(a>o.wbits){N.msg="invalid window size",o.mode=30;break}o.dmax=1<<a,N.adler=o.check=1,o.mode=512&O?10:12,R=O=0;break;case 2:for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(o.flags=O,(255&o.flags)!=8){N.msg="unknown compression method",o.mode=30;break}if(57344&o.flags){N.msg="unknown header flags set",o.mode=30;break}o.head&&(o.head.text=O>>8&1),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,o.check=n(o.check,E,2,0)),R=O=0,o.mode=3;case 3:for(;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.head&&(o.head.time=O),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,E[2]=O>>>16&255,E[3]=O>>>24&255,o.check=n(o.check,E,4,0)),R=O=0,o.mode=4;case 4:for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.head&&(o.head.xflags=255&O,o.head.os=O>>8),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,o.check=n(o.check,E,2,0)),R=O=0,o.mode=5;case 5:if(1024&o.flags){for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.length=O,o.head&&(o.head.extra_len=O),512&o.flags&&(E[0]=255&O,E[1]=O>>>8&255,o.check=n(o.check,E,2,0)),R=O=0}else o.head&&(o.head.extra=null);o.mode=6;case 6:if(1024&o.flags&&(W<(H=o.length)&&(H=W),H&&(o.head&&(a=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),i.arraySet(o.head.extra,B,$,H,a)),512&o.flags&&(o.check=n(o.check,B,H,$)),W-=H,$+=H,o.length-=H),o.length))break e;o.length=0,o.mode=7;case 7:if(2048&o.flags){if(W===0)break e;for(H=0;a=B[$+H++],o.head&&a&&o.length<65536&&(o.head.name+=String.fromCharCode(a)),a&&H<W;);if(512&o.flags&&(o.check=n(o.check,B,H,$)),W-=H,$+=H,a)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=8;case 8:if(4096&o.flags){if(W===0)break e;for(H=0;a=B[$+H++],o.head&&a&&o.length<65536&&(o.head.comment+=String.fromCharCode(a)),a&&H<W;);if(512&o.flags&&(o.check=n(o.check,B,H,$)),W-=H,$+=H,a)break e}else o.head&&(o.head.comment=null);o.mode=9;case 9:if(512&o.flags){for(;R<16;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(O!==(65535&o.check)){N.msg="header crc mismatch",o.mode=30;break}R=O=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),N.adler=o.check=0,o.mode=12;break;case 10:for(;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}N.adler=o.check=m(O),R=O=0,o.mode=11;case 11:if(o.havedict===0)return N.next_out=ae,N.avail_out=re,N.next_in=$,N.avail_in=W,o.hold=O,o.bits=R,2;N.adler=o.check=1,o.mode=12;case 12:if(I===5||I===6)break e;case 13:if(o.last){O>>>=7&R,R-=7&R,o.mode=27;break}for(;R<3;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}switch(o.last=1&O,R-=1,3&(O>>>=1)){case 0:o.mode=14;break;case 1:if(G(o),o.mode=20,I!==6)break;O>>>=2,R-=2;break e;case 2:o.mode=17;break;case 3:N.msg="invalid block type",o.mode=30}O>>>=2,R-=2;break;case 14:for(O>>>=7&R,R-=7&R;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if((65535&O)!=(O>>>16^65535)){N.msg="invalid stored block lengths",o.mode=30;break}if(o.length=65535&O,R=O=0,o.mode=15,I===6)break e;case 15:o.mode=16;case 16:if(H=o.length){if(W<H&&(H=W),re<H&&(H=re),H===0)break e;i.arraySet(J,B,$,H,ae),W-=H,$+=H,re-=H,ae+=H,o.length-=H;break}o.mode=12;break;case 17:for(;R<14;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(o.nlen=257+(31&O),O>>>=5,R-=5,o.ndist=1+(31&O),O>>>=5,R-=5,o.ncode=4+(15&O),O>>>=4,R-=4,286<o.nlen||30<o.ndist){N.msg="too many length or distance symbols",o.mode=30;break}o.have=0,o.mode=18;case 18:for(;o.have<o.ncode;){for(;R<3;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.lens[M[o.have++]]=7&O,O>>>=3,R-=3}for(;o.have<19;)o.lens[M[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,T={bits:o.lenbits},U=b(0,o.lens,0,19,o.lencode,0,o.work,T),o.lenbits=T.bits,U){N.msg="invalid code lengths set",o.mode=30;break}o.have=0,o.mode=19;case 19:for(;o.have<o.nlen+o.ndist;){for(;le=(y=o.lencode[O&(1<<o.lenbits)-1])>>>16&255,ve=65535&y,!((oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(ve<16)O>>>=oe,R-=oe,o.lens[o.have++]=ve;else{if(ve===16){for(_=oe+2;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(O>>>=oe,R-=oe,o.have===0){N.msg="invalid bit length repeat",o.mode=30;break}a=o.lens[o.have-1],H=3+(3&O),O>>>=2,R-=2}else if(ve===17){for(_=oe+3;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}R-=oe,a=0,H=3+(7&(O>>>=oe)),O>>>=3,R-=3}else{for(_=oe+7;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}R-=oe,a=0,H=11+(127&(O>>>=oe)),O>>>=7,R-=7}if(o.have+H>o.nlen+o.ndist){N.msg="invalid bit length repeat",o.mode=30;break}for(;H--;)o.lens[o.have++]=a}}if(o.mode===30)break;if(o.lens[256]===0){N.msg="invalid code -- missing end-of-block",o.mode=30;break}if(o.lenbits=9,T={bits:o.lenbits},U=b(p,o.lens,0,o.nlen,o.lencode,0,o.work,T),o.lenbits=T.bits,U){N.msg="invalid literal/lengths set",o.mode=30;break}if(o.distbits=6,o.distcode=o.distdyn,T={bits:o.distbits},U=b(v,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,T),o.distbits=T.bits,U){N.msg="invalid distances set",o.mode=30;break}if(o.mode=20,I===6)break e;case 20:o.mode=21;case 21:if(6<=W&&258<=re){N.next_out=ae,N.avail_out=re,N.next_in=$,N.avail_in=W,o.hold=O,o.bits=R,d(N,Y),ae=N.next_out,J=N.output,re=N.avail_out,$=N.next_in,B=N.input,W=N.avail_in,O=o.hold,R=o.bits,o.mode===12&&(o.back=-1);break}for(o.back=0;le=(y=o.lencode[O&(1<<o.lenbits)-1])>>>16&255,ve=65535&y,!((oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(le&&!(240&le)){for(ge=oe,ke=le,Ee=ve;le=(y=o.lencode[Ee+((O&(1<<ge+ke)-1)>>ge)])>>>16&255,ve=65535&y,!(ge+(oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}O>>>=ge,R-=ge,o.back+=ge}if(O>>>=oe,R-=oe,o.back+=oe,o.length=ve,le===0){o.mode=26;break}if(32&le){o.back=-1,o.mode=12;break}if(64&le){N.msg="invalid literal/length code",o.mode=30;break}o.extra=15&le,o.mode=22;case 22:if(o.extra){for(_=o.extra;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.length+=O&(1<<o.extra)-1,O>>>=o.extra,R-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=23;case 23:for(;le=(y=o.distcode[O&(1<<o.distbits)-1])>>>16&255,ve=65535&y,!((oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(!(240&le)){for(ge=oe,ke=le,Ee=ve;le=(y=o.distcode[Ee+((O&(1<<ge+ke)-1)>>ge)])>>>16&255,ve=65535&y,!(ge+(oe=y>>>24)<=R);){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}O>>>=ge,R-=ge,o.back+=ge}if(O>>>=oe,R-=oe,o.back+=oe,64&le){N.msg="invalid distance code",o.mode=30;break}o.offset=ve,o.extra=15&le,o.mode=24;case 24:if(o.extra){for(_=o.extra;R<_;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}o.offset+=O&(1<<o.extra)-1,O>>>=o.extra,R-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){N.msg="invalid distance too far back",o.mode=30;break}o.mode=25;case 25:if(re===0)break e;if(H=Y-re,o.offset>H){if((H=o.offset-H)>o.whave&&o.sane){N.msg="invalid distance too far back",o.mode=30;break}me=H>o.wnext?(H-=o.wnext,o.wsize-H):o.wnext-H,H>o.length&&(H=o.length),ye=o.window}else ye=J,me=ae-o.offset,H=o.length;for(re<H&&(H=re),re-=H,o.length-=H;J[ae++]=ye[me++],--H;);o.length===0&&(o.mode=21);break;case 26:if(re===0)break e;J[ae++]=o.length,re--,o.mode=21;break;case 27:if(o.wrap){for(;R<32;){if(W===0)break e;W--,O|=B[$++]<<R,R+=8}if(Y-=re,N.total_out+=Y,o.total+=Y,Y&&(N.adler=o.check=o.flags?n(o.check,J,Y,ae-Y):s(o.check,J,Y,ae-Y)),Y=re,(o.flags?O:m(O))!==o.check){N.msg="incorrect data check",o.mode=30;break}R=O=0}o.mode=28;case 28:if(o.wrap&&o.flags){for(;R<32;){if(W===0)break e;W--,O+=B[$++]<<R,R+=8}if(O!==(4294967295&o.total)){N.msg="incorrect length check",o.mode=30;break}R=O=0}o.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return h}return N.next_out=ae,N.avail_out=re,N.next_in=$,N.avail_in=W,o.hold=O,o.bits=R,(o.wsize||Y!==N.avail_out&&o.mode<30&&(o.mode<27||I!==4))&&te(N,N.output,N.next_out,Y-N.avail_out)?(o.mode=31,-4):(X-=N.avail_in,Y-=N.avail_out,N.total_in+=X,N.total_out+=Y,o.total+=Y,o.wrap&&Y&&(N.adler=o.check=o.flags?n(o.check,J,Y,N.next_out-Y):s(o.check,J,Y,N.next_out-Y)),N.data_type=o.bits+(o.last?64:0)+(o.mode===12?128:0)+(o.mode===20||o.mode===15?256:0),(X==0&&Y===0||I===4)&&U===g&&(U=-5),U)},f.inflateEnd=function(N){if(!N||!N.state)return h;var I=N.state;return I.window&&(I.window=null),N.state=null,g},f.inflateGetHeader=function(N,I){var o;return N&&N.state&&2&(o=N.state).wrap?((o.head=I).done=!1,g):h},f.inflateSetDictionary=function(N,I){var o,B=I.length;return N&&N.state?(o=N.state).wrap!==0&&o.mode!==11?h:o.mode===11&&s(1,I,B,0)!==o.check?-3:te(N,I,B,B)?(o.mode=31,-4):(o.havedict=1,g):h},f.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,u,f){var i=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(p,v,g,h,w,l,x,m){var j,S,k,A,P,D,C,F,G,te=m.bits,N=0,I=0,o=0,B=0,J=0,$=0,ae=0,W=0,re=0,O=0,R=null,X=0,Y=new i.Buf16(16),H=new i.Buf16(16),me=null,ye=0;for(N=0;N<=15;N++)Y[N]=0;for(I=0;I<h;I++)Y[v[g+I]]++;for(J=te,B=15;1<=B&&Y[B]===0;B--);if(B<J&&(J=B),B===0)return w[l++]=20971520,w[l++]=20971520,m.bits=1,0;for(o=1;o<B&&Y[o]===0;o++);for(J<o&&(J=o),N=W=1;N<=15;N++)if(W<<=1,(W-=Y[N])<0)return-1;if(0<W&&(p===0||B!==1))return-1;for(H[1]=0,N=1;N<15;N++)H[N+1]=H[N]+Y[N];for(I=0;I<h;I++)v[g+I]!==0&&(x[H[v[g+I]]++]=I);if(D=p===0?(R=me=x,19):p===1?(R=s,X-=257,me=n,ye-=257,256):(R=d,me=b,-1),N=o,P=l,ae=I=O=0,k=-1,A=(re=1<<($=J))-1,p===1&&852<re||p===2&&592<re)return 1;for(;;){for(C=N-ae,G=x[I]<D?(F=0,x[I]):x[I]>D?(F=me[ye+x[I]],R[X+x[I]]):(F=96,0),j=1<<N-ae,o=S=1<<$;w[P+(O>>ae)+(S-=j)]=C<<24|F<<16|G|0,S!==0;);for(j=1<<N-1;O&j;)j>>=1;if(j!==0?(O&=j-1,O+=j):O=0,I++,--Y[N]==0){if(N===B)break;N=v[g+x[I]]}if(J<N&&(O&A)!==k){for(ae===0&&(ae=J),P+=o,W=1<<($=N-ae);$+ae<B&&!((W-=Y[$+ae])<=0);)$++,W<<=1;if(re+=1<<$,p===1&&852<re||p===2&&592<re)return 1;w[k=O&A]=J<<24|$<<16|P-l|0}}return O!==0&&(w[P+O]=N-ae<<24|64<<16|0),m.bits=J,0}},{"../utils/common":41}],51:[function(t,u,f){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,u,f){var i=t("../utils/common"),s=0,n=1;function d(y){for(var E=y.length;0<=--E;)y[E]=0}var b=0,p=29,v=256,g=v+1+p,h=30,w=19,l=2*g+1,x=15,m=16,j=7,S=256,k=16,A=17,P=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=new Array(2*(g+2));d(te);var N=new Array(2*h);d(N);var I=new Array(512);d(I);var o=new Array(256);d(o);var B=new Array(p);d(B);var J,$,ae,W=new Array(h);function re(y,E,M,Z,z){this.static_tree=y,this.extra_bits=E,this.extra_base=M,this.elems=Z,this.max_length=z,this.has_stree=y&&y.length}function O(y,E){this.dyn_tree=y,this.max_code=0,this.stat_desc=E}function R(y){return y<256?I[y]:I[256+(y>>>7)]}function X(y,E){y.pending_buf[y.pending++]=255&E,y.pending_buf[y.pending++]=E>>>8&255}function Y(y,E,M){y.bi_valid>m-M?(y.bi_buf|=E<<y.bi_valid&65535,X(y,y.bi_buf),y.bi_buf=E>>m-y.bi_valid,y.bi_valid+=M-m):(y.bi_buf|=E<<y.bi_valid&65535,y.bi_valid+=M)}function H(y,E,M){Y(y,M[2*E],M[2*E+1])}function me(y,E){for(var M=0;M|=1&y,y>>>=1,M<<=1,0<--E;);return M>>>1}function ye(y,E,M){var Z,z,q=new Array(x+1),Q=0;for(Z=1;Z<=x;Z++)q[Z]=Q=Q+M[Z-1]<<1;for(z=0;z<=E;z++){var V=y[2*z+1];V!==0&&(y[2*z]=me(q[V]++,V))}}function oe(y){var E;for(E=0;E<g;E++)y.dyn_ltree[2*E]=0;for(E=0;E<h;E++)y.dyn_dtree[2*E]=0;for(E=0;E<w;E++)y.bl_tree[2*E]=0;y.dyn_ltree[2*S]=1,y.opt_len=y.static_len=0,y.last_lit=y.matches=0}function le(y){8<y.bi_valid?X(y,y.bi_buf):0<y.bi_valid&&(y.pending_buf[y.pending++]=y.bi_buf),y.bi_buf=0,y.bi_valid=0}function ve(y,E,M,Z){var z=2*E,q=2*M;return y[z]<y[q]||y[z]===y[q]&&Z[E]<=Z[M]}function ge(y,E,M){for(var Z=y.heap[M],z=M<<1;z<=y.heap_len&&(z<y.heap_len&&ve(E,y.heap[z+1],y.heap[z],y.depth)&&z++,!ve(E,Z,y.heap[z],y.depth));)y.heap[M]=y.heap[z],M=z,z<<=1;y.heap[M]=Z}function ke(y,E,M){var Z,z,q,Q,V=0;if(y.last_lit!==0)for(;Z=y.pending_buf[y.d_buf+2*V]<<8|y.pending_buf[y.d_buf+2*V+1],z=y.pending_buf[y.l_buf+V],V++,Z===0?H(y,z,E):(H(y,(q=o[z])+v+1,E),(Q=D[q])!==0&&Y(y,z-=B[q],Q),H(y,q=R(--Z),M),(Q=C[q])!==0&&Y(y,Z-=W[q],Q)),V<y.last_lit;);H(y,S,E)}function Ee(y,E){var M,Z,z,q=E.dyn_tree,Q=E.stat_desc.static_tree,V=E.stat_desc.has_stree,se=E.stat_desc.elems,be=-1;for(y.heap_len=0,y.heap_max=l,M=0;M<se;M++)q[2*M]!==0?(y.heap[++y.heap_len]=be=M,y.depth[M]=0):q[2*M+1]=0;for(;y.heap_len<2;)q[2*(z=y.heap[++y.heap_len]=be<2?++be:0)]=1,y.depth[z]=0,y.opt_len--,V&&(y.static_len-=Q[2*z+1]);for(E.max_code=be,M=y.heap_len>>1;1<=M;M--)ge(y,q,M);for(z=se;M=y.heap[1],y.heap[1]=y.heap[y.heap_len--],ge(y,q,1),Z=y.heap[1],y.heap[--y.heap_max]=M,y.heap[--y.heap_max]=Z,q[2*z]=q[2*M]+q[2*Z],y.depth[z]=(y.depth[M]>=y.depth[Z]?y.depth[M]:y.depth[Z])+1,q[2*M+1]=q[2*Z+1]=z,y.heap[1]=z++,ge(y,q,1),2<=y.heap_len;);y.heap[--y.heap_max]=y.heap[1],function(ce,Re){var We,Oe,Ze,we,Ye,Je,Fe=Re.dyn_tree,tt=Re.max_code,nt=Re.stat_desc.static_tree,it=Re.stat_desc.has_stree,ot=Re.stat_desc.extra_bits,rt=Re.stat_desc.extra_base,He=Re.stat_desc.max_length,Ke=0;for(we=0;we<=x;we++)ce.bl_count[we]=0;for(Fe[2*ce.heap[ce.heap_max]+1]=0,We=ce.heap_max+1;We<l;We++)He<(we=Fe[2*Fe[2*(Oe=ce.heap[We])+1]+1]+1)&&(we=He,Ke++),Fe[2*Oe+1]=we,tt<Oe||(ce.bl_count[we]++,Ye=0,rt<=Oe&&(Ye=ot[Oe-rt]),Je=Fe[2*Oe],ce.opt_len+=Je*(we+Ye),it&&(ce.static_len+=Je*(nt[2*Oe+1]+Ye)));if(Ke!==0){do{for(we=He-1;ce.bl_count[we]===0;)we--;ce.bl_count[we]--,ce.bl_count[we+1]+=2,ce.bl_count[He]--,Ke-=2}while(0<Ke);for(we=He;we!==0;we--)for(Oe=ce.bl_count[we];Oe!==0;)tt<(Ze=ce.heap[--We])||(Fe[2*Ze+1]!==we&&(ce.opt_len+=(we-Fe[2*Ze+1])*Fe[2*Ze],Fe[2*Ze+1]=we),Oe--)}}(y,E),ye(q,be,y.bl_count)}function a(y,E,M){var Z,z,q=-1,Q=E[1],V=0,se=7,be=4;for(Q===0&&(se=138,be=3),E[2*(M+1)+1]=65535,Z=0;Z<=M;Z++)z=Q,Q=E[2*(Z+1)+1],++V<se&&z===Q||(V<be?y.bl_tree[2*z]+=V:z!==0?(z!==q&&y.bl_tree[2*z]++,y.bl_tree[2*k]++):V<=10?y.bl_tree[2*A]++:y.bl_tree[2*P]++,q=z,be=(V=0)===Q?(se=138,3):z===Q?(se=6,3):(se=7,4))}function U(y,E,M){var Z,z,q=-1,Q=E[1],V=0,se=7,be=4;for(Q===0&&(se=138,be=3),Z=0;Z<=M;Z++)if(z=Q,Q=E[2*(Z+1)+1],!(++V<se&&z===Q)){if(V<be)for(;H(y,z,y.bl_tree),--V!=0;);else z!==0?(z!==q&&(H(y,z,y.bl_tree),V--),H(y,k,y.bl_tree),Y(y,V-3,2)):V<=10?(H(y,A,y.bl_tree),Y(y,V-3,3)):(H(y,P,y.bl_tree),Y(y,V-11,7));q=z,be=(V=0)===Q?(se=138,3):z===Q?(se=6,3):(se=7,4)}}d(W);var T=!1;function _(y,E,M,Z){Y(y,(b<<1)+(Z?1:0),3),function(z,q,Q,V){le(z),X(z,Q),X(z,~Q),i.arraySet(z.pending_buf,z.window,q,Q,z.pending),z.pending+=Q}(y,E,M)}f._tr_init=function(y){T||(function(){var E,M,Z,z,q,Q=new Array(x+1);for(z=Z=0;z<p-1;z++)for(B[z]=Z,E=0;E<1<<D[z];E++)o[Z++]=z;for(o[Z-1]=z,z=q=0;z<16;z++)for(W[z]=q,E=0;E<1<<C[z];E++)I[q++]=z;for(q>>=7;z<h;z++)for(W[z]=q<<7,E=0;E<1<<C[z]-7;E++)I[256+q++]=z;for(M=0;M<=x;M++)Q[M]=0;for(E=0;E<=143;)te[2*E+1]=8,E++,Q[8]++;for(;E<=255;)te[2*E+1]=9,E++,Q[9]++;for(;E<=279;)te[2*E+1]=7,E++,Q[7]++;for(;E<=287;)te[2*E+1]=8,E++,Q[8]++;for(ye(te,g+1,Q),E=0;E<h;E++)N[2*E+1]=5,N[2*E]=me(E,5);J=new re(te,D,v+1,g,x),$=new re(N,C,0,h,x),ae=new re(new Array(0),F,0,w,j)}(),T=!0),y.l_desc=new O(y.dyn_ltree,J),y.d_desc=new O(y.dyn_dtree,$),y.bl_desc=new O(y.bl_tree,ae),y.bi_buf=0,y.bi_valid=0,oe(y)},f._tr_stored_block=_,f._tr_flush_block=function(y,E,M,Z){var z,q,Q=0;0<y.level?(y.strm.data_type===2&&(y.strm.data_type=function(V){var se,be=4093624447;for(se=0;se<=31;se++,be>>>=1)if(1&be&&V.dyn_ltree[2*se]!==0)return s;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return n;for(se=32;se<v;se++)if(V.dyn_ltree[2*se]!==0)return n;return s}(y)),Ee(y,y.l_desc),Ee(y,y.d_desc),Q=function(V){var se;for(a(V,V.dyn_ltree,V.l_desc.max_code),a(V,V.dyn_dtree,V.d_desc.max_code),Ee(V,V.bl_desc),se=w-1;3<=se&&V.bl_tree[2*G[se]+1]===0;se--);return V.opt_len+=3*(se+1)+5+5+4,se}(y),z=y.opt_len+3+7>>>3,(q=y.static_len+3+7>>>3)<=z&&(z=q)):z=q=M+5,M+4<=z&&E!==-1?_(y,E,M,Z):y.strategy===4||q===z?(Y(y,2+(Z?1:0),3),ke(y,te,N)):(Y(y,4+(Z?1:0),3),function(V,se,be,ce){var Re;for(Y(V,se-257,5),Y(V,be-1,5),Y(V,ce-4,4),Re=0;Re<ce;Re++)Y(V,V.bl_tree[2*G[Re]+1],3);U(V,V.dyn_ltree,se-1),U(V,V.dyn_dtree,be-1)}(y,y.l_desc.max_code+1,y.d_desc.max_code+1,Q+1),ke(y,y.dyn_ltree,y.dyn_dtree)),oe(y),Z&&le(y)},f._tr_tally=function(y,E,M){return y.pending_buf[y.d_buf+2*y.last_lit]=E>>>8&255,y.pending_buf[y.d_buf+2*y.last_lit+1]=255&E,y.pending_buf[y.l_buf+y.last_lit]=255&M,y.last_lit++,E===0?y.dyn_ltree[2*M]++:(y.matches++,E--,y.dyn_ltree[2*(o[M]+v+1)]++,y.dyn_dtree[2*R(E)]++),y.last_lit===y.lit_bufsize-1},f._tr_align=function(y){Y(y,2,3),H(y,S,te),function(E){E.bi_valid===16?(X(E,E.bi_buf),E.bi_buf=0,E.bi_valid=0):8<=E.bi_valid&&(E.pending_buf[E.pending++]=255&E.bi_buf,E.bi_buf>>=8,E.bi_valid-=8)}(y)}},{"../utils/common":41}],53:[function(t,u,f){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,u,f){(function(i){(function(s,n){if(!s.setImmediate){var d,b,p,v,g=1,h={},w=!1,l=s.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(s);x=x&&x.setTimeout?x:s,d={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){j(k)})}:function(){if(s.postMessage&&!s.importScripts){var k=!0,A=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=A,k}}()?(v="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",S,!1):s.attachEvent("onmessage",S),function(k){s.postMessage(v+k,"*")}):s.MessageChannel?((p=new MessageChannel).port1.onmessage=function(k){j(k.data)},function(k){p.port2.postMessage(k)}):l&&"onreadystatechange"in l.createElement("script")?(b=l.documentElement,function(k){var A=l.createElement("script");A.onreadystatechange=function(){j(k),A.onreadystatechange=null,b.removeChild(A),A=null},b.appendChild(A)}):function(k){setTimeout(j,0,k)},x.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var A=new Array(arguments.length-1),P=0;P<A.length;P++)A[P]=arguments[P+1];var D={callback:k,args:A};return h[g]=D,d(g),g++},x.clearImmediate=m}function m(k){delete h[k]}function j(k){if(w)setTimeout(j,0,k);else{var A=h[k];if(A){w=!0;try{(function(P){var D=P.callback,C=P.args;switch(C.length){case 0:D();break;case 1:D(C[0]);break;case 2:D(C[0],C[1]);break;case 3:D(C[0],C[1],C[2]);break;default:D.apply(n,C)}})(A)}finally{m(k),w=!1}}}}function S(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(v)===0&&j(+k.data.slice(v.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(pr);var Ts=pr.exports;const Fs=Er(Ts);var xr={exports:{}};(function(r,c){(function(t,u){u()})($e,function(){function t(b,p){return typeof p>"u"?p={autoBom:!1}:typeof p!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?new Blob(["\uFEFF",b],{type:b.type}):b}function u(b,p,v){var g=new XMLHttpRequest;g.open("GET",b),g.responseType="blob",g.onload=function(){d(g.response,p,v)},g.onerror=function(){console.error("could not download file")},g.send()}function f(b){var p=new XMLHttpRequest;p.open("HEAD",b,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function i(b){try{b.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),b.dispatchEvent(p)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $e=="object"&&$e.global===$e?$e:void 0,n=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(b,p,v){var g=s.URL||s.webkitURL,h=document.createElement("a");p=p||b.name||"download",h.download=p,h.rel="noopener",typeof b=="string"?(h.href=b,h.origin===location.origin?i(h):f(h.href)?u(b,p,v):i(h,h.target="_blank")):(h.href=g.createObjectURL(b),setTimeout(function(){g.revokeObjectURL(h.href)},4e4),setTimeout(function(){i(h)},0))}:"msSaveOrOpenBlob"in navigator?function(b,p,v){if(p=p||b.name||"download",typeof b!="string")navigator.msSaveOrOpenBlob(t(b,v),p);else if(f(b))u(b,p,v);else{var g=document.createElement("a");g.href=b,g.target="_blank",setTimeout(function(){i(g)})}}:function(b,p,v,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),typeof b=="string")return u(b,p,v);var h=b.type==="application/octet-stream",w=/constructor/i.test(s.HTMLElement)||s.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||h&&w||n)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var S=x.result;S=l?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=S:location=S,g=null},x.readAsDataURL(b)}else{var m=s.URL||s.webkitURL,j=m.createObjectURL(b);g?g.location=j:location.href=j,g=null,setTimeout(function(){m.revokeObjectURL(j)},4e4)}});s.saveAs=d.saveAs=d,r.exports=d})})(xr);var Bs=xr.exports;const Ds="http://localhost:5000/api",Ps=({workspaceId:r,infraSpec:c,selectedProvider:t,costEstimation:u,onComplete:f,onBack:i})=>{var F,G,te;const[s,n]=K.useState(!0),[d,b]=K.useState(null),[p,v]=K.useState("main.tf"),[g,h]=K.useState([]),[w,l]=K.useState(null),[x,m]=K.useState(!1);K.useEffect(()=>{(async()=>{var I,o,B,J,$,ae,W,re;try{const O=(I=u.provider_details)==null?void 0:I[t],R=((o=Object.entries(u.scenarios||{}).find(([X,Y])=>{var H;return((H=Y[t])==null?void 0:H.monthly_cost)===(O==null?void 0:O.total_monthly_cost)}))==null?void 0:o[0])||"standard";try{const X=await Be.post(`${Ds}/workflow/terraform`,{workspace_id:r,infraSpec:c,provider:t,profile:R,project_name:c.project_name||"cloudiverse-project",requirements:{}});X.data.success&&(X.data.terraform.structure==="modular"?(b(X.data.terraform.project),console.log("[TERRAFORM] Hash:",((B=X.data.terraform_hash)==null?void 0:B.substring(0,16))+"..."),console.log("[TERRAFORM] Manifest:",X.data.deployment_manifest)):b({"main.tf":X.data.terraform.code}),h(X.data.services||[]))}catch(X){console.warn("Terraform generation failed (non-blocking):",X),console.error("[TERRAFORM ERROR] Full error:",(J=X.response)==null?void 0:J.data);const Y=((ae=($=X.response)==null?void 0:$.data)==null?void 0:ae.message)||X.message||"",H=((re=(W=X.response)==null?void 0:W.data)==null?void 0:re.details)||"";if(console.error("[TERRAFORM ERROR] Message:",Y),console.error("[TERRAFORM ERROR] Details:",H),Y.includes("No template for pattern")||Y.includes("not available")||Y.includes("under construction"))m(!0),console.log("[TERRAFORM UX] Pattern template not available - showing coming soon message");else{const me=`Failed to generate Terraform code: ${Y}${H?`
`+H:""}`;l(me)}throw X}}catch(O){console.error("Terraform generation failed:",O),l("Failed to generate Terraform code. Please try again.")}finally{n(!1)}})()},[r,c,t,u]);const j=()=>{if(!d)return"";const N=p.split("/");let I=d;for(const o of N)if(typeof I=="object"&&I[o])I=I[o];else return"";return typeof I=="string"?I:""},S=(N,I="")=>{let o=[];for(const[B,J]of Object.entries(N)){const $=I?`${I}/${B}`:B;typeof J=="string"?o.push($):typeof J=="object"&&(o=o.concat(S(J,$)))}return o},k=(N,I="")=>{const o=[];for(const[B,J]of Object.entries(N)){const $=I?`${I}/${B}`:B;typeof J=="string"?o.push({path:$,name:B,type:"file",depth:$.split("/").length-1}):typeof J=="object"&&(o.push({path:$,name:B,type:"folder",depth:$.split("/").length-1}),o.push(...k(J,$)))}return o},A=()=>{const N=j();navigator.clipboard.writeText(N),ue.success(`Copied ${p} to clipboard`)},P=async()=>{if(!d)return;const N=new Fs,I=c.project_name||"cloudiverse-project",o=(J,$)=>{for(const[ae,W]of Object.entries(J))if(typeof W=="string")$.file(ae,W);else if(typeof W=="object"){const re=$.folder(ae);o(W,re)}};o(d,N);const B=await N.generateAsync({type:"blob"});Bs.saveAs(B,`${I}-terraform.zip`),ue.success("Downloaded Terraform project as ZIP")};if(s)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generating Infrastructure Code"}),e.jsxs("p",{className:"text-gray-400 mt-2",children:["Creating Terraform configuration for ",t,"..."]})]})]});if(x){const N=(c==null?void 0:c.architecture_pattern)||((F=c==null?void 0:c.service_classes)==null?void 0:F.pattern_name)||"this pattern";return e.jsx("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in pb-20",children:e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6",children:[e.jsx("div",{className:"text-amber-500 text-6xl material-icons",children:"construction"}),e.jsxs("div",{className:"text-center max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Terraform Generation Coming Soon"}),e.jsxs("p",{className:"text-gray-300 text-lg mb-2",children:["Terraform generation for ",e.jsx("span",{className:"text-primary font-semibold",children:N})," is not available yet."]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Your architecture and cost estimates are saved and validated. You can continue with manual infrastructure setup or check back later for automated Terraform generation."})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-6 w-full max-w-2xl",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Your Architecture Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Pattern"}),e.jsx("span",{className:"text-white font-semibold",children:N})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Provider"}),e.jsx("span",{className:"text-white font-semibold",children:t.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Services"}),e.jsx("span",{className:"text-white font-semibold",children:((te=(G=c==null?void 0:c.service_classes)==null?void 0:G.required_services)==null?void 0:te.length)||0})]})]})]}),e.jsxs("button",{onClick:f,className:"mt-6 px-8 py-3 bg-primary hover:bg-primary/90 rounded-xl text-white font-semibold transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"check_circle"}),e.jsx("span",{children:"Continue to Dashboard"})]})]})})}if(w)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsx("div",{className:"text-red-500 text-6xl material-icons",children:"error_outline"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generation Failed"}),e.jsx("p",{className:"text-red-400 mt-2",children:w}),e.jsx("button",{onClick:i,className:"mt-6 px-6 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors",children:"Go Back"})]})]});d&&S(d);const D=d?k(d):[],C=j();return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Your Infrastructure Code"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Modular Terraform project for ",t]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:A,className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"content_copy"}),e.jsx("span",{className:"text-sm",children:"Copy File"})]}),e.jsxs("button",{onClick:P,className:"px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg text-primary hover:bg-primary/20 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"download"}),e.jsx("span",{className:"text-sm",children:"Download ZIP"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-1 bg-surface border border-border rounded-xl p-4 max-h-[600px] overflow-y-auto",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Project Files"}),e.jsx("div",{className:"space-y-1",children:D.map(N=>{const I=N.type==="folder",o=N.path===p,B=N.depth*16;return e.jsxs("button",{onClick:()=>!I&&v(N.path),disabled:I,className:`w-full text-left px-2 py-1.5 rounded text-xs font-mono transition-colors flex items-center space-x-2 ${I?"text-amber-400 font-semibold cursor-default":o?"bg-primary/20 text-primary border border-primary/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,style:{paddingLeft:`${8+B}px`},children:[e.jsx("span",{className:"material-icons text-xs",children:I?"folder":N.name.endsWith(".tf")?"description":N.name.endsWith(".md")?"article":"insert_drive_file"}),e.jsx("span",{className:"truncate",children:N.name})]},N.path)})})]}),e.jsxs("div",{className:"col-span-3 bg-[#1e1e1e] rounded-xl border border-white/10 overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"flex items-center px-4 py-2 bg-white/5 border-b border-white/5",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/50"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/50"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]}),e.jsx("span",{className:"ml-4 text-xs font-mono text-gray-400",children:p})]}),e.jsx("div",{className:"p-4 overflow-x-auto max-h-[550px] overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm text-gray-300 leading-relaxed",children:C||"// Select a file to view"})})]})]}),g.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Included Resources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((N,I)=>e.jsx("div",{className:"px-3 py-1.5 bg-blue-500/10 border border-blue-500/20 rounded text-xs text-blue-300 font-mono",children:N.terraform_resource||N.cloud_service||N.generic_name||N},I))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5 mt-8",children:[e.jsxs("button",{onClick:i,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back"})]}),e.jsxs("button",{onClick:f,className:"px-8 py-4 bg-primary hover:bg-primary/90 border border-primary/20 rounded-xl text-black font-bold transition-all flex items-center space-x-3",children:[e.jsx("span",{className:"material-icons",children:"check_circle"}),e.jsx("span",{children:"Continue to Deployment"})]})]})]})},Us=({workspaceId:r,infraSpec:c,costEstimation:t,onNext:u,onBack:f,onRequirementsCaptured:i})=>{const[s,n]=K.useState({nfr:{availability:"99.5",latency:"medium",compliance:[],data_residency:"",cost_ceiling_usd:null,security_level:"standard"},region:{primary_region:"us-east-1",secondary_region:"",multi_region:!1},data_classes:{},data_retention:{},deployment_strategy:"rolling",downtime_allowed:!0,observability:{logs:!0,metrics:!0,alerts:!1}}),[d,b]=K.useState("region"),p=(l,x)=>{n(m=>({...m,region:{...m.region,[l]:x}}))},v=l=>{n(x=>({...x,deployment_strategy:l}))},g=(l,x)=>{n(m=>({...m,observability:{...m.observability,[l]:x}}))},h=()=>{try{if(!s||Object.keys(s).length===0){console.error("Requirements data is empty");return}i&&i(s),u()}catch(l){console.error("Error in handleSubmit:",l)}},w=[{id:"region",label:"Region",icon:"public"},{id:"data",label:"Data",icon:"database"},{id:"deployment",label:"Deployment",icon:"build"},{id:"observability",label:"Monitoring",icon:"monitoring"}];return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"System Requirements"}),e.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Configure region, data, deployment, and monitoring settings for your infrastructure."})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-white/10 pb-4",children:w.map(l=>e.jsxs("button",{onClick:()=>b(l.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center space-x-2 ${d===l.id?"bg-primary/20 text-white border border-primary/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:l.icon}),e.jsx("span",{children:l.label})]},l.id))}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[d==="region"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Region Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Primary Region"}),e.jsxs("select",{value:s.region.primary_region,onChange:l=>p("primary_region",l.target.value),className:"w-full bg-surface border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"us-east-1",children:"US East (N. Virginia)"}),e.jsx("option",{value:"us-west-2",children:"US West (Oregon)"}),e.jsx("option",{value:"eu-west-1",children:"EU (Ireland)"}),e.jsx("option",{value:"eu-central-1",children:"EU (Frankfurt)"}),e.jsx("option",{value:"ap-southeast-1",children:"Asia Pacific (Singapore)"}),e.jsx("option",{value:"ap-northeast-1",children:"Asia Pacific (Tokyo)"}),e.jsx("option",{value:"ca-central-1",children:"Canada (Central)"}),e.jsx("option",{value:"sa-east-1",children:"South America (So Paulo)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Secondary Region (Optional)"}),e.jsxs("select",{value:s.region.secondary_region,onChange:l=>p("secondary_region",l.target.value),className:"w-full bg-surface border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"us-east-1",children:"US East (N. Virginia)"}),e.jsx("option",{value:"us-west-2",children:"US West (Oregon)"}),e.jsx("option",{value:"eu-west-1",children:"EU (Ireland)"}),e.jsx("option",{value:"eu-central-1",children:"EU (Frankfurt)"}),e.jsx("option",{value:"ap-southeast-1",children:"Asia Pacific (Singapore)"}),e.jsx("option",{value:"ap-northeast-1",children:"Asia Pacific (Tokyo)"}),e.jsx("option",{value:"ca-central-1",children:"Canada (Central)"}),e.jsx("option",{value:"sa-east-1",children:"South America (So Paulo)"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-surface/50 rounded-xl border border-border",children:[e.jsx("input",{type:"checkbox",id:"multi-region",checked:s.region.multi_region,onChange:l=>p("multi_region",l.target.checked),className:"w-5 h-5 text-primary bg-surface border-border rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"multi-region",className:"text-white",children:"Enable multi-region deployment for high availability"})]}),s.nfr.compliance.includes("GDPR")&&e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-amber-200 mb-1",children:"Data Residency Notice"}),e.jsx("p",{className:"text-sm text-amber-200/80",children:"GDPR compliance requires data to be stored within EU regions. Primary region must be EU-based."})]})]})})]}),d==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Data Classification & Retention"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Data Classification"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Classify your data types to apply appropriate security measures"}),e.jsx("div",{className:"space-y-4",children:[{type:"user_profiles",label:"User Profiles",desc:"Names, emails, personal preferences, account details"},{type:"payment_data",label:"Payment Data",desc:"Credit cards, billing info, transaction history"},{type:"documents",label:"Documents",desc:"User-uploaded files, images, videos, PDFs"},{type:"logs",label:"System Logs",desc:"Application logs, access logs, error traces"},{type:"analytics",label:"Analytics",desc:"Usage metrics, user behavior, performance data"},{type:"backup",label:"Backup Data",desc:"Backup copies, snapshots, archived data"}].map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:l.label}),e.jsx("div",{className:"text-sm text-gray-400",children:l.desc})]}),e.jsxs("select",{value:s.data_classes[l.type]||"",onChange:x=>n(m=>({...m,data_classes:{...m.data_classes,[l.type]:x.target.value}})),className:"bg-surface border border-border rounded-lg px-3 py-2 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"Unclassified"}),e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"internal",children:"Internal"}),e.jsx("option",{value:"confidential",children:"Confidential"}),e.jsx("option",{value:"restricted",children:"Restricted"})]})]},l.type))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Data Retention"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Define how long different data types should be retained"}),e.jsx("div",{className:"space-y-4",children:[{type:"user_profiles",label:"User Profiles"},{type:"payment_data",label:"Payment Data"},{type:"logs",label:"System Logs"},{type:"analytics",label:"Analytics Data"}].map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsx("div",{children:e.jsx("div",{className:"font-medium text-white",children:l.label})}),e.jsx("input",{type:"text",placeholder:"e.g., 7 years, 90 days",value:s.data_retention[l.type]||"",onChange:x=>n(m=>({...m,data_retention:{...m.data_retention,[l.type]:x.target.value}})),className:"bg-surface border border-border rounded-lg px-3 py-2 text-white focus:outline-none focus:border-primary w-40"})]},l.type))})]})]})]}),d==="deployment"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Deployment Strategy"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Deployment Strategy"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[{value:"rolling",label:"Rolling",desc:"Instances updated gradually, minimal risk"},{value:"blue-green",label:"Blue/Green",desc:"Zero downtime with instant rollback capability"},{value:"canary",label:"Canary",desc:"Test with small traffic before full rollout"},{value:"batch",label:"Batch",desc:"All instances updated at once, fastest but risky"}].map(l=>e.jsxs("div",{onClick:()=>v(l.value),className:`p-4 rounded-xl border cursor-pointer transition-all ${s.deployment_strategy===l.value?"border-primary bg-primary/10 text-white":"border-white/10 text-gray-400 hover:border-white/20 hover:bg-white/5"}`,children:[e.jsx("div",{className:"font-medium",children:l.label}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:l.desc})]},l.value))})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-surface/50 rounded-xl border border-border",children:[e.jsx("input",{type:"checkbox",id:"downtime-allowed",checked:s.downtime_allowed,onChange:l=>n(x=>({...x,downtime_allowed:l.target.checked})),className:"w-5 h-5 text-primary bg-surface border-border rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"downtime-allowed",className:"text-white",children:"Downtime is allowed during deployment"})]}),e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-blue-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Strategy Recommendations"}),e.jsxs("p",{className:"text-sm text-blue-200/80",children:[" High availability systems: Blue/Green or Canary",e.jsx("br",{})," Development systems: Rolling",e.jsx("br",{})," Batch: Only for non-critical systems"]})]})]})})]})]}),d==="observability"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Observability & Monitoring"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Application Logging"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Capture application and system logs"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.logs,onChange:l=>g("logs",l.target.checked),className:"sr-only",id:"logs-toggle"}),e.jsx("label",{htmlFor:"logs-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.logs?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.logs?"transform translate-x-6":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Infrastructure Metrics"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Monitor CPU, memory, disk, and network"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.metrics,onChange:l=>g("metrics",l.target.checked),className:"sr-only",id:"metrics-toggle"}),e.jsx("label",{htmlFor:"metrics-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.metrics?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.metrics?"transform translate-x-6":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Alerting System"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Get notified of issues and anomalies"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.alerts,onChange:l=>g("alerts",l.target.checked),className:"sr-only",id:"alerts-toggle"}),e.jsx("label",{htmlFor:"alerts-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.alerts?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.alerts?"transform translate-x-6":""}`})})]})]})]}),e.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-green-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-green-200 mb-1",children:"Observability Benefits"}),e.jsx("p",{className:"text-sm text-green-200/80",children:"Monitoring and logging are essential for production systems. They help identify issues before they impact users."})]})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back"})]}),e.jsxs("button",{onClick:h,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Continue to Architecture"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]})},gr=({id:r,x:c,y:t,width:u,height:f,style:i,color:s,strokeColor:n,strokeWidth:d,className:b,borderRadius:p,shapeRendering:v,onClick:g,selected:h})=>{const{background:w,backgroundColor:l}=i||{},x=s||w||l;return Le.createElement("rect",{className:ir(["react-flow__minimap-node",{selected:h},b]),x:c,y:t,rx:p,ry:p,width:u,height:f,fill:x,stroke:n,strokeWidth:d,shapeRendering:v,onClick:g?m=>g(m,r):void 0})};gr.displayName="MiniMapNode";var $s=K.memo(gr);const Ls=r=>r.nodeOrigin,Ms=r=>r.getNodes().filter(c=>!c.hidden&&c.width&&c.height),yt=r=>r instanceof Function?r:()=>r;function Ws({nodeStrokeColor:r="transparent",nodeColor:c="#e2e2e2",nodeClassName:t="",nodeBorderRadius:u=5,nodeStrokeWidth:f=2,nodeComponent:i=$s,onClick:s}){const n=wt(Ms,or),d=wt(Ls),b=yt(c),p=yt(r),v=yt(t),g=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Le.createElement(Le.Fragment,null,n.map(h=>{const{x:w,y:l}=Dr(h,d).positionAbsolute;return Le.createElement(i,{key:h.id,x:w,y:l,width:h.width,height:h.height,style:h.style,selected:h.selected,className:v(h),color:b(h),borderRadius:u,strokeColor:p(h),strokeWidth:f,shapeRendering:g,onClick:s,id:h.id})}))}var Zs=K.memo(Ws);const Hs=200,Gs=150,qs=r=>{const c=r.getNodes(),t={x:-r.transform[0]/r.transform[2],y:-r.transform[1]/r.transform[2],width:r.width/r.transform[2],height:r.height/r.transform[2]};return{viewBB:t,boundingRect:c.length>0?Pr(Ur(c,r.nodeOrigin),t):t,rfId:r.rfId}},Vs="react-flow__minimap-desc";function br({style:r,className:c,nodeStrokeColor:t="transparent",nodeColor:u="#e2e2e2",nodeClassName:f="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:n,maskColor:d="rgb(240, 240, 240, 0.6)",maskStrokeColor:b="none",maskStrokeWidth:p=1,position:v="bottom-right",onClick:g,onNodeClick:h,pannable:w=!1,zoomable:l=!1,ariaLabel:x="React Flow mini map",inversePan:m=!1,zoomStep:j=10,offsetScale:S=5}){const k=zr(),A=K.useRef(null),{boundingRect:P,viewBB:D,rfId:C}=wt(qs,or),F=(r==null?void 0:r.width)??Hs,G=(r==null?void 0:r.height)??Gs,te=P.width/F,N=P.height/G,I=Math.max(te,N),o=I*F,B=I*G,J=S*I,$=P.x-(o-P.width)/2-J,ae=P.y-(B-P.height)/2-J,W=o+J*2,re=B+J*2,O=`${Vs}-${C}`,R=K.useRef(0);R.current=I,K.useEffect(()=>{if(A.current){const H=Ir(A.current),me=le=>{const{transform:ve,d3Selection:ge,d3Zoom:ke}=k.getState();if(le.sourceEvent.type!=="wheel"||!ge||!ke)return;const Ee=-le.sourceEvent.deltaY*(le.sourceEvent.deltaMode===1?.05:le.sourceEvent.deltaMode?1:.002)*j,a=ve[2]*Math.pow(2,Ee);ke.scaleTo(ge,a)},ye=le=>{const{transform:ve,d3Selection:ge,d3Zoom:ke,translateExtent:Ee,width:a,height:U}=k.getState();if(le.sourceEvent.type!=="mousemove"||!ge||!ke)return;const T=R.current*Math.max(1,ve[2])*(m?-1:1),_={x:ve[0]-le.sourceEvent.movementX*T,y:ve[1]-le.sourceEvent.movementY*T},y=[[0,0],[a,U]],E=Fr.translate(_.x,_.y).scale(ve[2]),M=ke.constrain()(E,y,Ee);ke.transform(ge,M)},oe=Or().on("zoom",w?ye:null).on("zoom.wheel",l?me:null);return H.call(oe),()=>{H.on("zoom",null)}}},[w,l,m,j]);const X=g?H=>{const me=Br(H);g(H,{x:me[0],y:me[1]})}:void 0,Y=h?(H,me)=>{const ye=k.getState().nodeInternals.get(me);h(H,ye)}:void 0;return Le.createElement(Tr,{position:v,style:r,className:ir(["react-flow__minimap",c]),"data-testid":"rf__minimap"},Le.createElement("svg",{width:F,height:G,viewBox:`${$} ${ae} ${W} ${re}`,role:"img","aria-labelledby":O,ref:A,onClick:X},x&&Le.createElement("title",{id:O},x),Le.createElement(Zs,{onClick:Y,nodeColor:u,nodeStrokeColor:t,nodeBorderRadius:i,nodeClassName:f,nodeStrokeWidth:s,nodeComponent:n}),Le.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-J},${ae-J}h${W+J*2}v${re+J*2}h${-W-J*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fill:d,fillRule:"evenodd",stroke:b,strokeWidth:p,pointerEvents:"none"})))}br.displayName="MiniMap";var Ys=K.memo(br);function Ks(r,c){if(r.match(/^[a-z]+:\/\//i))return r;if(r.match(/^\/\//))return window.location.protocol+r;if(r.match(/^[a-z]+:/i))return r;const t=document.implementation.createHTMLDocument(),u=t.createElement("base"),f=t.createElement("a");return t.head.appendChild(u),t.body.appendChild(f),c&&(u.href=c),f.href=r,f.href}const Xs=(()=>{let r=0;const c=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(r+=1,`u${c()}${r}`)})();function qe(r){const c=[];for(let t=0,u=r.length;t<u;t++)c.push(r[t]);return c}let Qe=null;function yr(r={}){return Qe||(r.includeStyleProperties?(Qe=r.includeStyleProperties,Qe):(Qe=qe(window.getComputedStyle(document.documentElement)),Qe))}function ht(r,c){const u=(r.ownerDocument.defaultView||window).getComputedStyle(r).getPropertyValue(c);return u?parseFloat(u.replace("px","")):0}function Js(r){const c=ht(r,"border-left-width"),t=ht(r,"border-right-width");return r.clientWidth+c+t}function Qs(r){const c=ht(r,"border-top-width"),t=ht(r,"border-bottom-width");return r.clientHeight+c+t}function vr(r,c={}){const t=c.width||Js(r),u=c.height||Qs(r);return{width:t,height:u}}function ea(){let r,c;try{c=process}catch{}const t=c&&c.env?c.env.devicePixelRatio:null;return t&&(r=parseInt(t,10),Number.isNaN(r)&&(r=1)),r||window.devicePixelRatio||1}const Te=16384;function ta(r){(r.width>Te||r.height>Te)&&(r.width>Te&&r.height>Te?r.width>r.height?(r.height*=Te/r.width,r.width=Te):(r.width*=Te/r.height,r.height=Te):r.width>Te?(r.height*=Te/r.width,r.width=Te):(r.width*=Te/r.height,r.height=Te))}function ft(r){return new Promise((c,t)=>{const u=new Image;u.onload=()=>{u.decode().then(()=>{requestAnimationFrame(()=>c(u))})},u.onerror=t,u.crossOrigin="anonymous",u.decoding="async",u.src=r})}async function ra(r){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(r)).then(encodeURIComponent).then(c=>`data:image/svg+xml;charset=utf-8,${c}`)}async function sa(r,c,t){const u="http://www.w3.org/2000/svg",f=document.createElementNS(u,"svg"),i=document.createElementNS(u,"foreignObject");return f.setAttribute("width",`${c}`),f.setAttribute("height",`${t}`),f.setAttribute("viewBox",`0 0 ${c} ${t}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),f.appendChild(i),i.appendChild(r),ra(f)}const Ie=(r,c)=>{if(r instanceof c)return!0;const t=Object.getPrototypeOf(r);return t===null?!1:t.constructor.name===c.name||Ie(t,c)};function aa(r){const c=r.getPropertyValue("content");return`${r.cssText} content: '${c.replace(/'|"/g,"")}';`}function na(r,c){return yr(c).map(t=>{const u=r.getPropertyValue(t),f=r.getPropertyPriority(t);return`${t}: ${u}${f?" !important":""};`}).join(" ")}function ia(r,c,t,u){const f=`.${r}:${c}`,i=t.cssText?aa(t):na(t,u);return document.createTextNode(`${f}{${i}}`)}function Qt(r,c,t,u){const f=window.getComputedStyle(r,t),i=f.getPropertyValue("content");if(i===""||i==="none")return;const s=Xs();try{c.className=`${c.className} ${s}`}catch{return}const n=document.createElement("style");n.appendChild(ia(s,t,f,u)),c.appendChild(n)}function oa(r,c,t){Qt(r,c,":before",t),Qt(r,c,":after",t)}const er="application/font-woff",tr="image/jpeg",la={woff:er,woff2:er,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:tr,jpeg:tr,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ca(r){const c=/\.([^./]*?)$/g.exec(r);return c?c[1]:""}function Ct(r){const c=ca(r).toLowerCase();return la[c]||""}function da(r){return r.split(/,/)[1]}function Nt(r){return r.search(/^(data:)/)!==-1}function ua(r,c){return`data:${c};base64,${r}`}async function wr(r,c,t){const u=await fetch(r,c);if(u.status===404)throw new Error(`Resource "${u.url}" not found`);const f=await u.blob();return new Promise((i,s)=>{const n=new FileReader;n.onerror=s,n.onloadend=()=>{try{i(t({res:u,result:n.result}))}catch(d){s(d)}},n.readAsDataURL(f)})}const vt={};function ha(r,c,t){let u=r.replace(/\?.*/,"");return t&&(u=r),/ttf|otf|eot|woff2?/i.test(u)&&(u=u.replace(/.*\//,"")),c?`[${c}]${u}`:u}async function Et(r,c,t){const u=ha(r,c,t.includeQueryParams);if(vt[u]!=null)return vt[u];t.cacheBust&&(r+=(/\?/.test(r)?"&":"?")+new Date().getTime());let f;try{const i=await wr(r,t.fetchRequestInit,({res:s,result:n})=>(c||(c=s.headers.get("Content-Type")||""),da(n)));f=ua(i,c)}catch(i){f=t.imagePlaceholder||"";let s=`Failed to fetch resource: ${r}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return vt[u]=f,f}async function fa(r){const c=r.toDataURL();return c==="data:,"?r.cloneNode(!1):ft(c)}async function ma(r,c){if(r.currentSrc){const i=document.createElement("canvas"),s=i.getContext("2d");i.width=r.clientWidth,i.height=r.clientHeight,s==null||s.drawImage(r,0,0,i.width,i.height);const n=i.toDataURL();return ft(n)}const t=r.poster,u=Ct(t),f=await Et(t,u,c);return ft(f)}async function pa(r,c){var t;try{if(!((t=r==null?void 0:r.contentDocument)===null||t===void 0)&&t.body)return await xt(r.contentDocument.body,c,!0)}catch{}return r.cloneNode(!1)}async function xa(r,c){return Ie(r,HTMLCanvasElement)?fa(r):Ie(r,HTMLVideoElement)?ma(r,c):Ie(r,HTMLIFrameElement)?pa(r,c):r.cloneNode(_r(r))}const ga=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SLOT",_r=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SVG";async function ba(r,c,t){var u,f;if(_r(c))return c;let i=[];return ga(r)&&r.assignedNodes?i=qe(r.assignedNodes()):Ie(r,HTMLIFrameElement)&&(!((u=r.contentDocument)===null||u===void 0)&&u.body)?i=qe(r.contentDocument.body.childNodes):i=qe(((f=r.shadowRoot)!==null&&f!==void 0?f:r).childNodes),i.length===0||Ie(r,HTMLVideoElement)||await i.reduce((s,n)=>s.then(()=>xt(n,t)).then(d=>{d&&c.appendChild(d)}),Promise.resolve()),c}function ya(r,c,t){const u=c.style;if(!u)return;const f=window.getComputedStyle(r);f.cssText?(u.cssText=f.cssText,u.transformOrigin=f.transformOrigin):yr(t).forEach(i=>{let s=f.getPropertyValue(i);i==="font-size"&&s.endsWith("px")&&(s=`${Math.floor(parseFloat(s.substring(0,s.length-2)))-.1}px`),Ie(r,HTMLIFrameElement)&&i==="display"&&s==="inline"&&(s="block"),i==="d"&&c.getAttribute("d")&&(s=`path(${c.getAttribute("d")})`),u.setProperty(i,s,f.getPropertyPriority(i))})}function va(r,c){Ie(r,HTMLTextAreaElement)&&(c.innerHTML=r.value),Ie(r,HTMLInputElement)&&c.setAttribute("value",r.value)}function wa(r,c){if(Ie(r,HTMLSelectElement)){const t=c,u=Array.from(t.children).find(f=>r.value===f.getAttribute("value"));u&&u.setAttribute("selected","")}}function _a(r,c,t){return Ie(c,Element)&&(ya(r,c,t),oa(r,c,t),va(r,c),wa(r,c)),c}async function ja(r,c){const t=r.querySelectorAll?r.querySelectorAll("use"):[];if(t.length===0)return r;const u={};for(let i=0;i<t.length;i++){const n=t[i].getAttribute("xlink:href");if(n){const d=r.querySelector(n),b=document.querySelector(n);!d&&b&&!u[n]&&(u[n]=await xt(b,c,!0))}}const f=Object.values(u);if(f.length){const i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";const n=document.createElementNS(i,"defs");s.appendChild(n);for(let d=0;d<f.length;d++)n.appendChild(f[d]);r.appendChild(s)}return r}async function xt(r,c,t){return!t&&c.filter&&!c.filter(r)?null:Promise.resolve(r).then(u=>xa(u,c)).then(u=>ba(r,u,c)).then(u=>_a(r,u,c)).then(u=>ja(u,c))}const jr=/url\((['"]?)([^'"]+?)\1\)/g,Na=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ka=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Sa(r){const c=r.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${c})(['"]?\\))`,"g")}function Ca(r){const c=[];return r.replace(jr,(t,u,f)=>(c.push(f),t)),c.filter(t=>!Nt(t))}async function Ea(r,c,t,u,f){try{const i=t?Ks(c,t):c,s=Ct(c);let n;return f||(n=await Et(i,s,u)),r.replace(Sa(c),`$1${n}$3`)}catch{}return r}function Aa(r,{preferredFontFormat:c}){return c?r.replace(ka,t=>{for(;;){const[u,,f]=Na.exec(t)||[];if(!f)return"";if(f===c)return`src: ${u};`}}):r}function Nr(r){return r.search(jr)!==-1}async function kr(r,c,t){if(!Nr(r))return r;const u=Aa(r,t);return Ca(u).reduce((i,s)=>i.then(n=>Ea(n,s,c,t)),Promise.resolve(u))}async function et(r,c,t){var u;const f=(u=c.style)===null||u===void 0?void 0:u.getPropertyValue(r);if(f){const i=await kr(f,null,t);return c.style.setProperty(r,i,c.style.getPropertyPriority(r)),!0}return!1}async function Ra(r,c){await et("background",r,c)||await et("background-image",r,c),await et("mask",r,c)||await et("-webkit-mask",r,c)||await et("mask-image",r,c)||await et("-webkit-mask-image",r,c)}async function za(r,c){const t=Ie(r,HTMLImageElement);if(!(t&&!Nt(r.src))&&!(Ie(r,SVGImageElement)&&!Nt(r.href.baseVal)))return;const u=t?r.src:r.href.baseVal,f=await Et(u,Ct(u),c);await new Promise((i,s)=>{r.onload=i,r.onerror=c.onImageErrorHandler?(...d)=>{try{i(c.onImageErrorHandler(...d))}catch(b){s(b)}}:s;const n=r;n.decode&&(n.decode=i),n.loading==="lazy"&&(n.loading="eager"),t?(r.srcset="",r.src=f):r.href.baseVal=f})}async function Ia(r,c){const u=qe(r.childNodes).map(f=>Sr(f,c));await Promise.all(u).then(()=>r)}async function Sr(r,c){Ie(r,Element)&&(await Ra(r,c),await za(r,c),await Ia(r,c))}function Oa(r,c){const{style:t}=r;c.backgroundColor&&(t.backgroundColor=c.backgroundColor),c.width&&(t.width=`${c.width}px`),c.height&&(t.height=`${c.height}px`);const u=c.style;return u!=null&&Object.keys(u).forEach(f=>{t[f]=u[f]}),r}const rr={};async function sr(r){let c=rr[r];if(c!=null)return c;const u=await(await fetch(r)).text();return c={url:r,cssText:u},rr[r]=c,c}async function ar(r,c){let t=r.cssText;const u=/url\(["']?([^"')]+)["']?\)/g,i=(t.match(/url\([^)]+\)/g)||[]).map(async s=>{let n=s.replace(u,"$1");return n.startsWith("https://")||(n=new URL(n,r.url).href),wr(n,c.fetchRequestInit,({result:d})=>(t=t.replace(s,`url(${d})`),[s,d]))});return Promise.all(i).then(()=>t)}function nr(r){if(r==null)return[];const c=[],t=/(\/\*[\s\S]*?\*\/)/gi;let u=r.replace(t,"");const f=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=f.exec(u);if(d===null)break;c.push(d[0])}u=u.replace(f,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",n=new RegExp(s,"gi");for(;;){let d=i.exec(u);if(d===null){if(d=n.exec(u),d===null)break;i.lastIndex=n.lastIndex}else n.lastIndex=i.lastIndex;c.push(d[0])}return c}async function Ta(r,c){const t=[],u=[];return r.forEach(f=>{if("cssRules"in f)try{qe(f.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let n=s+1;const d=i.href,b=sr(d).then(p=>ar(p,c)).then(p=>nr(p).forEach(v=>{try{f.insertRule(v,v.startsWith("@import")?n+=1:f.cssRules.length)}catch(g){console.error("Error inserting rule from remote css",{rule:v,error:g})}})).catch(p=>{console.error("Error loading remote css",p.toString())});u.push(b)}})}catch(i){const s=r.find(n=>n.href==null)||document.styleSheets[0];f.href!=null&&u.push(sr(f.href).then(n=>ar(n,c)).then(n=>nr(n).forEach(d=>{s.insertRule(d,s.cssRules.length)})).catch(n=>{console.error("Error loading remote stylesheet",n)})),console.error("Error inlining remote css file",i)}}),Promise.all(u).then(()=>(r.forEach(f=>{if("cssRules"in f)try{qe(f.cssRules||[]).forEach(i=>{t.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${f.href}`,i)}}),t))}function Fa(r){return r.filter(c=>c.type===CSSRule.FONT_FACE_RULE).filter(c=>Nr(c.style.getPropertyValue("src")))}async function Ba(r,c){if(r.ownerDocument==null)throw new Error("Provided element is not within a Document");const t=qe(r.ownerDocument.styleSheets),u=await Ta(t,c);return Fa(u)}function Cr(r){return r.trim().replace(/["']/g,"")}function Da(r){const c=new Set;function t(u){(u.style.fontFamily||getComputedStyle(u).fontFamily).split(",").forEach(i=>{c.add(Cr(i))}),Array.from(u.children).forEach(i=>{i instanceof HTMLElement&&t(i)})}return t(r),c}async function Pa(r,c){const t=await Ba(r,c),u=Da(r);return(await Promise.all(t.filter(i=>u.has(Cr(i.style.fontFamily))).map(i=>{const s=i.parentStyleSheet?i.parentStyleSheet.href:null;return kr(i.cssText,s,c)}))).join(`
`)}async function Ua(r,c){const t=c.fontEmbedCSS!=null?c.fontEmbedCSS:c.skipFonts?null:await Pa(r,c);if(t){const u=document.createElement("style"),f=document.createTextNode(t);u.appendChild(f),r.firstChild?r.insertBefore(u,r.firstChild):r.appendChild(u)}}async function $a(r,c={}){const{width:t,height:u}=vr(r,c),f=await xt(r,c,!0);return await Ua(f,c),await Sr(f,c),Oa(f,c),await sa(f,t,u)}async function La(r,c={}){const{width:t,height:u}=vr(r,c),f=await $a(r,c),i=await ft(f),s=document.createElement("canvas"),n=s.getContext("2d"),d=c.pixelRatio||ea(),b=c.canvasWidth||t,p=c.canvasHeight||u;return s.width=b*d,s.height=p*d,c.skipAutoScale||ta(s),s.style.width=`${b}`,s.style.height=`${p}`,c.backgroundColor&&(n.fillStyle=c.backgroundColor,n.fillRect(0,0,s.width,s.height)),n.drawImage(i,0,0,s.width,s.height),s}async function Ma(r,c={}){return(await La(r,c)).toDataURL()}const kt={client:{bg:"#4B5563",border:"#9CA3AF",text:"#F9FAFB"},network:{bg:"#1E40AF",border:"#3B82F6",text:"#DBEAFE"},compute:{bg:"#7C3AED",border:"#A78BFA",text:"#EDE9FE"},database:{bg:"#059669",border:"#10B981",text:"#D1FAE5"},storage:{bg:"#DC2626",border:"#EF4444",text:"#FEE2E2"},security:{bg:"#EA580C",border:"#F97316",text:"#FFEDD5"},messaging:{bg:"#DB2777",border:"#EC4899",text:"#FCE7F3"},observability:{bg:"#0891B2",border:"#06B6D4",text:"#CFFAFE"},integration:{bg:"#65A30D",border:"#84CC16",text:"#ECFCCB"},other:{bg:"#6B7280",border:"#9CA3AF",text:"#F3F4F6"}},Wa={client:"",cdn:"",load_balancer:"",api_gateway:"",websocket_gateway:"",app_compute:"",serverless_compute:"",compute_container:"",compute_vm:"",batch_compute:"",ml_inference_service:"",relational_database:"",nosql_database:"",analytical_database:"",cache:"",object_storage:"",block_storage:"",identity_auth:"",message_queue:"",messaging_queue:"",event_bus:"",logging:"",monitoring:"",payment_gateway:"",push_notification_service:"",secrets_management:"",networking:""};function Za(r,c,t="LR"){const u=new Xt.graphlib.Graph;return u.setDefaultEdgeLabel(()=>({})),u.setGraph({rankdir:t,nodesep:100,ranksep:150,marginx:50,marginy:50}),r.forEach(i=>{u.setNode(i.id,{width:200,height:80})}),c.forEach(i=>{u.setEdge(i.source,i.target)}),Xt.layout(u),{nodes:r.map(i=>{const s=u.node(i.id);return{...i,position:{x:s.x-100,y:s.y-40}}}),edges:c}}function Ha(r){if(!(r!=null&&r.architecture))return{nodes:[],edges:[]};const{nodes:c=[],edges:t=[]}=r.architecture,u=c.map(i=>{const s=i.category||"other",n=kt[s]||kt.other,d=Wa[i.type]||"";return{id:i.id,type:"default",data:{label:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-1 p-3",children:[e.jsx("div",{className:"text-2xl",children:d}),e.jsx("div",{className:"text-xs font-bold text-center leading-tight",style:{color:n.text},children:i.label}),i.role&&e.jsx("div",{className:"text-[9px] opacity-70 italic",style:{color:n.text},children:i.role.replace(/_/g," ")})]})},position:{x:0,y:0},style:{background:n.bg,border:`2px solid ${n.border}`,borderRadius:"12px",padding:"8px",width:200,height:80,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 12px ${n.border}40`},draggable:!1}}),f=t.map((i,s)=>({id:`edge-${s}`,source:i.from,target:i.to,label:i.label||"",type:"smoothstep",animated:!0,style:{stroke:"#6B7280",strokeWidth:2},labelStyle:{fill:"#9CA3AF",fontSize:11,fontWeight:600},labelBgStyle:{fill:"#1F2937",fillOpacity:.8}}));return{nodes:u,edges:f}}const Ga=({architectureData:r,provider:c,pattern:t})=>{const{nodes:u,edges:f}=K.useMemo(()=>Ha(r),[r]),{nodes:i,edges:s}=K.useMemo(()=>Za(u,f),[u,f]),[n,d,b]=$r(i),[p,v,g]=Lr(s),h=K.useCallback(()=>{const w=document.querySelector(".react-flow");if(!w){console.error("Diagram element not found");return}Ma(w,{backgroundColor:"#0F172A",width:w.offsetWidth,height:w.offsetHeight,style:{width:`${w.offsetWidth}px`,height:`${w.offsetHeight}px`}}).then(l=>{const x=document.createElement("a");x.download=`architecture-${c}-${t}-${Date.now()}.png`,x.href=l,x.click()}).catch(l=>{console.error("Failed to export diagram:",l),alert("Failed to export diagram. Please try again.")})},[c,t]);return n.length===0?e.jsx("div",{className:"bg-black/20 rounded-xl p-12 min-h-[500px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("span",{className:"material-icons text-gray-500 text-6xl",children:"cloud_off"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No architecture data available"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:h,className:"px-4 py-2 bg-primary/20 border border-primary/40 text-primary rounded-lg hover:bg-primary/30 transition-colors flex items-center space-x-2 text-sm font-semibold",children:[e.jsx("span",{className:"material-icons text-lg",children:"download"}),e.jsx("span",{children:"Download PNG"})]})}),e.jsx("div",{className:"bg-[#0F172A] rounded-xl border border-white/10 overflow-hidden",style:{height:"600px"},children:e.jsxs(Mr,{nodes:n,edges:p,onNodesChange:b,onEdgesChange:g,fitView:!0,fitViewOptions:{padding:.2},minZoom:.5,maxZoom:2,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnDrag:!0,zoomOnScroll:!0,preventScrolling:!0,children:[e.jsx(Wr,{color:"#1E293B",gap:20,size:1}),e.jsx(Zr,{showInteractive:!1,style:{background:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(Ys,{nodeColor:w=>(w.style||{}).background||"#6B7280",maskColor:"#0F172A99",style:{background:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}})]})}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Service Categories"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(kt).map(([w,l])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{background:l.bg,border:`2px solid ${l.border}`}}),e.jsx("span",{className:"text-xs text-gray-300 capitalize",children:w})]},w))})]})]})},qa="http://localhost:5000/api",Va=({workspaceId:r,infraSpec:c,costEstimation:t,selectedProvider:u,selectedProfile:f,usageProfile:i,requirementsData:s,architectureData:n,onArchitectureDataLoaded:d,onNext:b,onBack:p})=>{var l;const[v,g]=K.useState(!0),[h,w]=K.useState(null);return K.useEffect(()=>{(async()=>{if(!(!c||!u||!f))try{const m=localStorage.getItem("token"),j=m?{Authorization:`Bearer ${m}`}:{},S=await Be.post(`${qa}/workflow/architecture`,{workspace_id:r,infraSpec:c,provider:u,profile:f,usage_profile:(i==null?void 0:i.usage_profile)||{},intent:(c==null?void 0:c.locked_intent)||{},requirements:s||{}},{headers:j});if(!S.data||!S.data.data)throw new Error("Invalid response structure from architecture endpoint");d&&d(S.data.data),w(null)}catch(m){console.error("Architecture loading error:",m),w("Failed to load architecture diagram. Using fallback view."),ue.error("Failed to load architecture diagram")}finally{g(!1)}})()},[r,c,u,f,i,s,d]),h?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design"}),e.jsx("p",{className:"text-gray-400",children:"Architecture diagram could not be loaded, but you can continue to Terraform generation."})]}),e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"warning"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-200 mb-1",children:"Architecture Not Available"}),e.jsx("p",{className:"text-sm text-amber-200/80",children:"The architecture diagram could not be generated, but your infrastructure specification is ready for Terraform generation."})]})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:p,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Cost"})]}),e.jsxs("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Continue to Feedback"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]}):v&&!n?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design Confirmation"}),e.jsx("p",{className:"text-gray-400",children:"Generating your cloud architecture diagram..."})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generating Architecture"}),e.jsx("p",{className:"text-gray-400",children:"Creating your provider-specific diagram..."})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design Confirmation"}),e.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"This architecture reflects the recommended setup based on your requirements and usage."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Provider"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold
                            ${u==="AWS"?"bg-[#FF9900]/20 text-[#FF9900]":u==="GCP"?"bg-[#4285F4]/20 text-[#4285F4]":"bg-[#0078D4]/20 text-[#0078D4]"}`,children:u==="AWS"?"AWS":u==="GCP"?"GCP":"AZ"}),e.jsx("div",{children:e.jsx("div",{className:"font-bold text-white text-lg",children:u==="AZURE"?"Azure":u})})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Scenario"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/20 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-primary",children:"tune"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white text-lg capitalize",children:f==null?void 0:f.replace("_"," ")}),e.jsx("div",{className:"text-xs text-gray-400",children:"Cost optimization profile"})]})]})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"design_services"}),"Architecture Diagram"]}),e.jsx(Ga,{architectureData:n,provider:u,pattern:(c==null?void 0:c.architecture_pattern)||"SERVERLESS_WEB_APP"}),e.jsx("div",{className:"text-xs text-gray-500 mt-4 text-center italic",children:'Interactive architecture diagram. Use mouse wheel to zoom, drag to pan. Click "Download PNG" to export.'})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"inventory"}),"Services Used (",u==="AZURE"?"Azure":u,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(l=n==null?void 0:n.services)==null?void 0:l.map((x,m)=>{var j;return e.jsx("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:x.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:x.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 capitalize",children:[x.category," service"]})]}),e.jsx("div",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full capitalize",children:(j=x.type)==null?void 0:j.replace("_"," ")})]})},m)})})]}),(n==null?void 0:n.notes)&&e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"sticky_note_2"}),"Architecture Notes"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.notes.map((x,m)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-primary text-sm mt-0.5",children:"info"}),e.jsx("p",{className:"text-sm text-gray-300",children:x})]},m))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:p,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Cost"})]}),e.jsxs("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Confirm Architecture"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]})},Xe="http://localhost:5000",en=()=>{var T,_,y,E,M,Z,z,q,Q,V,se,be,ce,Re,We,Oe,Ze,we,Ye,Je,Fe,tt,nt,it,ot,rt,He,Ke,At,Rt,zt,It,Ot,Tt,Ft,Bt,Dt,Pt,Ut,$t,Lt,Mt,Wt,Zt,Ht,Gt,qt,Vt,Yt,Kt;const{id:r}=Ar(),c=Rr(),[t,u]=K.useState("input"),[f,i]=K.useState(""),[s,n]=K.useState([]),[d,b]=K.useState(null),[p,v]=K.useState(null),[g,h]=K.useState(null),[w,l]=K.useState(!1),[x,m]=K.useState(null),[j,S]=K.useState(!1),[k,A]=K.useState(null),[P,D]=K.useState(null),[C,F]=K.useState(null),[G,te]=K.useState("cost_effective"),[N,I]=K.useState(r==="new"?null:r),[o,B]=K.useState(null),[J,$]=K.useState(null),[ae,W]=K.useState(!1),[re,O]=K.useState(null),[R,X]=K.useState(!1),[Y,H]=K.useState(!1),[me,ye]=K.useState(!1),[oe,le]=K.useState("");K.useEffect(()=>{C&&oe&&f!==oe?H(!0):C&&oe&&f===oe&&H(!1)},[f,oe,C]);const ve=async()=>{if(k){console.log("Usage profile already exists, skipping redundant AI call."),u("usage_review");return}l(!0),u("processing_usage");try{const L=localStorage.getItem("token"),ee=L?{Authorization:`Bearer ${L}`}:{},ie=await Be.post(`${Xe}/api/workflow/predict-usage`,{intent:P,infraSpec:p},{headers:ee});setTimeout(()=>{A(ie.data.data),u("usage_review"),l(!1),ue.success("Usage estimates generated!")},1e3)}catch(L){console.error("Usage Prediction Error:",L),l(!1),u("review_spec"),ue.error("Failed to estimate usage. Skipping to manual mode.")}},ge=async()=>{var L,ee,ie,he,pe,xe,_e,Ae,je,Se,fe;if(!p||!P){ue.error("Missing infrastructure data. Please restart.");return}l(!0),u("processing_cost"),ue.loading("Analyzing costs across providers...",{id:"cost-analysis"});try{const de=localStorage.getItem("token"),ne=de?{Authorization:`Bearer ${de}`}:{},Ne={infraSpec:p,intent:P,cost_profile:G,usage_profile:{...k==null?void 0:k.usage_profile,source:me?"user_provided":"ai_inferred"}};H(!1),le(f);const De=await Be.post(`${Xe}/api/workflow/cost-analysis`,Ne,{headers:ne});if(ue.dismiss("cost-analysis"),De.data.step==="cost_estimation")setTimeout(()=>{var st;const ze=De.data.data;F(ze),B(((st=ze.recommended)==null?void 0:st.provider)||ze.recommended_provider),u("cost_estimation"),ue.success("Cost analysis complete!")},100);else throw new Error("Unexpected response from cost analysis")}catch(de){console.error("[COST ANALYSIS ERROR]",de),ue.dismiss("cost-analysis"),u("usage_review");let ne="Failed to analyze costs.";((L=de.response)==null?void 0:L.status)===400?ne=((ie=(ee=de.response)==null?void 0:ee.data)==null?void 0:ie.msg)||"Invalid infrastructure data. Please review your architecture.":((he=de.response)==null?void 0:he.status)===401?(ne="Session expired. Please login again.",setTimeout(()=>c("/"),1500)):((pe=de.response)==null?void 0:pe.status)===500?ne=((_e=(xe=de.response)==null?void 0:xe.data)==null?void 0:_e.error)||"Server error during cost calculation. Please try again.":de.code==="ECONNABORTED"?ne="Cost analysis timed out. Please try again.":de.response?ne=((je=(Ae=de.response)==null?void 0:Ae.data)==null?void 0:je.msg)||((fe=(Se=de.response)==null?void 0:Se.data)==null?void 0:fe.error)||ne:ne="Cannot reach cost analysis service. Check your connection.",ue.error(ne,{duration:6e3,icon:""})}finally{l(!1)}};K.useEffect(()=>{(async()=>{var ee,ie,he,pe;if(r)try{const xe=localStorage.getItem("token"),_e=xe?{Authorization:`Bearer ${xe}`}:{},je=(await Be.get(`${Xe}/api/workspaces/${r}`,{headers:_e})).data;if(((((ie=(ee=je.state_json)==null?void 0:ee.deployment)==null?void 0:ie.status)||je.step)==="active"||je.step==="active_deployment")&&(X(!0),console.log("[WORKSPACE] Deployed workspace - editing disabled")),I(je.id),h({id:je.project_id,name:je.name}),je.state_json){const fe=je.state_json;let de=fe.step||je.step||"input";de==="confirm_intent"&&(de="input"),u(de),i(fe.description||""),n(fe.history||[]),b(fe.currentQuestion||null),v(fe.infraSpec||null),fe.aiSnapshot&&D(fe.aiSnapshot),fe.costEstimation&&F(fe.costEstimation),fe.costProfile&&te(fe.costProfile),fe.selectedProvider?B(fe.selectedProvider):(pe=(he=fe.costEstimation)==null?void 0:he.recommended)!=null&&pe.provider&&B(fe.costEstimation.recommended.provider),fe.projectData&&h(ne=>({...ne,...fe.projectData}))}le(f),console.log("Workspace loaded:",je.name)}catch(xe){console.error("Load Error:",xe),xe.response?xe.response.status===401?(ue.error("Session expired. Please login again."),c("/")):xe.response.status===403?(ue.error("You do not have permission to view this workspace."),c("/workspaces")):xe.response.status===404?(ue.error("Workspace not found. It may have been deleted."),c("/workspaces")):ue.error("Failed to load workspace. Server error."):ue.error("Connection failed. Please check your internet.")}})()},[r,c]);const ke=async()=>{var L,ee,ie,he,pe,xe,_e,Ae,je,Se,fe;if(!f.trim()){ue.error("Please describe your project first!");return}l(!0),u("processing");try{const de=localStorage.getItem("token"),ne=de?{Authorization:`Bearer ${de}`}:{},Ne=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:f,conversationHistory:s,input_type:"DESCRIPTION"},{headers:ne});setTimeout(()=>{const{step:De,data:ze}=Ne.data;l(!1),ze!=null&&ze.full_analysis&&D(ze.full_analysis),De==="refine_requirements"?(b(ze),u("question")):De==="confirm_intent"?(b(ze),u("confirm_intent")):De==="infra_spec_generated"?(v(ze),h({name:ze.project_name}),u("review_spec"),ue.success("Architecture Generated Successfully!")):(console.warn("Unknown Step:",De),!De&&!ze&&(ue.error("Server returned empty response."),u("input")))},1200)}catch(de){console.error("[ANALYZE ERROR]",de),l(!1),u("input");let ne="Failed to analyze your request.";((L=de.response)==null?void 0:L.status)===401?(ne="Your session has expired. Please login again.",ue.error(ne,{duration:4e3}),setTimeout(()=>c("/"),1500)):((ee=de.response)==null?void 0:ee.status)===400?(ne=((he=(ie=de.response)==null?void 0:ie.data)==null?void 0:he.msg)||((xe=(pe=de.response)==null?void 0:pe.data)==null?void 0:xe.error)||"Invalid request. Please check your input.",ue.error(ne,{duration:5e3})):((_e=de.response)==null?void 0:_e.status)===500?(ne="Server error occurred. Please try again or contact support.",ue.error(ne,{duration:5e3})):de.code==="ECONNABORTED"||de.message.includes("timeout")?(ne="Request timeout. Please check your connection and try again.",ue.error(ne,{duration:5e3})):de.response?(ne=((je=(Ae=de.response)==null?void 0:Ae.data)==null?void 0:je.msg)||((fe=(Se=de.response)==null?void 0:Se.data)==null?void 0:fe.error)||ne,ue.error(ne,{duration:5e3})):(ne="Cannot connect to server. Please check your internet connection.",ue.error(ne,{duration:5e3}))}},Ee=async L=>{var ee,ie,he,pe,xe,_e,Ae,je,Se,fe,de;l(!0),u("processing");try{const ne=localStorage.getItem("token"),Ne=ne?{Authorization:`Bearer ${ne}`}:{},De=f||(g==null?void 0:g.name)||"User confirmed intent",ze=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:De,conversationHistory:s,input_type:"CONFIRMATION",approvedIntent:L},{headers:Ne});setTimeout(()=>{const{step:st,data:gt}=ze.data;l(!1),st==="refine_requirements"?(b(gt),u("question")):st==="infra_spec_generated"&&(v(gt),h({name:gt.project_name}),u("review_spec"),ue.success("Architecture Generated Successfully!"))},1e3)}catch(ne){console.error("[CONFIRMATION ERROR]",ne),l(!1),u("confirm_intent");let Ne="Failed to confirm and generate architecture.";((ee=ne.response)==null?void 0:ee.status)===400?Ne=((he=(ie=ne.response)==null?void 0:ie.data)==null?void 0:he.msg)||((xe=(pe=ne.response)==null?void 0:pe.data)==null?void 0:xe.error)||"Invalid confirmation data. Please try again.":((_e=ne.response)==null?void 0:_e.status)===401?(Ne="Session expired. Please login again.",setTimeout(()=>c("/"),1500)):((Ae=ne.response)==null?void 0:Ae.status)===500?Ne="Server error during architecture generation. Please try again.":ne.response?Ne=((Se=(je=ne.response)==null?void 0:je.data)==null?void 0:Se.msg)||((de=(fe=ne.response)==null?void 0:fe.data)==null?void 0:de.error)||Ne:Ne="Network error. Please check your connection.",ue.error(Ne,{duration:5e3})}},a=async L=>{m(L),setTimeout(async()=>{var ie,he,pe,xe,_e,Ae,je;const ee=[...s,{role:"user",content:f},{role:"assistant",content:d.clarifying_question},{role:"user",content:L}];n(ee),b(null),m(null),l(!0),u("processing_spec");try{const Se=localStorage.getItem("token"),fe=Se?{Authorization:`Bearer ${Se}`}:{},de=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:f,conversationHistory:ee,input_type:"AXIS_ANSWER",ai_snapshot:P||(d==null?void 0:d.full_analysis)},{headers:fe});setTimeout(()=>{const{step:ne,data:Ne}=de.data;l(!1),Ne!=null&&Ne.full_analysis&&D(Ne.full_analysis),ne==="refine_requirements"?(b(Ne),u("question")):ne==="confirm_intent"?(b(Ne),u("confirm_intent")):ne==="infra_spec_generated"&&(v(Ne),h({name:Ne.project_name}),u("review_spec"),ue.success("Architecture Refined & Generated!"))},1200)}catch(Se){console.error("[ANSWER QUESTION ERROR]",Se),l(!1),u("question");let fe="Failed to process your answer.";((ie=Se.response)==null?void 0:ie.status)===400?fe="Invalid answer format. Please select a valid option.":((he=Se.response)==null?void 0:he.status)===401?(fe="Session expired. Redirecting to login...",setTimeout(()=>c("/"),1500)):((pe=Se.response)==null?void 0:pe.status)===500?fe="Server error processing your answer. Please try again.":Se.response?fe=((_e=(xe=Se.response)==null?void 0:xe.data)==null?void 0:_e.msg)||((je=(Ae=Se.response)==null?void 0:Ae.data)==null?void 0:je.error)||fe:fe="Network error. Please check your connection.",ue.error(fe,{duration:5e3})}},600)},U=async(L=!1)=>{var ee,ie;try{const he=localStorage.getItem("token"),pe={workspaceId:N,projectId:g==null?void 0:g.id,name:(g==null?void 0:g.name)||`Draft ${new Date().toLocaleTimeString()}`,step:t,state:{history:s,description:f,currentQuestion:d,infraSpec:p,projectData:g,aiSnapshot:P,costEstimation:C,costProfile:G,step:t}},xe=he?{Authorization:`Bearer ${he}`}:{},_e=await Be.post(`${Xe}/api/workspaces/save`,pe,{headers:xe});I(_e.data.workspaceId),_e.data.projectId&&h(Ae=>({...Ae,id:_e.data.projectId})),L||ue.success(`Draft ${N?"Updated":"Saved"} Successfully!`)}catch(he){if(console.error("Save Error:",he),!L){const pe=((ie=(ee=he.response)==null?void 0:ee.data)==null?void 0:ie.msg)||he.message||"Unknown error";ue.error(`Failed to save draft: ${pe}`)}}};return K.useEffect(()=>{if(t&&N&&t!=="input"&&t!=="processing"){const L=setTimeout(()=>{U(!0),console.log(`[Auto-save] Step: ${t}`)},1500);return()=>clearTimeout(L)}},[t,p,C]),e.jsxs("div",{className:"flex h-screen bg-background text-white font-inter overflow-hidden relative selection:bg-primary/30",children:[e.jsx(Is,{position:"top-right",toastOptions:{style:{background:"var(--color-surface, #171E2B)",color:"#fff",border:"1px solid var(--color-border, #2E3645)"}}}),e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-primary/5 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[30%] h-[30%] bg-blue-500/5 rounded-full blur-[100px]"})]}),e.jsx("div",{className:"w-64 bg-surface/80 backdrop-blur-xl border-r border-border flex flex-col justify-between p-6 hidden md:flex z-10",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-primary font-bold text-xl tracking-tight",children:[e.jsx("span",{className:"material-icons text-2xl",children:"cloud_circle"}),e.jsx("span",{children:"Cloudiverse"})]}),e.jsxs("nav",{className:"space-y-3",children:[e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all cursor-pointer 
                            ${t==="input"||t==="question"||t==="processing"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":"text-gray-400 hover:bg-white/5"}`,onClick:()=>u("input"),children:[e.jsx("span",{className:"material-icons text-sm",children:"edit_note"}),e.jsx("span",{children:"Requirements"}),p&&t!=="input"&&t!=="question"&&t!=="processing"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="review_spec"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!p&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(p||R)&&u("review_spec"),children:[e.jsx("span",{className:"material-icons text-sm",children:"schema"}),e.jsx("span",{children:"Specification"}),(p||R)&&t!=="review_spec"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="cost_estimation"||t==="processing_cost"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!p&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(C||R)&&u("cost_estimation"),children:[e.jsx("span",{className:"material-icons text-sm",children:"savings"}),e.jsx("span",{children:"Cost Estimator"}),(C||R)&&t!=="cost_estimation"&&t!=="processing_cost"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="architecture"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!C&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(C||R)&&u("architecture"),children:[e.jsx("span",{className:"material-icons text-sm",children:"design_services"}),e.jsx("span",{children:"Architecture"}),(J||R)&&t!=="architecture"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="terraform_view"||t==="deployment_ready"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":!ae&&!R?"opacity-50 cursor-not-allowed text-gray-500":"text-gray-400 hover:bg-white/5 cursor-pointer"}`,onClick:()=>(ae||R)&&u("terraform_view"),children:[e.jsx("span",{className:"material-icons text-sm",children:"code"}),e.jsx("span",{children:"Terraform"}),(ae||R)&&t!=="terraform_view"&&t!=="deployment_ready"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:"px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all cursor-pointer text-gray-400 hover:bg-white/5",onClick:()=>c(`/workspace/${N}/settings`),children:[e.jsx("span",{className:"material-icons text-sm",children:"settings"}),e.jsx("span",{children:"Settings"})]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col relative overflow-y-auto z-10 backdrop-blur-sm",children:[e.jsxs("header",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-black/20 backdrop-blur-md sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-lg font-medium text-gray-200 tracking-wide",children:(g==null?void 0:g.name)||"Untitled Project"}),e.jsx("div",{className:"flex items-center space-x-2",children:R?e.jsxs("span",{className:"px-3 py-1 rounded-full bg-green-500/10 border border-green-500/20 text-[10px] font-bold text-green-400 tracking-wider uppercase flex items-center space-x-1",children:[e.jsx("span",{className:"material-icons text-[10px]",children:"check_circle"}),e.jsx("span",{children:"Deployed"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold text-gray-400 tracking-wider uppercase",children:"Draft Mode"}),e.jsxs("button",{onClick:()=>U(!1),className:"px-3 py-1 rounded-full bg-primary/10 border border-primary/20 text-[10px] font-bold text-primary hover:bg-primary/20 transition-colors uppercase tracking-wider flex items-center space-x-1",children:[e.jsx("span",{className:"material-icons text-[10px]",children:"save"}),e.jsx("span",{children:N?"Update Draft":"Save Draft"})]})]})})]}),e.jsxs("button",{onClick:()=>c("/workspaces"),className:"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-sm font-medium text-gray-400 hover:bg-white/10 hover:text-white transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"dashboard"}),e.jsx("span",{children:"Workspace Dashboard"})]})]}),e.jsx("div",{className:"flex-1 p-8 flex",children:e.jsxs("div",{className:"w-full max-w-5xl space-y-12 mx-auto",children:[Y&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 flex items-center justify-between animate-shake",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"material-icons text-yellow-500",children:"warning"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("b",{children:"Assumption Drift:"})," The project description has changed. Previous cost estimates may no longer be valid."]})]}),e.jsx("button",{onClick:()=>ke(),className:"px-4 py-2 bg-yellow-500 text-black font-bold text-xs rounded-lg hover:bg-yellow-400 transition-colors",children:"Re-Analyze"})]}),(t==="processing"||t==="processing_spec")&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-white/10 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-primary rounded-full border-t-transparent animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-4xl text-white animate-pulse",children:"grain"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t==="processing"?"Analyzing Intent...":"Generating Blueprint..."}),e.jsx("p",{className:"text-gray-400 animate-pulse",children:"Architecting your production-grade infrastructure"})]})]}),t==="input"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up mt-10",children:[R&&e.jsxs("div",{className:"bg-green-500/10 border-2 border-green-500/30 rounded-2xl p-6 flex items-start space-x-4 shadow-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"material-icons text-green-400 text-4xl",children:"check_circle"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-green-400 mb-2 flex items-center space-x-2",children:[e.jsx("span",{children:"Project Successfully Deployed"}),e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-300 text-xs rounded-full",children:"Read-Only Mode"})]}),e.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:"This workspace has been deployed and is now in read-only mode. You can view all details and download Terraform files, but cannot modify the architecture or configuration."})]})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-200 to-gray-500 tracking-tight",children:R?"Deployed Architecture":"Architect Your Vision"}),e.jsx("p",{className:"text-lg text-gray-400 max-w-2xl mx-auto leading-relaxed",children:R?"Review your deployed infrastructure configuration below.":"Describe your application in plain English. Our AI Discovery Engine will analyze your intent and generate a production-grade infrastructure specification."})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary to-blue-600 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"}),e.jsxs("div",{className:"relative bg-surface border border-border rounded-2xl p-2 shadow-2xl",children:[e.jsx("textarea",{className:"w-full h-48 bg-transparent text-xl p-8 focus:outline-none resize-none placeholder-gray-600 text-gray-200 font-light leading-relaxed disabled:opacity-60 disabled:cursor-not-allowed",placeholder:"e.g., I need a highly scalable e-commerce backend with microservices, handling 50k concurrent users, and strict PCI compliance...",value:f,onChange:L=>i(L.target.value),disabled:R,readOnly:R}),e.jsxs("div",{className:"flex justify-between items-center px-8 py-5 bg-white/5 rounded-b-xl border-t border-white/5",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 disabled:opacity-40 disabled:cursor-not-allowed",disabled:R,children:e.jsx("span",{className:"material-icons text-xl",children:"mic"})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 disabled:opacity-40 disabled:cursor-not-allowed",disabled:R,children:e.jsx("span",{className:"material-icons text-xl",children:"attach_file"})})]}),!R&&e.jsxs("button",{onClick:ke,className:"flex items-center space-x-3 px-8 py-3 bg-primary hover:bg-primary-hover text-black font-bold rounded-xl transition-all transform hover:scale-[1.02] shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Generate Architecture"}),e.jsx("span",{className:"material-icons text-lg",children:"auto_awesome"})]})]})]})]})]}),t==="question"&&d&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up max-w-2xl mx-auto mt-12 pb-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"material-icons text-primary text-3xl",children:"psychology"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Clarifying Requirements"}),e.jsx("p",{className:"text-gray-400",children:d.clarifying_question})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:(T=d.suggested_options)==null?void 0:T.map((L,ee)=>e.jsxs("button",{onClick:()=>a(typeof L=="object"?L.value||L.label:L),className:`p-6 bg-surface border rounded-2xl text-left transition-all group relative overflow-hidden
                                                ${x===(typeof L=="object"?L.value||L.label:L)?"border-primary ring-1 ring-primary":"border-border hover:border-white/20"}`,children:[e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:typeof L=="object"?L.label:L}),L.description&&e.jsx("div",{className:"text-sm text-gray-400 line-clamp-2",children:L.description})]}),e.jsx("span",{className:"material-icons text-gray-600 group-hover:text-primary transition-colors",children:"arrow_forward"})]}),x===(typeof L=="object"?L.value||L.label:L)&&e.jsx("div",{className:"absolute inset-0 bg-primary/5 animate-pulse"})]},ee))})]}),t==="confirm_intent"&&d&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up max-w-3xl mx-auto mt-12 pb-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Confirm Project Scope"}),e.jsx("p",{className:"text-gray-400",children:"We've analyzed your requirements. Please confirm this summary before we generate the infrastructure."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-3xl p-8 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full blur-[100px] -mr-32 -mt-32"}),e.jsxs("div",{className:"space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/10 border border-primary/20 text-primary rounded-full text-[10px] font-bold uppercase tracking-widest",children:"AI Intent Snapshot"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:"Confirmed"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:"Excluded"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Goal"}),e.jsx("p",{className:"text-white font-medium capitalize prose prose-invert",children:((y=(_=d.intent)==null?void 0:_.primary_domain)==null?void 0:y.replace(/_/g," "))||"Building an application"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Workload Pattern"}),e.jsx("p",{className:"text-white/80 text-sm italic",children:((M=(E=d.intent)==null?void 0:E.workload_type)==null?void 0:M.replace(/_/g," "))||"Standard Workload"})]}),d.exclusions&&d.exclusions.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-red-500/70 uppercase tracking-widest mb-2 flex items-center",children:[e.jsx("span",{className:"material-icons text-xs mr-1",children:"block"}),"Explicit Exclusions"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.exclusions.map((L,ee)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/10 text-red-400 border border-red-500/20 rounded text-[10px] font-bold uppercase tracking-wider line-through decoration-red-500/50",children:L.replace(/_/g," ")},ee))})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 rounded-2xl p-5 border border-white/5",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Feature Resolution"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[10px] text-green-500 font-bold uppercase",children:"Confirmed Present"}),e.jsxs("ul",{className:"grid grid-cols-1 gap-1.5",children:[Object.entries(d.features||{}).filter(([L,ee])=>ee===!0).map(([L,ee],ie)=>e.jsxs("li",{className:"flex items-center text-xs text-gray-200 bg-green-500/5 px-2 py-1 rounded",children:[e.jsx("span",{className:"material-icons text-[12px] text-green-500 mr-2",children:"check_circle"}),e.jsx("span",{className:"capitalize",children:L.replace(/_/g," ")})]},ie)),Object.values(d.features||{}).filter(L=>L===!0).length===0&&e.jsx("li",{className:"text-xs text-gray-500 italic",children:"None detected."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 font-bold uppercase",children:"What we did NOT assume"}),e.jsx("ul",{className:"grid grid-cols-1 gap-1.5 opacity-60",children:Object.entries(d.features||{}).filter(([L,ee])=>ee==="unknown"||ee===!1).map(([L,ee],ie)=>e.jsxs("li",{className:"flex items-center text-xs text-gray-400",children:[e.jsx("span",{className:"material-icons text-[12px] text-gray-600 mr-2",children:ee===!1?"block":"help_outline"}),e.jsx("span",{className:"capitalize",children:L.replace(/_/g," ")})]},ie))})]})]})]})})]}),e.jsxs("div",{className:"pt-6 border-t border-white/5 flex flex-col space-y-4",children:[e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:[e.jsx("span",{className:"material-icons text-[10px] align-middle mr-1",children:"lock"}),"Confirming locks this intent as the ",e.jsx("b",{children:"Single Source of Truth"}),"."]}),e.jsxs("button",{onClick:()=>Ee(d.full_analysis),className:"w-full py-4 bg-primary hover:bg-primary-hover text-black font-extrabold rounded-2xl transition-all transform hover:scale-[1.01] shadow-xl shadow-primary/20 flex items-center justify-center space-x-3",children:[e.jsx("span",{children:"Confirm & Generate Blueprint"}),e.jsx("span",{className:"material-icons",children:"rocket_launch"})]})]})]})]})]}),t==="review_spec"&&p&&e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary/5 rounded-full blur-[60px] -mr-10 -mt-10"}),e.jsx("button",{onClick:()=>c(`/workspace/${N}/settings`),className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors rounded-lg p-2 hover:bg-white/5",children:e.jsx("span",{className:"material-icons text-sm",children:"settings"})}),e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Project Snapshot"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 relative z-10",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Project Name"}),e.jsx("div",{className:"text-xl font-bold text-white tracking-tight flex items-center space-x-2 group",children:e.jsx("span",{children:(g==null?void 0:g.name)||p.project_name||"My Cloud Project"})}),e.jsxs("div",{className:"mt-2 group",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",title:g==null?void 0:g.description,children:(g==null?void 0:g.description)||p.project_summary||f||"No description provided."})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Project Type"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 bg-white/5 rounded-full text-sm text-gray-300 border border-white/5",children:[e.jsx("span",{className:"material-icons text-xs",children:"category"}),e.jsx("span",{className:"capitalize",children:((Z=p.architecture_pattern)==null?void 0:Z.replace(/_/g," "))||"Web App"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Client Type"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 bg-white/5 rounded-full text-sm text-gray-300 border border-white/5",children:[e.jsx("span",{className:"material-icons text-xs",children:"devices"}),e.jsx("span",{className:"capitalize",children:((z=P==null?void 0:P.intent)==null?void 0:z.client_type)||"Web"})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(P==null?void 0:P.features)&&Object.entries(P.features).filter(([L,ee])=>ee===!0).map(([L])=>e.jsx("span",{className:"px-2 py-1 bg-blue-500/10 text-blue-400 border border-blue-500/20 rounded text-[10px] font-bold uppercase tracking-wider",children:L.replace(/_/g," ")},L))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 text-xs font-bold",children:""}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"How we understood your project"})]}),e.jsxs("div",{className:"bg-surface/50 border border-border rounded-2xl p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(q=p.explanations)==null?void 0:q.slice(0,4).map((L,ee)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mt-0.5",children:"check"}),e.jsx("span",{className:"text-sm text-gray-300 leading-relaxed",children:L})]},ee)),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mt-0.5",children:"check"}),e.jsxs("span",{className:"text-sm text-gray-300 leading-relaxed",children:["Traffic scale assumption: ",e.jsx("span",{className:"text-white font-medium",children:((Q=p.assumptions)==null?void 0:Q.traffic_tier)||"Medium"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4 italic",children:"Based on your description and selected options."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-primary",children:"schema"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Architecture Overview"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 relative overflow-hidden group hover:border-primary/30 transition-all duration-500",children:[e.jsxs("p",{className:"text-white font-medium text-lg leading-relaxed border-b border-white/5 pb-4 mb-6",children:['"',p.project_summary||"Optimized cloud infrastructure.",'"']}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Included Services & Infrastructure"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(V=p.modules)==null?void 0:V.map((L,ee)=>e.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/20 transition-colors",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mr-3",children:L.category==="compute"?"memory":L.category==="storage"?"storage":L.category==="database"?"database":"cloud"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-bold text-white",children:L.service_name||L.type}),e.jsx("div",{className:"text-xs text-primary/80 uppercase font-bold tracking-wider",children:L.category})]})]},ee))})]}),e.jsxs("div",{className:"flex items-start space-x-2 bg-blue-500/5 p-4 rounded-xl border border-blue-500/10",children:[e.jsx("span",{className:"material-icons text-blue-400 text-sm mt-0.5",children:"info"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["This architecture is designed for ",e.jsx("strong",{children:(se=p.assumptions)==null?void 0:se.traffic_tier})," traffic. Proceed to usage estimation to see detailed costs."]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:ve,disabled:w,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50",children:[e.jsx("span",{children:"Estimate Usage & Costs"}),e.jsx("span",{className:"material-icons",children:"analytics"})]})})]}),t==="processing_usage"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Analyzing Usage Patterns"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"AI is predicting realistic user traffic, storage, and bandwidth..."})]})]}),t==="usage_review"&&k&&e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Estimated Usage Profile"}),e.jsxs("p",{className:"text-gray-400 max-w-2xl mx-auto",children:['Based on your project description ("',g==null?void 0:g.name,`"), we've inferred the following usage patterns to generate accurate costs.`]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-primary/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-primary/20 group-hover:text-primary/40 transition-colors text-4xl",children:"group"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Scale: Monthly Users"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-primary outline-none transition-colors",value:k.usage_profile.monthly_users.min,onChange:L=>{const ee=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,monthly_users:{...k.usage_profile.monthly_users,min:ee}}}),ye(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-primary outline-none transition-colors",value:k.usage_profile.monthly_users.max,onChange:L=>{const ee=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,monthly_users:{...k.usage_profile.monthly_users,max:ee}}}),ye(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[10px] text-green-400 font-bold uppercase tracking-wider",children:"Expected Traffic"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((be=k.rationale)==null?void 0:be.monthly_users)||"Based on typical growth for this workload type.",'"']})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-blue-500/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-blue-500/20 group-hover:text-blue-500/40 transition-colors text-4xl",children:"swap_horiz"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Network: Data Transfer (GB)"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-blue-500 outline-none transition-colors",value:k.usage_profile.data_transfer_gb.min,onChange:L=>{const ee=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,data_transfer_gb:{...k.usage_profile.data_transfer_gb,min:ee}}}),ye(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-blue-500 outline-none transition-colors",value:k.usage_profile.data_transfer_gb.max,onChange:L=>{const ee=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,data_transfer_gb:{...k.usage_profile.data_transfer_gb,max:ee}}}),ye(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-wider",children:"Egress/Bandwidth"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((ce=k.rationale)==null?void 0:ce.data_transfer_gb)||"Simulates content delivery and API interactions.",'"']})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-purple-500/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-purple-500/20 group-hover:text-purple-500/40 transition-colors text-4xl",children:"storage"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Capacity: Storage (GB)"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-purple-500 outline-none transition-colors",value:k.usage_profile.data_storage_gb.min,onChange:L=>{const ee=parseInt(L.target.value)||0;A(ie=>({...ie,usage_profile:{...ie.usage_profile,data_storage_gb:{...ie.usage_profile.data_storage_gb,min:ee}}})),ye(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-purple-500 outline-none transition-colors",value:k.usage_profile.data_storage_gb.max,onChange:L=>{const ee=parseInt(L.target.value)||0;A(ie=>({...ie,usage_profile:{...ie.usage_profile,data_storage_gb:{...ie.usage_profile.data_storage_gb,max:ee}}})),ye(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),e.jsx("span",{className:"text-[10px] text-purple-400 font-bold uppercase tracking-wider",children:"Data Footprint"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((Re=k.rationale)==null?void 0:Re.data_storage_gb)||((We=k.rationale)==null?void 0:We.storage_gb)||"Accounts for both database and file assets.",'"']})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>u("review_spec"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Architecture"})]}),e.jsxs("button",{onClick:ge,disabled:w,className:"px-8 py-4 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-green-500/20 disabled:opacity-50",children:[e.jsx("span",{children:"Calculate Cloud Costs"}),e.jsx("span",{className:"material-icons",children:"payments"})]})]})]}),t==="cost_estimation"&&C&&e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-primary",children:"cloud"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Cloud Provider Comparison"})]}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:"Select a provider to see specific details"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(C.rankings||[]).map(L=>{var ie;const ee=o===L.provider;return e.jsxs("div",{onClick:()=>B(L.provider),className:`cursor-pointer rounded-2xl p-5 border transition-all relative overflow-hidden flex flex-col justify-between
                                                        ${ee?"bg-primary/10 border-primary shadow-lg shadow-primary/20 scale-[1.02]":"bg-surface border-border hover:border-white/20"}`,children:[L.recommended&&e.jsx("div",{className:"absolute top-0 right-0 px-3 py-1 bg-gradient-to-r from-yellow-400 to-amber-500 text-[10px] font-bold text-black uppercase tracking-tighter rounded-bl-xl shadow-lg",children:"Recommended"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold
                                                            ${L.provider==="AWS"?"bg-[#FF9900]/20 text-[#FF9900]":L.provider==="GCP"?"bg-[#4285F4]/20 text-[#4285F4]":"bg-[#0078D4]/20 text-[#0078D4]"}`,children:L.provider==="AWS"?"AWS":L.provider==="GCP"?"GCP":"AZ"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:L.provider==="AZURE"?"Azure":L.provider}),e.jsxs("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest",children:[L.score,"% Score"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-white leading-tight",children:[((ie=L.cost_range)==null?void 0:ie.formatted)||L.formatted_cost,L.monthly_cost&&L.monthly_cost<1&&e.jsx("div",{className:"text-[10px] text-amber-400",children:L.cost_intent==="hobby"?"Hobby-scale lower bound":"Estimated minimum"})]}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:L.recommended?"Recommended configuration (Cost-Effective)":"Estimated Monthly Cost"}),(()=>{let he="standard";if(C.scenarios){for(const[pe,xe]of Object.entries(C.scenarios))if(xe[L.provider]){he=pe;break}}return e.jsxs("div",{className:"text-[10px] text-gray-400",children:[he.replace("_"," ").replace(/\b\w/g,pe=>pe.toUpperCase())," profile"]})})(),L.recommended&&(C==null?void 0:C.recommendation_facts)&&e.jsx("div",{className:"text-[10px] text-amber-400 italic mt-1",children:C.recommendation_facts.facts.dominant_drivers[0]?`${C.recommendation_facts.facts.dominant_drivers[0].name} is a key cost driver at your usage level.`:"Based on your usage patterns and cost optimization."})]}),ee&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-primary/20 flex items-center justify-between text-[10px] text-primary font-bold uppercase tracking-wider",children:[e.jsx("span",{children:"Selected"}),e.jsx("span",{className:"material-icons text-[12px]",children:"check_circle"})]})]},L.provider)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-green-400",children:"paid"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Cost Details & Confidence"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col justify-center items-center text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mb-3",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#2E3645",strokeWidth:"4"}),e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:typeof C.confidence=="number"&&C.confidence>.8?"#22c55e":typeof C.confidence=="number"&&C.confidence>.5?"#eab308":"#ef4444",strokeWidth:"4",strokeDasharray:`${(C.confidence||0)*100}, 100`})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsxs("span",{className:"text-xl font-bold text-white",children:[typeof C.confidence=="number"?(C.confidence*100).toFixed(0):"0","%"]})})]}),e.jsxs("div",{className:"text-sm font-bold text-white uppercase tracking-wider flex items-center space-x-2",children:[e.jsx("span",{children:"Confidence"}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"material-icons text-xs text-gray-400 cursor-help",children:"info"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg shadow-lg w-64 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[((Oe=C.confidence_explanation)==null?void 0:Oe.join(". "))||"Confidence based on service resolution, data quality, and estimate type.",e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 line-clamp-2",children:((Ze=C.confidence_explanation)==null?void 0:Ze[0])||"Based on architecture completeness and data quality."}),(((we=C.recommended)==null?void 0:we.estimate_type)||((Je=(Ye=C.providers)==null?void 0:Ye[o])==null?void 0:Je.estimate_type))&&e.jsx("div",{className:"mt-3 w-full",children:e.jsx("div",{className:`px-3 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider ${((Fe=C.recommended)==null?void 0:Fe.estimate_type)==="exact"||((nt=(tt=C.providers)==null?void 0:tt[o])==null?void 0:nt.estimate_type)==="exact"?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-amber-500/20 text-amber-400 border border-amber-500/30"}`,children:((it=C.recommended)==null?void 0:it.estimate_type)==="exact"||((rt=(ot=C.providers)==null?void 0:ot[o])==null?void 0:rt.estimate_type)==="exact"?" Exact (Terraform-based)":" Estimated (Heuristic)"})})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col justify-center items-center text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-3",children:(()=>{var ee,ie;const L=(ee=C.rankings)==null?void 0:ee.find(he=>he.provider===o);if(!(L!=null&&L.score)){const he=C.scenarios?Object.values(C.scenarios).map(pe=>pe[o]).find(pe=>pe):null;return(he==null?void 0:he.score)||((ie=C.recommended)==null?void 0:ie.score)||"N/A"}return L.score})()}),e.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider",children:"% Score"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[o||"Provider"," competitiveness"]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase font-bold mb-4",children:"Estimate Based On"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(He=k==null?void 0:k.usage_profile)!=null&&He.monthly_users?typeof k.usage_profile.monthly_users=="object"?`${(k.usage_profile.monthly_users.min||0).toLocaleString()} - ${(k.usage_profile.monthly_users.max||0).toLocaleString()}`:k.usage_profile.monthly_users.toLocaleString():(Rt=(At=(Ke=C==null?void 0:C.recommendation_facts)==null?void 0:Ke.facts)==null?void 0:At.usage)!=null&&Rt.monthly_users?typeof C.recommendation_facts.facts.usage.monthly_users=="object"?`${(C.recommendation_facts.facts.usage.monthly_users.min||0).toLocaleString()} - ${(C.recommendation_facts.facts.usage.monthly_users.max||0).toLocaleString()}`:C.recommendation_facts.facts.usage.monthly_users.toLocaleString():"5,000"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Monthly Users"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(zt=k==null?void 0:k.usage_profile)!=null&&zt.data_transfer_gb?typeof k.usage_profile.data_transfer_gb=="object"?`${k.usage_profile.data_transfer_gb.min||0} - ${k.usage_profile.data_transfer_gb.max||0} GB`:`${k.usage_profile.data_transfer_gb} GB`:(Tt=(Ot=(It=C==null?void 0:C.recommendation_facts)==null?void 0:It.facts)==null?void 0:Ot.usage)!=null&&Tt.data_transfer_gb?typeof C.recommendation_facts.facts.usage.data_transfer_gb=="object"?`${C.recommendation_facts.facts.usage.data_transfer_gb.min||0} - ${C.recommendation_facts.facts.usage.data_transfer_gb.max||0} GB`:`${C.recommendation_facts.facts.usage.data_transfer_gb} GB`:"50 GB"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Data Transfer"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(Ft=k==null?void 0:k.usage_profile)!=null&&Ft.data_storage_gb?typeof k.usage_profile.data_storage_gb=="object"?`${k.usage_profile.data_storage_gb.min||0} - ${k.usage_profile.data_storage_gb.max||0} GB`:`${k.usage_profile.data_storage_gb} GB`:(Pt=(Dt=(Bt=C==null?void 0:C.recommendation_facts)==null?void 0:Bt.facts)==null?void 0:Dt.usage)!=null&&Pt.data_storage_gb?typeof C.recommendation_facts.facts.usage.data_storage_gb=="object"?`${C.recommendation_facts.facts.usage.data_storage_gb.min||0} - ${C.recommendation_facts.facts.usage.data_storage_gb.max||0} GB`:`${C.recommendation_facts.facts.usage.data_storage_gb} GB`:"10 GB"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Storage"})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{var ie,he,pe;return((((ie=C.recommended)==null?void 0:ie.provider)===o?C.recommended.services:null)||((pe=(he=C.provider_details)==null?void 0:he[o||"aws"])==null?void 0:pe.services)||[]).slice(0,6).map((xe,_e)=>e.jsx("span",{className:"px-3 py-1 bg-white/5 border border-white/10 rounded-full text-xs text-gray-300",children:xe.cloud_service||xe.display_name},_e))})()})}),(C==null?void 0:C.recommendation_facts)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-amber-500/20",children:[e.jsxs("div",{className:"text-xs text-amber-400 font-bold uppercase tracking-wider mb-2",children:["Why ",C.recommendation_facts.provider.toUpperCase(),"?"]}),e.jsx("div",{className:"space-y-1 text-xs text-gray-300",children:C.recommendation_facts.pros.map((L,ee)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-400 mr-1",children:""}),e.jsx("span",{children:L})]},ee))})]}),e.jsxs("button",{onClick:()=>u("usage_review"),className:"mt-4 w-full py-2 text-gray-400 text-xs font-medium hover:text-white hover:bg-white/5 rounded-lg transition-colors flex items-center justify-center space-x-1",children:[e.jsx("span",{className:"material-icons text-xs",children:"edit"}),e.jsx("span",{children:"Refine assumptions"})]})]})]})]}),e.jsxs("div",{className:"border border-white/5 rounded-2xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>m(x==="scenarios"?null:"scenarios"),className:"w-full p-4 bg-white/5 hover:bg-white/10 flex items-center justify-between transition-colors",children:[e.jsx("span",{className:"font-medium text-gray-300",children:"Scaling Scenarios"}),e.jsx("span",{className:`material-icons text-gray-400 transition-transform ${x==="scenarios"?"rotate-180":""}`,children:"expand_more"})]}),x==="scenarios"&&e.jsxs("div",{className:"p-6 bg-surface animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"If traffic doubles?"}),e.jsx("span",{className:"text-[10px] font-bold text-red-400 bg-red-400/10 px-2 py-0.5 rounded uppercase",children:"+25%"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Cost scales with bandwidth and API requests."})]}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"If storage doubles?"}),e.jsx("span",{className:"text-[10px] font-bold text-green-400 bg-green-400/10 px-2 py-0.5 rounded uppercase",children:"+5%"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Storage is generally the most cost-effective component."})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-xl p-4",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:"Estimated Cost Range"}),e.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:((Ut=C.cost_range)==null?void 0:Ut.formatted)||"$0.00 - $0.00/month"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Depends on scaling, availability, and performance choices"})]})]})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-xl p-4 flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"warning"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-xs text-amber-200/90 leading-relaxed",children:(()=>{var ie,he,pe,xe,_e,Ae;const L=((ie=C.recommended)==null?void 0:ie.estimate_type)||((pe=(he=C.providers)==null?void 0:he[o])==null?void 0:pe.estimate_type)||"heuristic",ee=((xe=C.recommended)==null?void 0:xe.estimate_reason)||((Ae=(_e=C.providers)==null?void 0:_e[o])==null?void 0:Ae.estimate_reason);return L==="exact"||L==="infracost"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:"font-bold",children:"Exact Pricing:"})," These costs are calculated using real Terraform + Infracost CLI and represent actual provider pricing. Final costs may vary based on actual resource usage, region selection, and any enterprise discounts."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:"font-bold",children:"Estimated Pricing:"})," This is an approximate cost estimate based on formula-driven provider pricing for ",o||"the selected provider",".",ee&&e.jsxs("span",{className:"block mt-1 text-[10px] italic",children:["(",ee,")"]}),e.jsx("span",{className:"block mt-1",children:"Exact costs will be calculated when Terraform is generated and will depend on actual resource usage, region selection, and any enterprise discounts."})]})})()})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>u("usage_review"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Usage"})]}),e.jsxs("button",{onClick:()=>{u("architecture")},className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Review Architecture"}),e.jsx("span",{className:"material-icons",children:"design_services"})]})]})]}),t==="requirements"&&e.jsx(Us,{workspaceId:r,infraSpec:p,costEstimation:C,onNext:()=>u("architecture"),onBack:()=>u("cost_estimation"),onRequirementsCaptured:O}),t==="architecture"&&e.jsx(Va,{workspaceId:r,infraSpec:p,costEstimation:C,selectedProvider:o,selectedProfile:G,usageProfile:k,requirementsData:re,architectureData:J,onArchitectureDataLoaded:$,onNext:()=>u("feedback"),onBack:()=>u("requirements")}),t==="feedback"&&e.jsx(Os,{workspaceId:r,costEstimation:C,selectedProvider:o,costIntent:k==null?void 0:k.intent,onFeedbackSubmitted:()=>W(!0),onNext:()=>u("terraform_view"),onBack:()=>u("architecture")}),t==="terraform_view"&&e.jsx(Ps,{workspaceId:r,infraSpec:p,selectedProvider:o,costEstimation:C,onComplete:()=>u("deployment_ready"),onBack:()=>u("feedback")}),t==="processing_cost"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Analyzing Cloud Costs"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Comparing AWS, GCP, and Azure pricing..."})]})]}),t==="deployment_ready"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-500/20 mb-6",children:e.jsx("span",{className:"material-icons text-4xl text-green-400",children:"check_circle"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Ready for Deployment"}),e.jsx("p",{className:"text-gray-400 mt-3 max-w-md",children:"Your infrastructure is ready. Choose your deployment method below."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 max-w-lg w-full",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Deployment Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cloud Provider"}),e.jsx("span",{className:"text-white font-medium",children:(o==null?void 0:o.toUpperCase())||"Not Selected"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Services Count"}),e.jsxs("span",{className:"text-white font-medium",children:[(($t=C==null?void 0:C.recommended)==null?void 0:$t.service_count)||((Mt=(Lt=C==null?void 0:C.provider_details)==null?void 0:Lt[o])==null?void 0:Mt.service_count)||((Zt=(Wt=p==null?void 0:p.service_classes)==null?void 0:Wt.required_services)==null?void 0:Zt.length)||0," services"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Monthly Estimate"}),e.jsx("span",{className:"text-green-400 font-bold",children:((Ht=C==null?void 0:C.recommended)==null?void 0:Ht.formatted_cost)||((qt=(Gt=C==null?void 0:C.provider_details)==null?void 0:Gt[o])==null?void 0:qt.formatted_cost)||((Yt=(Vt=C==null?void 0:C.rankings)==null?void 0:Vt.find(L=>L.provider===o))==null?void 0:Yt.formatted_cost)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cost Profile"}),e.jsx("span",{className:"text-white font-medium capitalize",children:((Kt=C==null?void 0:C.cost_profile)==null?void 0:Kt.replace("_"," ").toLowerCase())||"standard"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-4 w-full max-w-2xl",children:[e.jsx("div",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deployment Options"}),e.jsxs("div",{className:"flex space-x-4 w-full justify-center",children:[e.jsxs("button",{onClick:async()=>{try{await Be.put(`http://localhost:5000/api/workspaces/${r}/deploy`,{deployment_method:"self",provider:o}),ue.success("Workspace ready! You can now deploy the downloaded Terraform code."),c("/workspaces")}catch(L){console.error("Failed to update deployment readiness:",L),ue.error("Failed to mark workspace as ready")}},className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-lg",children:"download_done"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold",children:"Self Deployment"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Download & deploy manually"})]})]}),e.jsxs("button",{disabled:!0,className:"px-6 py-3 bg-gradient-to-r from-primary/10 to-blue-500/10 border border-primary/20 rounded-xl text-primary/50 font-medium cursor-not-allowed flex items-center space-x-2 relative",children:[e.jsx("span",{className:"material-icons text-lg",children:"rocket_launch"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("span",{className:"text-sm font-bold flex items-center space-x-2",children:[e.jsx("span",{children:"One-Click Deployment"}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 rounded text-xs text-primary",children:"Coming Soon"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Automated cloud deployment"})]})]})]})]}),e.jsxs("button",{onClick:()=>u("terraform_view"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Terraform"})]})]})]})})]})]})};export{en as default};
