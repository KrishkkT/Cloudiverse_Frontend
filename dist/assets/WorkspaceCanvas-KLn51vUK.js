import{j as e}from"./index-BuOhdsOc.js";import{r as K,g as wr,c as $e,f as Le,e as _r,u as jr}from"./vendor-rtOnKvnR.js";import{a as Be}from"./utils-Demn4eoi.js";import{c as lt,u as Nr,a as wt,s as kr,z as Sr,P as Cr,b as Qt,i as Er,p as Ar,g as zr,d as er,e as Rr,f as Ir,h as Or,j as Fr,R as Tr,B as Br,C as Dr,k as Zt}from"./style-CLnCEdjw.js";import"./ui-C4fUc28P.js";let Pr={data:""},Ur=r=>{if(typeof window=="object"){let c=(r?r.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return c.nonce=window.__nonce__,c.parentNode||(r||document.head).appendChild(c),c.firstChild}return r||Pr},$r=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Lr=/\/\*[^]*?\*\/|  +/g,Ht=/\n+/g,Ge=(r,c)=>{let t="",u="",f="";for(let i in r){let s=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+s+";":u+=i[1]=="f"?Ge(s,i):i+"{"+Ge(s,i[1]=="k"?"":c)+"}":typeof s=="object"?u+=Ge(s,c?c.replace(/([^,])+/g,n=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,n):n?n+" "+d:d)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),f+=Ge.p?Ge.p(i,s):i+":"+s+";")}return t+(c&&f?c+"{"+f+"}":f)+u},Ue={},tr=r=>{if(typeof r=="object"){let c="";for(let t in r)c+=t+tr(r[t]);return c}return r},Mr=(r,c,t,u,f)=>{let i=tr(r),s=Ue[i]||(Ue[i]=(d=>{let b=0,p=11;for(;b<d.length;)p=101*p+d.charCodeAt(b++)>>>0;return"go"+p})(i));if(!Ue[s]){let d=i!==r?r:(b=>{let p,v,g=[{}];for(;p=$r.exec(b.replace(Lr,""));)p[4]?g.shift():p[3]?(v=p[3].replace(Ht," ").trim(),g.unshift(g[0][v]=g[0][v]||{})):g[0][p[1]]=p[2].replace(Ht," ").trim();return g[0]})(r);Ue[s]=Ge(f?{["@keyframes "+s]:d}:d,t?"":"."+s)}let n=t&&Ue.g?Ue.g:null;return t&&(Ue.g=Ue[s]),((d,b,p,v)=>{v?b.data=b.data.replace(v,d):b.data.indexOf(d)===-1&&(b.data=p?d+b.data:b.data+d)})(Ue[s],c,u,n),s},Wr=(r,c,t)=>r.reduce((u,f,i)=>{let s=c[i];if(s&&s.call){let n=s(t),d=n&&n.props&&n.props.className||/^go/.test(n)&&n;s=d?"."+d:n&&typeof n=="object"?n.props?"":Ge(n,""):n===!1?"":n}return u+f+(s??"")},"");function mt(r){let c=this||{},t=r.call?r(c.p):r;return Mr(t.unshift?t.raw?Wr(t,[].slice.call(arguments,1),c.p):t.reduce((u,f)=>Object.assign(u,f&&f.call?f(c.p):f),{}):t,Ur(c.target),c.g,c.o,c.k)}let rr,_t,jt;mt.bind({g:1});let Me=mt.bind({k:1});function Zr(r,c,t,u){Ge.p=c,rr=r,_t=t,jt=u}function Ve(r,c){let t=this||{};return function(){let u=arguments;function f(i,s){let n=Object.assign({},i),d=n.className||f.className;t.p=Object.assign({theme:_t&&_t()},n),t.o=/ *go\d+/.test(d),n.className=mt.apply(t,u)+(d?" "+d:"");let b=r;return r[0]&&(b=n.as||r,delete n.as),jt&&b[0]&&jt(n),rr(b,n)}return c?c(f):f}}var Hr=r=>typeof r=="function",ut=(r,c)=>Hr(r)?r(c):r,Gr=(()=>{let r=0;return()=>(++r).toString()})(),sr=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let c=matchMedia("(prefers-reduced-motion: reduce)");r=!c||c.matches}return r}})(),qr=20,St="default",ar=(r,c)=>{let{toastLimit:t}=r.settings;switch(c.type){case 0:return{...r,toasts:[c.toast,...r.toasts].slice(0,t)};case 1:return{...r,toasts:r.toasts.map(s=>s.id===c.toast.id?{...s,...c.toast}:s)};case 2:let{toast:u}=c;return ar(r,{type:r.toasts.find(s=>s.id===u.id)?1:0,toast:u});case 3:let{toastId:f}=c;return{...r,toasts:r.toasts.map(s=>s.id===f||f===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return c.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(s=>s.id!==c.toastId)};case 5:return{...r,pausedAt:c.time};case 6:let i=c.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},dt=[],nr={toasts:[],pausedAt:void 0,settings:{toastLimit:qr}},Pe={},ir=(r,c=St)=>{Pe[c]=ar(Pe[c]||nr,r),dt.forEach(([t,u])=>{t===c&&u(Pe[c])})},or=r=>Object.keys(Pe).forEach(c=>ir(r,c)),Vr=r=>Object.keys(Pe).find(c=>Pe[c].toasts.some(t=>t.id===r)),pt=(r=St)=>c=>{ir(c,r)},Yr={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Kr=(r={},c=St)=>{let[t,u]=K.useState(Pe[c]||nr),f=K.useRef(Pe[c]);K.useEffect(()=>(f.current!==Pe[c]&&u(Pe[c]),dt.push([c,u]),()=>{let s=dt.findIndex(([n])=>n===c);s>-1&&dt.splice(s,1)}),[c]);let i=t.toasts.map(s=>{var n,d,b;return{...r,...r[s.type],...s,removeDelay:s.removeDelay||((n=r[s.type])==null?void 0:n.removeDelay)||(r==null?void 0:r.removeDelay),duration:s.duration||((d=r[s.type])==null?void 0:d.duration)||(r==null?void 0:r.duration)||Yr[s.type],style:{...r.style,...(b=r[s.type])==null?void 0:b.style,...s.style}}});return{...t,toasts:i}},Xr=(r,c="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:c,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Gr()}),at=r=>(c,t)=>{let u=Xr(c,r,t);return pt(u.toasterId||Vr(u.id))({type:2,toast:u}),u.id},Ce=(r,c)=>at("blank")(r,c);Ce.error=at("error");Ce.success=at("success");Ce.loading=at("loading");Ce.custom=at("custom");Ce.dismiss=(r,c)=>{let t={type:3,toastId:r};c?pt(c)(t):or(t)};Ce.dismissAll=r=>Ce.dismiss(void 0,r);Ce.remove=(r,c)=>{let t={type:4,toastId:r};c?pt(c)(t):or(t)};Ce.removeAll=r=>Ce.remove(void 0,r);Ce.promise=(r,c,t)=>{let u=Ce.loading(c.loading,{...t,...t==null?void 0:t.loading});return typeof r=="function"&&(r=r()),r.then(f=>{let i=c.success?ut(c.success,f):void 0;return i?Ce.success(i,{id:u,...t,...t==null?void 0:t.success}):Ce.dismiss(u),f}).catch(f=>{let i=c.error?ut(c.error,f):void 0;i?Ce.error(i,{id:u,...t,...t==null?void 0:t.error}):Ce.dismiss(u)}),r};var Jr=1e3,Qr=(r,c="default")=>{let{toasts:t,pausedAt:u}=Kr(r,c),f=K.useRef(new Map).current,i=K.useCallback((v,g=Jr)=>{if(f.has(v))return;let h=setTimeout(()=>{f.delete(v),s({type:4,toastId:v})},g);f.set(v,h)},[]);K.useEffect(()=>{if(u)return;let v=Date.now(),g=t.map(h=>{if(h.duration===1/0)return;let w=(h.duration||0)+h.pauseDuration-(v-h.createdAt);if(w<0){h.visible&&Ce.dismiss(h.id);return}return setTimeout(()=>Ce.dismiss(h.id,c),w)});return()=>{g.forEach(h=>h&&clearTimeout(h))}},[t,u,c]);let s=K.useCallback(pt(c),[c]),n=K.useCallback(()=>{s({type:5,time:Date.now()})},[s]),d=K.useCallback((v,g)=>{s({type:1,toast:{id:v,height:g}})},[s]),b=K.useCallback(()=>{u&&s({type:6,time:Date.now()})},[u,s]),p=K.useCallback((v,g)=>{let{reverseOrder:h=!1,gutter:w=8,defaultPosition:o}=g||{},x=t.filter(S=>(S.position||o)===(v.position||o)&&S.height),m=x.findIndex(S=>S.id===v.id),j=x.filter((S,k)=>k<m&&S.visible).length;return x.filter(S=>S.visible).slice(...h?[j+1]:[0,j]).reduce((S,k)=>S+(k.height||0)+w,0)},[t]);return K.useEffect(()=>{t.forEach(v=>{if(v.dismissed)i(v.id,v.removeDelay);else{let g=f.get(v.id);g&&(clearTimeout(g),f.delete(v.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:d,startPause:n,endPause:b,calculateOffset:p}}},es=Me`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ts=Me`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,rs=Me`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ss=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${es} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ts} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${rs} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,as=Me`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ns=Ve("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${as} 1s linear infinite;
`,is=Me`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,os=Me`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ls=Ve("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${is} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${os} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,cs=Ve("div")`
  position: absolute;
`,ds=Ve("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,us=Me`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,hs=Ve("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${us} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,fs=({toast:r})=>{let{icon:c,type:t,iconTheme:u}=r;return c!==void 0?typeof c=="string"?K.createElement(hs,null,c):c:t==="blank"?null:K.createElement(ds,null,K.createElement(ns,{...u}),t!=="loading"&&K.createElement(cs,null,t==="error"?K.createElement(ss,{...u}):K.createElement(ls,{...u})))},ms=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ps=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,xs="0%{opacity:0;} 100%{opacity:1;}",gs="0%{opacity:1;} 100%{opacity:0;}",bs=Ve("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ys=Ve("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,vs=(r,c)=>{let t=r.includes("top")?1:-1,[u,f]=sr()?[xs,gs]:[ms(t),ps(t)];return{animation:c?`${Me(u)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Me(f)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},ws=K.memo(({toast:r,position:c,style:t,children:u})=>{let f=r.height?vs(r.position||c||"top-center",r.visible):{opacity:0},i=K.createElement(fs,{toast:r}),s=K.createElement(ys,{...r.ariaProps},ut(r.message,r));return K.createElement(bs,{className:r.className,style:{...f,...t,...r.style}},typeof u=="function"?u({icon:i,message:s}):K.createElement(K.Fragment,null,i,s))});Zr(K.createElement);var _s=({id:r,className:c,style:t,onHeightUpdate:u,children:f})=>{let i=K.useCallback(s=>{if(s){let n=()=>{let d=s.getBoundingClientRect().height;u(r,d)};n(),new MutationObserver(n).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[r,u]);return K.createElement("div",{ref:i,className:c,style:t},f)},js=(r,c)=>{let t=r.includes("top"),u=t?{top:0}:{bottom:0},f=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:sr()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${c*(t?1:-1)}px)`,...u,...f}},Ns=mt`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ct=16,ks=({reverseOrder:r,position:c="top-center",toastOptions:t,gutter:u,children:f,toasterId:i,containerStyle:s,containerClassName:n})=>{let{toasts:d,handlers:b}=Qr(t,i);return K.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:ct,left:ct,right:ct,bottom:ct,pointerEvents:"none",...s},className:n,onMouseEnter:b.startPause,onMouseLeave:b.endPause},d.map(p=>{let v=p.position||c,g=b.calculateOffset(p,{reverseOrder:r,gutter:u,defaultPosition:c}),h=js(v,g);return K.createElement(_s,{id:p.id,key:p.id,onHeightUpdate:b.updateHeight,className:p.visible?Ns:"",style:h},p.type==="custom"?ut(p.message,p):f?f(p):K.createElement(ws,{toast:p,position:v}))}))},ue=Ce;const bt="http://localhost:5000/api",Ss=({workspaceId:r,costEstimation:c,selectedProvider:t,onNext:u,onBack:f,costIntent:i,onFeedbackSubmitted:s})=>{const[n,d]=K.useState(null),[b,p]=K.useState(!1),v=async()=>{var g;if(!n){ue.error("Please select an option");return}p(!0);try{const h=(g=c.provider_details)==null?void 0:g[t],w=(h==null?void 0:h.cost_range)||{min:0,max:0};let o="cost_effective";if(c.cost_profile)o=c.cost_profile;else if(c.selected_profile)o=c.selected_profile;else if(c.scenarios){const m=h==null?void 0:h.total_monthly_cost;for(const[j,S]of Object.entries(c.scenarios)){const k=S[t];if(k&&m){const A=k.monthly_cost||k.estimated_cost;if(A&&Math.abs(m-A)<.01){o=j;break}}}}o==="costeffective"||o==="cost_effective"||o==="costEffective"?o="cost_effective":o==="highperformance"||o==="high_performance"||o==="highPerformance"?o="high_performance":o==="standard"||o==="Standard"?o="standard":o="cost_effective";const x=bt.endsWith("/")?bt.slice(0,-1):bt;try{await Be.post(`${x}/feedback`,{workspace_id:r,cost_intent:(i==null?void 0:i.type)||"startup",estimated_min:w.min||0,estimated_max:w.max||0,selected_provider:t,selected_profile:o,user_feedback:n}),ue.success("Feedback recorded"),s&&s()}catch(m){console.warn("Feedback failed (non-blocking):",m),ue.success("Proceeding to code generation..."),s&&s()}u()}catch(h){console.error("Feedback submission error:",h),ue.error("Failed to submit feedback")}finally{p(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"One Quick Question"}),e.jsx("p",{className:"text-gray-400",children:"Before we generate your Terraform code, help us calibrate our estimator."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-6 text-center",children:"Is this cost estimate within your expected budget?"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("button",{onClick:()=>d("within_budget"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="within_budget"?"bg-green-500/10 border-green-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"Yes, it looks reasonable"}),n==="within_budget"&&e.jsx("span",{className:"material-icons text-green-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("slightly_high"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="slightly_high"?"bg-yellow-500/10 border-yellow-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"It's a bit higher than expected"}),n==="slightly_high"&&e.jsx("span",{className:"material-icons text-yellow-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("too_high"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="too_high"?"bg-red-500/10 border-red-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"No, it's significantly too high"}),n==="too_high"&&e.jsx("span",{className:"material-icons text-red-500",children:"check_circle"})]}),e.jsxs("button",{onClick:()=>d("unknown"),className:`p-4 rounded-xl border flex items-center justify-between transition-all ${n==="unknown"?"bg-blue-500/10 border-blue-500 text-white":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"font-medium",children:"I'm not sure / I have no baseline"}),n==="unknown"&&e.jsx("span",{className:"material-icons text-blue-500",children:"check_circle"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Estimate"})]}),e.jsx("button",{onClick:v,disabled:!n||b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Generate Terraform"}),e.jsx("span",{className:"material-icons",children:"code"})]})})]})]})};var lr={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,c){(function(t){r.exports=t()})(function(){return function t(u,f,i){function s(b,p){if(!f[b]){if(!u[b]){var v=typeof lt=="function"&&lt;if(!p&&v)return v(b,!0);if(n)return n(b,!0);var g=new Error("Cannot find module '"+b+"'");throw g.code="MODULE_NOT_FOUND",g}var h=f[b]={exports:{}};u[b][0].call(h.exports,function(w){var o=u[b][1][w];return s(o||w)},h,h.exports,t,u,f,i)}return f[b].exports}for(var n=typeof lt=="function"&&lt,d=0;d<i.length;d++)s(i[d]);return s}({1:[function(t,u,f){var i=t("./utils"),s=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(d){for(var b,p,v,g,h,w,o,x=[],m=0,j=d.length,S=j,k=i.getTypeOf(d)!=="string";m<d.length;)S=j-m,v=k?(b=d[m++],p=m<j?d[m++]:0,m<j?d[m++]:0):(b=d.charCodeAt(m++),p=m<j?d.charCodeAt(m++):0,m<j?d.charCodeAt(m++):0),g=b>>2,h=(3&b)<<4|p>>4,w=1<S?(15&p)<<2|v>>6:64,o=2<S?63&v:64,x.push(n.charAt(g)+n.charAt(h)+n.charAt(w)+n.charAt(o));return x.join("")},f.decode=function(d){var b,p,v,g,h,w,o=0,x=0,m="data:";if(d.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var j,S=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===n.charAt(64)&&S--,d.charAt(d.length-2)===n.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(j=s.uint8array?new Uint8Array(0|S):new Array(0|S);o<d.length;)b=n.indexOf(d.charAt(o++))<<2|(g=n.indexOf(d.charAt(o++)))>>4,p=(15&g)<<4|(h=n.indexOf(d.charAt(o++)))>>2,v=(3&h)<<6|(w=n.indexOf(d.charAt(o++))),j[x++]=b,h!==64&&(j[x++]=p),w!==64&&(j[x++]=v);return j}},{"./support":30,"./utils":32}],2:[function(t,u,f){var i=t("./external"),s=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function b(p,v,g,h,w){this.compressedSize=p,this.uncompressedSize=v,this.crc32=g,this.compression=h,this.compressedContent=w}b.prototype={getContentWorker:function(){var p=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),v=this;return p.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(p,v,g){return p.pipe(new n).pipe(new d("uncompressedSize")).pipe(v.compressWorker(g)).pipe(new d("compressedSize")).withStreamInfo("compression",v)},u.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,u,f){var i=t("./stream/GenericWorker");f.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},f.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,u,f){var i=t("./utils"),s=function(){for(var n,d=[],b=0;b<256;b++){n=b;for(var p=0;p<8;p++)n=1&n?3988292384^n>>>1:n>>>1;d[b]=n}return d}();u.exports=function(n,d){return n!==void 0&&n.length?i.getTypeOf(n)!=="string"?function(b,p,v,g){var h=s,w=g+v;b^=-1;for(var o=g;o<w;o++)b=b>>>8^h[255&(b^p[o])];return-1^b}(0|d,n,n.length,0):function(b,p,v,g){var h=s,w=g+v;b^=-1;for(var o=g;o<w;o++)b=b>>>8^h[255&(b^p.charCodeAt(o))];return-1^b}(0|d,n,n.length,0):0}},{"./utils":32}],5:[function(t,u,f){f.base64=!1,f.binary=!1,f.dir=!1,f.createFolders=!0,f.date=null,f.compression=null,f.compressionOptions=null,f.comment=null,f.unixPermissions=null,f.dosPermissions=null},{}],6:[function(t,u,f){var i=null;i=typeof Promise<"u"?Promise:t("lie"),u.exports={Promise:i}},{lie:37}],7:[function(t,u,f){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),n=t("./utils"),d=t("./stream/GenericWorker"),b=i?"uint8array":"array";function p(v,g){d.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=g,this.meta={}}f.magic="\b\0",n.inherits(p,d),p.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(b,v.data),!1)},p.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(g){v.push({data:g,meta:v.meta})}},f.compressWorker=function(v){return new p("Deflate",v)},f.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,u,f){function i(h,w){var o,x="";for(o=0;o<w;o++)x+=String.fromCharCode(255&h),h>>>=8;return x}function s(h,w,o,x,m,j){var S,k,A=h.file,D=h.compression,B=j!==b.utf8encode,E=n.transformTo("string",j(A.name)),T=n.transformTo("string",b.utf8encode(A.name)),H=A.comment,Y=n.transformTo("string",j(H)),N=n.transformTo("string",b.utf8encode(H)),O=T.length!==A.name.length,l=N.length!==H.length,P="",Q="",M="",se=A.dir,W=A.date,ae={crc32:0,compressedSize:0,uncompressedSize:0};w&&!o||(ae.crc32=h.crc32,ae.compressedSize=h.compressedSize,ae.uncompressedSize=h.uncompressedSize);var R=0;w&&(R|=8),B||!O&&!l||(R|=2048);var z=0,ee=0;se&&(z|=16),m==="UNIX"?(ee=798,z|=function(G,me){var be=G;return G||(be=me?16893:33204),(65535&be)<<16}(A.unixPermissions,se)):(ee=20,z|=function(G){return 63&(G||0)}(A.dosPermissions)),S=W.getUTCHours(),S<<=6,S|=W.getUTCMinutes(),S<<=5,S|=W.getUTCSeconds()/2,k=W.getUTCFullYear()-1980,k<<=4,k|=W.getUTCMonth()+1,k<<=5,k|=W.getUTCDate(),O&&(Q=i(1,1)+i(p(E),4)+T,P+="up"+i(Q.length,2)+Q),l&&(M=i(1,1)+i(p(Y),4)+N,P+="uc"+i(M.length,2)+M);var X="";return X+=`
\0`,X+=i(R,2),X+=D.magic,X+=i(S,2),X+=i(k,2),X+=i(ae.crc32,4),X+=i(ae.compressedSize,4),X+=i(ae.uncompressedSize,4),X+=i(E.length,2),X+=i(P.length,2),{fileRecord:v.LOCAL_FILE_HEADER+X+E+P,dirRecord:v.CENTRAL_FILE_HEADER+i(ee,2)+X+i(Y.length,2)+"\0\0\0\0"+i(z,4)+i(x,4)+E+P+Y}}var n=t("../utils"),d=t("../stream/GenericWorker"),b=t("../utf8"),p=t("../crc32"),v=t("../signature");function g(h,w,o,x){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=o,this.encodeFileName=x,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(g,d),g.prototype.push=function(h){var w=h.meta.percent||0,o=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,d.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:o?(w+100*(o-x-1))/o:100}}))},g.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var w=this.streamFiles&&!h.file.dir;if(w){var o=s(h,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:o.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(h){this.accumulate=!1;var w=this.streamFiles&&!h.file.dir,o=s(h,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(o.dirRecord),w)this.push({data:function(x){return v.DATA_DESCRIPTOR+i(x.crc32,4)+i(x.compressedSize,4)+i(x.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:o.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var h=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var o=this.bytesWritten-h,x=function(m,j,S,k,A){var D=n.transformTo("string",A(k));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(m,2)+i(m,2)+i(j,4)+i(S,4)+i(D.length,2)+D}(this.dirRecords.length,o,h,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(h){this._sources.push(h);var w=this;return h.on("data",function(o){w.processChunk(o)}),h.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),h.on("error",function(o){w.error(o)}),this},g.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(h){var w=this._sources;if(!d.prototype.error.call(this,h))return!1;for(var o=0;o<w.length;o++)try{w[o].error(h)}catch{}return!0},g.prototype.lock=function(){d.prototype.lock.call(this);for(var h=this._sources,w=0;w<h.length;w++)h[w].lock()},u.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,u,f){var i=t("../compressions"),s=t("./ZipFileWorker");f.generateWorker=function(n,d,b){var p=new s(d.streamFiles,b,d.platform,d.encodeFileName),v=0;try{n.forEach(function(g,h){v++;var w=function(j,S){var k=j||S,A=i[k];if(!A)throw new Error(k+" is not a valid compression method !");return A}(h.options.compression,d.compression),o=h.options.compressionOptions||d.compressionOptions||{},x=h.dir,m=h.date;h._compressWorker(w,o).withStreamInfo("file",{name:g,dir:x,date:m,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(p)}),p.entriesCount=v}catch(g){p.error(g)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,u,f){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var n in this)typeof this[n]!="function"&&(s[n]=this[n]);return s}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(s,n){return new i().loadAsync(s,n)},i.external=t("./external"),u.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,u,f){var i=t("./utils"),s=t("./external"),n=t("./utf8"),d=t("./zipEntries"),b=t("./stream/Crc32Probe"),p=t("./nodejsUtils");function v(g){return new s.Promise(function(h,w){var o=g.decompressed.getContentWorker().pipe(new b);o.on("error",function(x){w(x)}).on("end",function(){o.streamInfo.crc32!==g.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}u.exports=function(g,h){var w=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),p.isNode&&p.isStream(g)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",g,!0,h.optimizedBinaryString,h.base64).then(function(o){var x=new d(h);return x.load(o),x}).then(function(o){var x=[s.Promise.resolve(o)],m=o.files;if(h.checkCRC32)for(var j=0;j<m.length;j++)x.push(v(m[j]));return s.Promise.all(x)}).then(function(o){for(var x=o.shift(),m=x.files,j=0;j<m.length;j++){var S=m[j],k=S.fileNameStr,A=i.resolve(S.fileNameStr);w.file(A,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:h.createFolders}),S.dir||(w.file(A).unsafeOriginalName=k)}return x.zipComment.length&&(w.comment=x.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,u,f){var i=t("../utils"),s=t("../stream/GenericWorker");function n(d,b){s.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(b)}i.inherits(n,s),n.prototype._bindStream=function(d){var b=this;(this._stream=d).pause(),d.on("data",function(p){b.push({data:p,meta:{percent:0}})}).on("error",function(p){b.isPaused?this.generatedError=p:b.error(p)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},n.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,u,f){var i=t("readable-stream").Readable;function s(n,d,b){i.call(this,d),this._helper=n;var p=this;n.on("data",function(v,g){p.push(v)||p._helper.pause(),b&&b(g)}).on("error",function(v){p.emit("error",v)}).on("end",function(){p.push(null)})}t("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},u.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,u,f){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,u,f){function i(A,D,B){var E,T=n.getTypeOf(D),H=n.extend(B||{},p);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(A=m(A)),H.createFolders&&(E=x(A))&&j.call(this,E,!0);var Y=T==="string"&&H.binary===!1&&H.base64===!1;B&&B.binary!==void 0||(H.binary=!Y),(D instanceof v&&D.uncompressedSize===0||H.dir||!D||D.length===0)&&(H.base64=!1,H.binary=!0,D="",H.compression="STORE",T="string");var N=null;N=D instanceof v||D instanceof d?D:w.isNode&&w.isStream(D)?new o(A,D):n.prepareContent(A,D,H.binary,H.optimizedBinaryString,H.base64);var O=new g(A,N,H);this.files[A]=O}var s=t("./utf8"),n=t("./utils"),d=t("./stream/GenericWorker"),b=t("./stream/StreamHelper"),p=t("./defaults"),v=t("./compressedObject"),g=t("./zipObject"),h=t("./generate"),w=t("./nodejsUtils"),o=t("./nodejs/NodejsStreamInputAdapter"),x=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var D=A.lastIndexOf("/");return 0<D?A.substring(0,D):""},m=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},j=function(A,D){return D=D!==void 0?D:p.createFolders,A=m(A),this.files[A]||i.call(this,A,null,{dir:!0,createFolders:D}),this.files[A]};function S(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var D,B,E;for(D in this.files)E=this.files[D],(B=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&A(B,E)},filter:function(A){var D=[];return this.forEach(function(B,E){A(B,E)&&D.push(E)}),D},file:function(A,D,B){if(arguments.length!==1)return A=this.root+A,i.call(this,A,D,B),this;if(S(A)){var E=A;return this.filter(function(H,Y){return!Y.dir&&E.test(H)})}var T=this.files[this.root+A];return T&&!T.dir?T:null},folder:function(A){if(!A)return this;if(S(A))return this.filter(function(T,H){return H.dir&&A.test(T)});var D=this.root+A,B=j.call(this,D),E=this.clone();return E.root=B.name,E},remove:function(A){A=this.root+A;var D=this.files[A];if(D||(A.slice(-1)!=="/"&&(A+="/"),D=this.files[A]),D&&!D.dir)delete this.files[A];else for(var B=this.filter(function(T,H){return H.name.slice(0,A.length)===A}),E=0;E<B.length;E++)delete this.files[B[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var D,B={};try{if((B=n.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=B.type.toLowerCase(),B.compression=B.compression.toUpperCase(),B.type==="binarystring"&&(B.type="string"),!B.type)throw new Error("No output type specified.");n.checkSupport(B.type),B.platform!=="darwin"&&B.platform!=="freebsd"&&B.platform!=="linux"&&B.platform!=="sunos"||(B.platform="UNIX"),B.platform==="win32"&&(B.platform="DOS");var E=B.comment||this.comment||"";D=h.generateWorker(this,B,E)}catch(T){(D=new d("error")).error(T)}return new b(D,B.type||"string",B.mimeType)},generateAsync:function(A,D){return this.generateInternalStream(A).accumulate(D)},generateNodeStream:function(A,D){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(D)}};u.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,u,f){u.exports=t("stream")},{stream:void 0}],17:[function(t,u,f){var i=t("./DataReader");function s(n){i.call(this,n);for(var d=0;d<this.data.length;d++)n[d]=255&n[d]}t("../utils").inherits(s,i),s.prototype.byteAt=function(n){return this.data[this.zero+n]},s.prototype.lastIndexOfSignature=function(n){for(var d=n.charCodeAt(0),b=n.charCodeAt(1),p=n.charCodeAt(2),v=n.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===d&&this.data[g+1]===b&&this.data[g+2]===p&&this.data[g+3]===v)return g-this.zero;return-1},s.prototype.readAndCheckSignature=function(n){var d=n.charCodeAt(0),b=n.charCodeAt(1),p=n.charCodeAt(2),v=n.charCodeAt(3),g=this.readData(4);return d===g[0]&&b===g[1]&&p===g[2]&&v===g[3]},s.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,u,f){var i=t("../utils");function s(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var d,b=0;for(this.checkOffset(n),d=this.index+n-1;d>=this.index;d--)b=(b<<8)+this.byteAt(d);return this.index+=n,b},readString:function(n){return i.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},u.exports=s},{"../utils":32}],19:[function(t,u,f){var i=t("./Uint8ArrayReader");function s(n){i.call(this,n)}t("../utils").inherits(s,i),s.prototype.readData=function(n){this.checkOffset(n);var d=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,u,f){var i=t("./DataReader");function s(n){i.call(this,n)}t("../utils").inherits(s,i),s.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},s.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},s.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},s.prototype.readData=function(n){this.checkOffset(n);var d=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,u,f){var i=t("./ArrayReader");function s(n){i.call(this,n)}t("../utils").inherits(s,i),s.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,d},u.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,u,f){var i=t("../utils"),s=t("../support"),n=t("./ArrayReader"),d=t("./StringReader"),b=t("./NodeBufferReader"),p=t("./Uint8ArrayReader");u.exports=function(v){var g=i.getTypeOf(v);return i.checkSupport(g),g!=="string"||s.uint8array?g==="nodebuffer"?new b(v):s.uint8array?new p(i.transformTo("uint8array",v)):new n(i.transformTo("array",v)):new d(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,u,f){f.LOCAL_FILE_HEADER="PK",f.CENTRAL_FILE_HEADER="PK",f.CENTRAL_DIRECTORY_END="PK",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",f.ZIP64_CENTRAL_DIRECTORY_END="PK",f.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,u,f){var i=t("./GenericWorker"),s=t("../utils");function n(d){i.call(this,"ConvertWorker to "+d),this.destType=d}s.inherits(n,i),n.prototype.processChunk=function(d){this.push({data:s.transformTo(this.destType,d.data),meta:d.meta})},u.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,u,f){var i=t("./GenericWorker"),s=t("../crc32");function n(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,i),n.prototype.processChunk=function(d){this.streamInfo.crc32=s(d.data,this.streamInfo.crc32||0),this.push(d)},u.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,u,f){var i=t("../utils"),s=t("./GenericWorker");function n(d){s.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(n,s),n.prototype.processChunk=function(d){if(d){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+d.data.length}s.prototype.processChunk.call(this,d)},u.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,u,f){var i=t("../utils"),s=t("./GenericWorker");function n(d){s.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(p){b.dataIsReady=!0,b.data=p,b.max=p&&p.length||0,b.type=i.getTypeOf(p),b.isPaused||b._tickAndRepeat()},function(p){b.error(p)})}i.inherits(n,s),n.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,b);break;case"uint8array":d=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":d=this.data.slice(this.index,b)}return this.index=b,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,u,f){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,n){return this._listeners[s].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,n){if(this._listeners[s])for(var d=0;d<this._listeners[s].length;d++)this._listeners[s][d].call(this,n)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var n=this;return s.on("data",function(d){n.processChunk(d)}),s.on("end",function(){n.end()}),s.on("error",function(d){n.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,n){return this.extraStreamInfo[s]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},u.exports=i},{}],29:[function(t,u,f){var i=t("../utils"),s=t("./ConvertWorker"),n=t("./GenericWorker"),d=t("../base64"),b=t("../support"),p=t("../external"),v=null;if(b.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(w,o){return new p.Promise(function(x,m){var j=[],S=w._internalType,k=w._outputType,A=w._mimeType;w.on("data",function(D,B){j.push(D),o&&o(B)}).on("error",function(D){j=[],m(D)}).on("end",function(){try{var D=function(B,E,T){switch(B){case"blob":return i.newBlob(i.transformTo("arraybuffer",E),T);case"base64":return d.encode(E);default:return i.transformTo(B,E)}}(k,function(B,E){var T,H=0,Y=null,N=0;for(T=0;T<E.length;T++)N+=E[T].length;switch(B){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(Y=new Uint8Array(N),T=0;T<E.length;T++)Y.set(E[T],H),H+=E[T].length;return Y;case"nodebuffer":return Buffer.concat(E);default:throw new Error("concat : unsupported type '"+B+"'")}}(S,j),A);x(D)}catch(B){m(B)}j=[]}).resume()})}function h(w,o,x){var m=o;switch(o){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=o,this._mimeType=x,i.checkSupport(m),this._worker=w.pipe(new s(m)),w.lock()}catch(j){this._worker=new n("error"),this._worker.error(j)}}h.prototype={accumulate:function(w){return g(this,w)},on:function(w,o){var x=this;return w==="data"?this._worker.on(w,function(m){o.call(x,m.data,m.meta)}):this._worker.on(w,function(){i.delay(o,arguments,x)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},w)}},u.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,u,f){if(f.base64=!0,f.array=!0,f.string=!0,f.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",f.nodebuffer=typeof Buffer<"u",f.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")f.blob=!1;else{var i=new ArrayBuffer(0);try{f.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),f.blob=s.getBlob("application/zip").size===0}catch{f.blob=!1}}}try{f.nodestream=!!t("readable-stream").Readable}catch{f.nodestream=!1}},{"readable-stream":16}],31:[function(t,u,f){for(var i=t("./utils"),s=t("./support"),n=t("./nodejsUtils"),d=t("./stream/GenericWorker"),b=new Array(256),p=0;p<256;p++)b[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;b[254]=b[254]=1;function v(){d.call(this,"utf-8 decode"),this.leftOver=null}function g(){d.call(this,"utf-8 encode")}f.utf8encode=function(h){return s.nodebuffer?n.newBufferFrom(h,"utf-8"):function(w){var o,x,m,j,S,k=w.length,A=0;for(j=0;j<k;j++)(64512&(x=w.charCodeAt(j)))==55296&&j+1<k&&(64512&(m=w.charCodeAt(j+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),j++),A+=x<128?1:x<2048?2:x<65536?3:4;for(o=s.uint8array?new Uint8Array(A):new Array(A),j=S=0;S<A;j++)(64512&(x=w.charCodeAt(j)))==55296&&j+1<k&&(64512&(m=w.charCodeAt(j+1)))==56320&&(x=65536+(x-55296<<10)+(m-56320),j++),x<128?o[S++]=x:(x<2048?o[S++]=192|x>>>6:(x<65536?o[S++]=224|x>>>12:(o[S++]=240|x>>>18,o[S++]=128|x>>>12&63),o[S++]=128|x>>>6&63),o[S++]=128|63&x);return o}(h)},f.utf8decode=function(h){return s.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(w){var o,x,m,j,S=w.length,k=new Array(2*S);for(o=x=0;o<S;)if((m=w[o++])<128)k[x++]=m;else if(4<(j=b[m]))k[x++]=65533,o+=j-1;else{for(m&=j===2?31:j===3?15:7;1<j&&o<S;)m=m<<6|63&w[o++],j--;1<j?k[x++]=65533:m<65536?k[x++]=m:(m-=65536,k[x++]=55296|m>>10&1023,k[x++]=56320|1023&m)}return k.length!==x&&(k.subarray?k=k.subarray(0,x):k.length=x),i.applyFromCharCode(k)}(h=i.transformTo(s.uint8array?"uint8array":"array",h))},i.inherits(v,d),v.prototype.processChunk=function(h){var w=i.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var o=w;(w=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),w.set(o,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var x=function(j,S){var k;for((S=S||j.length)>j.length&&(S=j.length),k=S-1;0<=k&&(192&j[k])==128;)k--;return k<0||k===0?S:k+b[j[k]]>S?k:S}(w),m=w;x!==w.length&&(s.uint8array?(m=w.subarray(0,x),this.leftOver=w.subarray(x,w.length)):(m=w.slice(0,x),this.leftOver=w.slice(x,w.length))),this.push({data:f.utf8decode(m),meta:h.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:f.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},f.Utf8DecodeWorker=v,i.inherits(g,d),g.prototype.processChunk=function(h){this.push({data:f.utf8encode(h.data),meta:h.meta})},f.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,u,f){var i=t("./support"),s=t("./base64"),n=t("./nodejsUtils"),d=t("./external");function b(o){return o}function p(o,x){for(var m=0;m<o.length;++m)x[m]=255&o.charCodeAt(m);return x}t("setimmediate"),f.newBlob=function(o,x){f.checkSupport("blob");try{return new Blob([o],{type:x})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(o),m.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(o,x,m){var j=[],S=0,k=o.length;if(k<=m)return String.fromCharCode.apply(null,o);for(;S<k;)x==="array"||x==="nodebuffer"?j.push(String.fromCharCode.apply(null,o.slice(S,Math.min(S+m,k)))):j.push(String.fromCharCode.apply(null,o.subarray(S,Math.min(S+m,k)))),S+=m;return j.join("")},stringifyByChar:function(o){for(var x="",m=0;m<o.length;m++)x+=String.fromCharCode(o[m]);return x},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function g(o){var x=65536,m=f.getTypeOf(o),j=!0;if(m==="uint8array"?j=v.applyCanBeUsed.uint8array:m==="nodebuffer"&&(j=v.applyCanBeUsed.nodebuffer),j)for(;1<x;)try{return v.stringifyByChunk(o,m,x)}catch{x=Math.floor(x/2)}return v.stringifyByChar(o)}function h(o,x){for(var m=0;m<o.length;m++)x[m]=o[m];return x}f.applyFromCharCode=g;var w={};w.string={string:b,array:function(o){return p(o,new Array(o.length))},arraybuffer:function(o){return w.string.uint8array(o).buffer},uint8array:function(o){return p(o,new Uint8Array(o.length))},nodebuffer:function(o){return p(o,n.allocBuffer(o.length))}},w.array={string:g,array:b,arraybuffer:function(o){return new Uint8Array(o).buffer},uint8array:function(o){return new Uint8Array(o)},nodebuffer:function(o){return n.newBufferFrom(o)}},w.arraybuffer={string:function(o){return g(new Uint8Array(o))},array:function(o){return h(new Uint8Array(o),new Array(o.byteLength))},arraybuffer:b,uint8array:function(o){return new Uint8Array(o)},nodebuffer:function(o){return n.newBufferFrom(new Uint8Array(o))}},w.uint8array={string:g,array:function(o){return h(o,new Array(o.length))},arraybuffer:function(o){return o.buffer},uint8array:b,nodebuffer:function(o){return n.newBufferFrom(o)}},w.nodebuffer={string:g,array:function(o){return h(o,new Array(o.length))},arraybuffer:function(o){return w.nodebuffer.uint8array(o).buffer},uint8array:function(o){return h(o,new Uint8Array(o.length))},nodebuffer:b},f.transformTo=function(o,x){if(x=x||"",!o)return x;f.checkSupport(o);var m=f.getTypeOf(x);return w[m][o](x)},f.resolve=function(o){for(var x=o.split("/"),m=[],j=0;j<x.length;j++){var S=x[j];S==="."||S===""&&j!==0&&j!==x.length-1||(S===".."?m.pop():m.push(S))}return m.join("/")},f.getTypeOf=function(o){return typeof o=="string"?"string":Object.prototype.toString.call(o)==="[object Array]"?"array":i.nodebuffer&&n.isBuffer(o)?"nodebuffer":i.uint8array&&o instanceof Uint8Array?"uint8array":i.arraybuffer&&o instanceof ArrayBuffer?"arraybuffer":void 0},f.checkSupport=function(o){if(!i[o.toLowerCase()])throw new Error(o+" is not supported by this platform")},f.MAX_VALUE_16BITS=65535,f.MAX_VALUE_32BITS=-1,f.pretty=function(o){var x,m,j="";for(m=0;m<(o||"").length;m++)j+="\\x"+((x=o.charCodeAt(m))<16?"0":"")+x.toString(16).toUpperCase();return j},f.delay=function(o,x,m){setImmediate(function(){o.apply(m||null,x||[])})},f.inherits=function(o,x){function m(){}m.prototype=x.prototype,o.prototype=new m},f.extend=function(){var o,x,m={};for(o=0;o<arguments.length;o++)for(x in arguments[o])Object.prototype.hasOwnProperty.call(arguments[o],x)&&m[x]===void 0&&(m[x]=arguments[o][x]);return m},f.prepareContent=function(o,x,m,j,S){return d.Promise.resolve(x).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new d.Promise(function(A,D){var B=new FileReader;B.onload=function(E){A(E.target.result)},B.onerror=function(E){D(E.target.error)},B.readAsArrayBuffer(k)}):k}).then(function(k){var A=f.getTypeOf(k);return A?(A==="arraybuffer"?k=f.transformTo("uint8array",k):A==="string"&&(S?k=s.decode(k):m&&j!==!0&&(k=function(D){return p(D,i.uint8array?new Uint8Array(D.length):new Array(D.length))}(k))),k):d.Promise.reject(new Error("Can't read the data of '"+o+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,u,f){var i=t("./reader/readerFor"),s=t("./utils"),n=t("./signature"),d=t("./zipEntry"),b=t("./support");function p(v){this.files=[],this.loadOptions=v}p.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(g)+", expected "+s.pretty(v)+")")}},isSignature:function(v,g){var h=this.reader.index;this.reader.setIndex(v);var w=this.reader.readString(4)===g;return this.reader.setIndex(h),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),g=b.uint8array?"uint8array":"array",h=s.transformTo(g,v);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,g,h,w=this.zip64EndOfCentralSize-44;0<w;)v=this.reader.readInt(2),g=this.reader.readInt(4),h=this.reader.readData(g),this.zip64ExtensibleData[v]={id:v,length:g,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,g;for(v=0;v<this.files.length;v++)g=this.files[v],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(v=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var g=v;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var w=g-h;if(0<w)this.isSignature(g,n.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(v){this.reader=i(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,u,f){var i=t("./reader/readerFor"),s=t("./utils"),n=t("./compressedObject"),d=t("./crc32"),b=t("./utf8"),p=t("./compressions"),v=t("./support");function g(h,w){this.options=h,this.loadOptions=w}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var w,o;if(h.skip(22),this.fileNameLength=h.readInt(2),o=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(o),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(x){for(var m in p)if(Object.prototype.hasOwnProperty.call(p,m)&&p[m].magic===x)return p[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,w,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var w=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(w),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var w,o,x,m=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<m;)w=h.readInt(2),o=h.readInt(2),x=h.readData(o),this.extraFields[w]={id:w,length:o,value:x};h.setIndex(m)},handleUTF8:function(){var h=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var o=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(o)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var m=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var w=i(h.value);return w.readInt(1)!==1||d(this.fileName)!==w.readInt(4)?null:b.utf8decode(w.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var w=i(h.value);return w.readInt(1)!==1||d(this.fileComment)!==w.readInt(4)?null:b.utf8decode(w.readData(h.length-5))}return null}},u.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,u,f){function i(w,o,x){this.name=w,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=o,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var s=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),d=t("./utf8"),b=t("./compressedObject"),p=t("./stream/GenericWorker");i.prototype={internalStream:function(w){var o=null,x="string";try{if(!w)throw new Error("No output type specified.");var m=(x=w.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),o=this._decompressWorker();var j=!this._dataBinary;j&&!m&&(o=o.pipe(new d.Utf8EncodeWorker)),!j&&m&&(o=o.pipe(new d.Utf8DecodeWorker))}catch(S){(o=new p("error")).error(S)}return new s(o,x,"")},async:function(w,o){return this.internalStream(w).accumulate(o)},nodeStream:function(w,o){return this.internalStream(w||"nodebuffer").toNodejsStream(o)},_compressWorker:function(w,o){if(this._data instanceof b&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new d.Utf8EncodeWorker)),b.createWorkerFrom(x,w,o)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof p?this._data:new n(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<v.length;h++)i.prototype[v[h]]=g;u.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,u,f){(function(i){var s,n,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var b=0,p=new d(w),v=i.document.createTextNode("");p.observe(v,{characterData:!0}),s=function(){v.data=b=++b%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var o=i.document.createElement("script");o.onreadystatechange=function(){w(),o.onreadystatechange=null,o.parentNode.removeChild(o),o=null},i.document.documentElement.appendChild(o)}:function(){setTimeout(w,0)};else{var g=new i.MessageChannel;g.port1.onmessage=w,s=function(){g.port2.postMessage(0)}}var h=[];function w(){var o,x;n=!0;for(var m=h.length;m;){for(x=h,h=[],o=-1;++o<m;)x[o]();m=h.length}n=!1}u.exports=function(o){h.push(o)!==1||n||s()}}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,u,f){var i=t("immediate");function s(){}var n={},d=["REJECTED"],b=["FULFILLED"],p=["PENDING"];function v(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,m!==s&&o(this,m)}function g(m,j,S){this.promise=m,typeof j=="function"&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function h(m,j,S){i(function(){var k;try{k=j(S)}catch(A){return n.reject(m,A)}k===m?n.reject(m,new TypeError("Cannot resolve promise with itself")):n.resolve(m,k)})}function w(m){var j=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof j=="function")return function(){j.apply(m,arguments)}}function o(m,j){var S=!1;function k(B){S||(S=!0,n.reject(m,B))}function A(B){S||(S=!0,n.resolve(m,B))}var D=x(function(){j(A,k)});D.status==="error"&&k(D.value)}function x(m,j){var S={};try{S.value=m(j),S.status="success"}catch(k){S.status="error",S.value=k}return S}(u.exports=v).prototype.finally=function(m){if(typeof m!="function")return this;var j=this.constructor;return this.then(function(S){return j.resolve(m()).then(function(){return S})},function(S){return j.resolve(m()).then(function(){throw S})})},v.prototype.catch=function(m){return this.then(null,m)},v.prototype.then=function(m,j){if(typeof m!="function"&&this.state===b||typeof j!="function"&&this.state===d)return this;var S=new this.constructor(s);return this.state!==p?h(S,this.state===b?m:j,this.outcome):this.queue.push(new g(S,m,j)),S},g.prototype.callFulfilled=function(m){n.resolve(this.promise,m)},g.prototype.otherCallFulfilled=function(m){h(this.promise,this.onFulfilled,m)},g.prototype.callRejected=function(m){n.reject(this.promise,m)},g.prototype.otherCallRejected=function(m){h(this.promise,this.onRejected,m)},n.resolve=function(m,j){var S=x(w,j);if(S.status==="error")return n.reject(m,S.value);var k=S.value;if(k)o(m,k);else{m.state=b,m.outcome=j;for(var A=-1,D=m.queue.length;++A<D;)m.queue[A].callFulfilled(j)}return m},n.reject=function(m,j){m.state=d,m.outcome=j;for(var S=-1,k=m.queue.length;++S<k;)m.queue[S].callRejected(j);return m},v.resolve=function(m){return m instanceof this?m:n.resolve(new this(s),m)},v.reject=function(m){var j=new this(s);return n.reject(j,m)},v.all=function(m){var j=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,k=!1;if(!S)return this.resolve([]);for(var A=new Array(S),D=0,B=-1,E=new this(s);++B<S;)T(m[B],B);return E;function T(H,Y){j.resolve(H).then(function(N){A[Y]=N,++D!==S||k||(k=!0,n.resolve(E,A))},function(N){k||(k=!0,n.reject(E,N))})}},v.race=function(m){var j=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,k=!1;if(!S)return this.resolve([]);for(var A=-1,D=new this(s);++A<S;)B=m[A],j.resolve(B).then(function(E){k||(k=!0,n.resolve(D,E))},function(E){k||(k=!0,n.reject(D,E))});var B;return D}},{immediate:36}],38:[function(t,u,f){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),u.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,u,f){var i=t("./zlib/deflate"),s=t("./utils/common"),n=t("./utils/strings"),d=t("./zlib/messages"),b=t("./zlib/zstream"),p=Object.prototype.toString,v=0,g=-1,h=0,w=8;function o(m){if(!(this instanceof o))return new o(m);this.options=s.assign({level:g,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},m||{});var j=this.options;j.raw&&0<j.windowBits?j.windowBits=-j.windowBits:j.gzip&&0<j.windowBits&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(S!==v)throw new Error(d[S]);if(j.header&&i.deflateSetHeader(this.strm,j.header),j.dictionary){var k;if(k=typeof j.dictionary=="string"?n.string2buf(j.dictionary):p.call(j.dictionary)==="[object ArrayBuffer]"?new Uint8Array(j.dictionary):j.dictionary,(S=i.deflateSetDictionary(this.strm,k))!==v)throw new Error(d[S]);this._dict_set=!0}}function x(m,j){var S=new o(j);if(S.push(m,!0),S.err)throw S.msg||d[S.err];return S.result}o.prototype.push=function(m,j){var S,k,A=this.strm,D=this.options.chunkSize;if(this.ended)return!1;k=j===~~j?j:j===!0?4:0,typeof m=="string"?A.input=n.string2buf(m):p.call(m)==="[object ArrayBuffer]"?A.input=new Uint8Array(m):A.input=m,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(D),A.next_out=0,A.avail_out=D),(S=i.deflate(A,k))!==1&&S!==v)return this.onEnd(S),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(s.shrinkBuf(A.output,A.next_out))):this.onData(s.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&S!==1);return k===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===v):k!==2||(this.onEnd(v),!(A.avail_out=0))},o.prototype.onData=function(m){this.chunks.push(m)},o.prototype.onEnd=function(m){m===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},f.Deflate=o,f.deflate=x,f.deflateRaw=function(m,j){return(j=j||{}).raw=!0,x(m,j)},f.gzip=function(m,j){return(j=j||{}).gzip=!0,x(m,j)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,u,f){var i=t("./zlib/inflate"),s=t("./utils/common"),n=t("./utils/strings"),d=t("./zlib/constants"),b=t("./zlib/messages"),p=t("./zlib/zstream"),v=t("./zlib/gzheader"),g=Object.prototype.toString;function h(o){if(!(this instanceof h))return new h(o);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},o||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||o&&o.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var m=i.inflateInit2(this.strm,x.windowBits);if(m!==d.Z_OK)throw new Error(b[m]);this.header=new v,i.inflateGetHeader(this.strm,this.header)}function w(o,x){var m=new h(x);if(m.push(o,!0),m.err)throw m.msg||b[m.err];return m.result}h.prototype.push=function(o,x){var m,j,S,k,A,D,B=this.strm,E=this.options.chunkSize,T=this.options.dictionary,H=!1;if(this.ended)return!1;j=x===~~x?x:x===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof o=="string"?B.input=n.binstring2buf(o):g.call(o)==="[object ArrayBuffer]"?B.input=new Uint8Array(o):B.input=o,B.next_in=0,B.avail_in=B.input.length;do{if(B.avail_out===0&&(B.output=new s.Buf8(E),B.next_out=0,B.avail_out=E),(m=i.inflate(B,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&T&&(D=typeof T=="string"?n.string2buf(T):g.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,m=i.inflateSetDictionary(this.strm,D)),m===d.Z_BUF_ERROR&&H===!0&&(m=d.Z_OK,H=!1),m!==d.Z_STREAM_END&&m!==d.Z_OK)return this.onEnd(m),!(this.ended=!0);B.next_out&&(B.avail_out!==0&&m!==d.Z_STREAM_END&&(B.avail_in!==0||j!==d.Z_FINISH&&j!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=n.utf8border(B.output,B.next_out),k=B.next_out-S,A=n.buf2string(B.output,S),B.next_out=k,B.avail_out=E-k,k&&s.arraySet(B.output,B.output,S,k,0),this.onData(A)):this.onData(s.shrinkBuf(B.output,B.next_out)))),B.avail_in===0&&B.avail_out===0&&(H=!0)}while((0<B.avail_in||B.avail_out===0)&&m!==d.Z_STREAM_END);return m===d.Z_STREAM_END&&(j=d.Z_FINISH),j===d.Z_FINISH?(m=i.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===d.Z_OK):j!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(B.avail_out=0))},h.prototype.onData=function(o){this.chunks.push(o)},h.prototype.onEnd=function(o){o===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg},f.Inflate=h,f.inflate=w,f.inflateRaw=function(o,x){return(x=x||{}).raw=!0,w(o,x)},f.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,u,f){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";f.assign=function(d){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var p=b.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var v in p)p.hasOwnProperty(v)&&(d[v]=p[v])}}return d},f.shrinkBuf=function(d,b){return d.length===b?d:d.subarray?d.subarray(0,b):(d.length=b,d)};var s={arraySet:function(d,b,p,v,g){if(b.subarray&&d.subarray)d.set(b.subarray(p,p+v),g);else for(var h=0;h<v;h++)d[g+h]=b[p+h]},flattenChunks:function(d){var b,p,v,g,h,w;for(b=v=0,p=d.length;b<p;b++)v+=d[b].length;for(w=new Uint8Array(v),b=g=0,p=d.length;b<p;b++)h=d[b],w.set(h,g),g+=h.length;return w}},n={arraySet:function(d,b,p,v,g){for(var h=0;h<v;h++)d[g+h]=b[p+h]},flattenChunks:function(d){return[].concat.apply([],d)}};f.setTyped=function(d){d?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,s)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,n))},f.setTyped(i)},{}],42:[function(t,u,f){var i=t("./common"),s=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var d=new i.Buf8(256),b=0;b<256;b++)d[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function p(v,g){if(g<65537&&(v.subarray&&n||!v.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(v,g));for(var h="",w=0;w<g;w++)h+=String.fromCharCode(v[w]);return h}d[254]=d[254]=1,f.string2buf=function(v){var g,h,w,o,x,m=v.length,j=0;for(o=0;o<m;o++)(64512&(h=v.charCodeAt(o)))==55296&&o+1<m&&(64512&(w=v.charCodeAt(o+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),o++),j+=h<128?1:h<2048?2:h<65536?3:4;for(g=new i.Buf8(j),o=x=0;x<j;o++)(64512&(h=v.charCodeAt(o)))==55296&&o+1<m&&(64512&(w=v.charCodeAt(o+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),o++),h<128?g[x++]=h:(h<2048?g[x++]=192|h>>>6:(h<65536?g[x++]=224|h>>>12:(g[x++]=240|h>>>18,g[x++]=128|h>>>12&63),g[x++]=128|h>>>6&63),g[x++]=128|63&h);return g},f.buf2binstring=function(v){return p(v,v.length)},f.binstring2buf=function(v){for(var g=new i.Buf8(v.length),h=0,w=g.length;h<w;h++)g[h]=v.charCodeAt(h);return g},f.buf2string=function(v,g){var h,w,o,x,m=g||v.length,j=new Array(2*m);for(h=w=0;h<m;)if((o=v[h++])<128)j[w++]=o;else if(4<(x=d[o]))j[w++]=65533,h+=x-1;else{for(o&=x===2?31:x===3?15:7;1<x&&h<m;)o=o<<6|63&v[h++],x--;1<x?j[w++]=65533:o<65536?j[w++]=o:(o-=65536,j[w++]=55296|o>>10&1023,j[w++]=56320|1023&o)}return p(j,w)},f.utf8border=function(v,g){var h;for((g=g||v.length)>v.length&&(g=v.length),h=g-1;0<=h&&(192&v[h])==128;)h--;return h<0||h===0?g:h+d[v[h]]>g?h:g}},{"./common":41}],43:[function(t,u,f){u.exports=function(i,s,n,d){for(var b=65535&i|0,p=i>>>16&65535|0,v=0;n!==0;){for(n-=v=2e3<n?2e3:n;p=p+(b=b+s[d++]|0)|0,--v;);b%=65521,p%=65521}return b|p<<16|0}},{}],44:[function(t,u,f){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,u,f){var i=function(){for(var s,n=[],d=0;d<256;d++){s=d;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;n[d]=s}return n}();u.exports=function(s,n,d,b){var p=i,v=b+d;s^=-1;for(var g=b;g<v;g++)s=s>>>8^p[255&(s^n[g])];return-1^s}},{}],46:[function(t,u,f){var i,s=t("../utils/common"),n=t("./trees"),d=t("./adler32"),b=t("./crc32"),p=t("./messages"),v=0,g=4,h=0,w=-2,o=-1,x=4,m=2,j=8,S=9,k=286,A=30,D=19,B=2*k+1,E=15,T=3,H=258,Y=H+T+1,N=42,O=113,l=1,P=2,Q=3,M=4;function se(a,U){return a.msg=p[U],U}function W(a){return(a<<1)-(4<a?9:0)}function ae(a){for(var U=a.length;0<=--U;)a[U]=0}function R(a){var U=a.state,F=U.pending;F>a.avail_out&&(F=a.avail_out),F!==0&&(s.arraySet(a.output,U.pending_buf,U.pending_out,F,a.next_out),a.next_out+=F,U.pending_out+=F,a.total_out+=F,a.avail_out-=F,U.pending-=F,U.pending===0&&(U.pending_out=0))}function z(a,U){n._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,U),a.block_start=a.strstart,R(a.strm)}function ee(a,U){a.pending_buf[a.pending++]=U}function X(a,U){a.pending_buf[a.pending++]=U>>>8&255,a.pending_buf[a.pending++]=255&U}function G(a,U){var F,_,y=a.max_chain_length,C=a.strstart,$=a.prev_length,Z=a.nice_match,I=a.strstart>a.w_size-Y?a.strstart-(a.w_size-Y):0,q=a.window,J=a.w_mask,V=a.prev,re=a.strstart+H,xe=q[C+$-1],ce=q[C+$];a.prev_length>=a.good_match&&(y>>=2),Z>a.lookahead&&(Z=a.lookahead);do if(q[(F=U)+$]===ce&&q[F+$-1]===xe&&q[F]===q[C]&&q[++F]===q[C+1]){C+=2,F++;do;while(q[++C]===q[++F]&&q[++C]===q[++F]&&q[++C]===q[++F]&&q[++C]===q[++F]&&q[++C]===q[++F]&&q[++C]===q[++F]&&q[++C]===q[++F]&&q[++C]===q[++F]&&C<re);if(_=H-(re-C),C=re-H,$<_){if(a.match_start=U,Z<=($=_))break;xe=q[C+$-1],ce=q[C+$]}}while((U=V[U&J])>I&&--y!=0);return $<=a.lookahead?$:a.lookahead}function me(a){var U,F,_,y,C,$,Z,I,q,J,V=a.w_size;do{if(y=a.window_size-a.lookahead-a.strstart,a.strstart>=V+(V-Y)){for(s.arraySet(a.window,a.window,V,V,0),a.match_start-=V,a.strstart-=V,a.block_start-=V,U=F=a.hash_size;_=a.head[--U],a.head[U]=V<=_?_-V:0,--F;);for(U=F=V;_=a.prev[--U],a.prev[U]=V<=_?_-V:0,--F;);y+=V}if(a.strm.avail_in===0)break;if($=a.strm,Z=a.window,I=a.strstart+a.lookahead,q=y,J=void 0,J=$.avail_in,q<J&&(J=q),F=J===0?0:($.avail_in-=J,s.arraySet(Z,$.input,$.next_in,J,I),$.state.wrap===1?$.adler=d($.adler,Z,J,I):$.state.wrap===2&&($.adler=b($.adler,Z,J,I)),$.next_in+=J,$.total_in+=J,J),a.lookahead+=F,a.lookahead+a.insert>=T)for(C=a.strstart-a.insert,a.ins_h=a.window[C],a.ins_h=(a.ins_h<<a.hash_shift^a.window[C+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[C+T-1])&a.hash_mask,a.prev[C&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=C,C++,a.insert--,!(a.lookahead+a.insert<T)););}while(a.lookahead<Y&&a.strm.avail_in!==0)}function be(a,U){for(var F,_;;){if(a.lookahead<Y){if(me(a),a.lookahead<Y&&U===v)return l;if(a.lookahead===0)break}if(F=0,a.lookahead>=T&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),F!==0&&a.strstart-F<=a.w_size-Y&&(a.match_length=G(a,F)),a.match_length>=T)if(_=n._tr_tally(a,a.strstart-a.match_start,a.match_length-T),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=T){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else _=n._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(_&&(z(a,!1),a.strm.avail_out===0))return l}return a.insert=a.strstart<T-1?a.strstart:T-1,U===g?(z(a,!0),a.strm.avail_out===0?Q:M):a.last_lit&&(z(a,!1),a.strm.avail_out===0)?l:P}function ie(a,U){for(var F,_,y;;){if(a.lookahead<Y){if(me(a),a.lookahead<Y&&U===v)return l;if(a.lookahead===0)break}if(F=0,a.lookahead>=T&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=T-1,F!==0&&a.prev_length<a.max_lazy_match&&a.strstart-F<=a.w_size-Y&&(a.match_length=G(a,F),a.match_length<=5&&(a.strategy===1||a.match_length===T&&4096<a.strstart-a.match_start)&&(a.match_length=T-1)),a.prev_length>=T&&a.match_length<=a.prev_length){for(y=a.strstart+a.lookahead-T,_=n._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-T),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=y&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,F=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=T-1,a.strstart++,_&&(z(a,!1),a.strm.avail_out===0))return l}else if(a.match_available){if((_=n._tr_tally(a,0,a.window[a.strstart-1]))&&z(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return l}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(_=n._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<T-1?a.strstart:T-1,U===g?(z(a,!0),a.strm.avail_out===0?Q:M):a.last_lit&&(z(a,!1),a.strm.avail_out===0)?l:P}function oe(a,U,F,_,y){this.good_length=a,this.max_lazy=U,this.nice_length=F,this.max_chain=_,this.func=y}function ye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=j,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*B),this.dyn_dtree=new s.Buf16(2*(2*A+1)),this.bl_tree=new s.Buf16(2*(2*D+1)),ae(this.dyn_ltree),ae(this.dyn_dtree),ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(E+1),this.heap=new s.Buf16(2*k+1),ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),ae(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pe(a){var U;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=m,(U=a.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?N:O,a.adler=U.wrap===2?0:1,U.last_flush=v,n._tr_init(U),h):se(a,w)}function Ne(a){var U=pe(a);return U===h&&function(F){F.window_size=2*F.w_size,ae(F.head),F.max_lazy_match=i[F.level].max_lazy,F.good_match=i[F.level].good_length,F.nice_match=i[F.level].nice_length,F.max_chain_length=i[F.level].max_chain,F.strstart=0,F.block_start=0,F.lookahead=0,F.insert=0,F.match_length=F.prev_length=T-1,F.match_available=0,F.ins_h=0}(a.state),U}function Ee(a,U,F,_,y,C){if(!a)return w;var $=1;if(U===o&&(U=6),_<0?($=0,_=-_):15<_&&($=2,_-=16),y<1||S<y||F!==j||_<8||15<_||U<0||9<U||C<0||x<C)return se(a,w);_===8&&(_=9);var Z=new ye;return(a.state=Z).strm=a,Z.wrap=$,Z.gzhead=null,Z.w_bits=_,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=y+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+T-1)/T),Z.window=new s.Buf8(2*Z.w_size),Z.head=new s.Buf16(Z.hash_size),Z.prev=new s.Buf16(Z.w_size),Z.lit_bufsize=1<<y+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new s.Buf8(Z.pending_buf_size),Z.d_buf=1*Z.lit_bufsize,Z.l_buf=3*Z.lit_bufsize,Z.level=U,Z.strategy=C,Z.method=F,Ne(a)}i=[new oe(0,0,0,0,function(a,U){var F=65535;for(F>a.pending_buf_size-5&&(F=a.pending_buf_size-5);;){if(a.lookahead<=1){if(me(a),a.lookahead===0&&U===v)return l;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var _=a.block_start+F;if((a.strstart===0||a.strstart>=_)&&(a.lookahead=a.strstart-_,a.strstart=_,z(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-Y&&(z(a,!1),a.strm.avail_out===0))return l}return a.insert=0,U===g?(z(a,!0),a.strm.avail_out===0?Q:M):(a.strstart>a.block_start&&(z(a,!1),a.strm.avail_out),l)}),new oe(4,4,8,4,be),new oe(4,5,16,8,be),new oe(4,6,32,32,be),new oe(4,4,16,16,ie),new oe(8,16,32,32,ie),new oe(8,16,128,128,ie),new oe(8,32,128,256,ie),new oe(32,128,258,1024,ie),new oe(32,258,258,4096,ie)],f.deflateInit=function(a,U){return Ee(a,U,j,15,8,0)},f.deflateInit2=Ee,f.deflateReset=Ne,f.deflateResetKeep=pe,f.deflateSetHeader=function(a,U){return a&&a.state?a.state.wrap!==2?w:(a.state.gzhead=U,h):w},f.deflate=function(a,U){var F,_,y,C;if(!a||!a.state||5<U||U<0)return a?se(a,w):w;if(_=a.state,!a.output||!a.input&&a.avail_in!==0||_.status===666&&U!==g)return se(a,a.avail_out===0?-5:w);if(_.strm=a,F=_.last_flush,_.last_flush=U,_.status===N)if(_.wrap===2)a.adler=0,ee(_,31),ee(_,139),ee(_,8),_.gzhead?(ee(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),ee(_,255&_.gzhead.time),ee(_,_.gzhead.time>>8&255),ee(_,_.gzhead.time>>16&255),ee(_,_.gzhead.time>>24&255),ee(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),ee(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(ee(_,255&_.gzhead.extra.length),ee(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(a.adler=b(a.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(ee(_,0),ee(_,0),ee(_,0),ee(_,0),ee(_,0),ee(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),ee(_,3),_.status=O);else{var $=j+(_.w_bits-8<<4)<<8;$|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&($|=32),$+=31-$%31,_.status=O,X(_,$),_.strstart!==0&&(X(_,a.adler>>>16),X(_,65535&a.adler)),a.adler=1}if(_.status===69)if(_.gzhead.extra){for(y=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),R(a),y=_.pending,_.pending!==_.pending_buf_size));)ee(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),R(a),y=_.pending,_.pending===_.pending_buf_size)){C=1;break}C=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,ee(_,C)}while(C!==0);_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),C===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){y=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),R(a),y=_.pending,_.pending===_.pending_buf_size)){C=1;break}C=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,ee(_,C)}while(C!==0);_.gzhead.hcrc&&_.pending>y&&(a.adler=b(a.adler,_.pending_buf,_.pending-y,y)),C===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&R(a),_.pending+2<=_.pending_buf_size&&(ee(_,255&a.adler),ee(_,a.adler>>8&255),a.adler=0,_.status=O)):_.status=O),_.pending!==0){if(R(a),a.avail_out===0)return _.last_flush=-1,h}else if(a.avail_in===0&&W(U)<=W(F)&&U!==g)return se(a,-5);if(_.status===666&&a.avail_in!==0)return se(a,-5);if(a.avail_in!==0||_.lookahead!==0||U!==v&&_.status!==666){var Z=_.strategy===2?function(I,q){for(var J;;){if(I.lookahead===0&&(me(I),I.lookahead===0)){if(q===v)return l;break}if(I.match_length=0,J=n._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,J&&(z(I,!1),I.strm.avail_out===0))return l}return I.insert=0,q===g?(z(I,!0),I.strm.avail_out===0?Q:M):I.last_lit&&(z(I,!1),I.strm.avail_out===0)?l:P}(_,U):_.strategy===3?function(I,q){for(var J,V,re,xe,ce=I.window;;){if(I.lookahead<=H){if(me(I),I.lookahead<=H&&q===v)return l;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=T&&0<I.strstart&&(V=ce[re=I.strstart-1])===ce[++re]&&V===ce[++re]&&V===ce[++re]){xe=I.strstart+H;do;while(V===ce[++re]&&V===ce[++re]&&V===ce[++re]&&V===ce[++re]&&V===ce[++re]&&V===ce[++re]&&V===ce[++re]&&V===ce[++re]&&re<xe);I.match_length=H-(xe-re),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=T?(J=n._tr_tally(I,1,I.match_length-T),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(J=n._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),J&&(z(I,!1),I.strm.avail_out===0))return l}return I.insert=0,q===g?(z(I,!0),I.strm.avail_out===0?Q:M):I.last_lit&&(z(I,!1),I.strm.avail_out===0)?l:P}(_,U):i[_.level].func(_,U);if(Z!==Q&&Z!==M||(_.status=666),Z===l||Z===Q)return a.avail_out===0&&(_.last_flush=-1),h;if(Z===P&&(U===1?n._tr_align(_):U!==5&&(n._tr_stored_block(_,0,0,!1),U===3&&(ae(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),R(a),a.avail_out===0))return _.last_flush=-1,h}return U!==g?h:_.wrap<=0?1:(_.wrap===2?(ee(_,255&a.adler),ee(_,a.adler>>8&255),ee(_,a.adler>>16&255),ee(_,a.adler>>24&255),ee(_,255&a.total_in),ee(_,a.total_in>>8&255),ee(_,a.total_in>>16&255),ee(_,a.total_in>>24&255)):(X(_,a.adler>>>16),X(_,65535&a.adler)),R(a),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?h:1)},f.deflateEnd=function(a){var U;return a&&a.state?(U=a.state.status)!==N&&U!==69&&U!==73&&U!==91&&U!==103&&U!==O&&U!==666?se(a,w):(a.state=null,U===O?se(a,-3):h):w},f.deflateSetDictionary=function(a,U){var F,_,y,C,$,Z,I,q,J=U.length;if(!a||!a.state||(C=(F=a.state).wrap)===2||C===1&&F.status!==N||F.lookahead)return w;for(C===1&&(a.adler=d(a.adler,U,J,0)),F.wrap=0,J>=F.w_size&&(C===0&&(ae(F.head),F.strstart=0,F.block_start=0,F.insert=0),q=new s.Buf8(F.w_size),s.arraySet(q,U,J-F.w_size,F.w_size,0),U=q,J=F.w_size),$=a.avail_in,Z=a.next_in,I=a.input,a.avail_in=J,a.next_in=0,a.input=U,me(F);F.lookahead>=T;){for(_=F.strstart,y=F.lookahead-(T-1);F.ins_h=(F.ins_h<<F.hash_shift^F.window[_+T-1])&F.hash_mask,F.prev[_&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=_,_++,--y;);F.strstart=_,F.lookahead=T-1,me(F)}return F.strstart+=F.lookahead,F.block_start=F.strstart,F.insert=F.lookahead,F.lookahead=0,F.match_length=F.prev_length=T-1,F.match_available=0,a.next_in=Z,a.input=I,a.avail_in=$,F.wrap=C,h},f.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,u,f){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,u,f){u.exports=function(i,s){var n,d,b,p,v,g,h,w,o,x,m,j,S,k,A,D,B,E,T,H,Y,N,O,l,P;n=i.state,d=i.next_in,l=i.input,b=d+(i.avail_in-5),p=i.next_out,P=i.output,v=p-(s-i.avail_out),g=p+(i.avail_out-257),h=n.dmax,w=n.wsize,o=n.whave,x=n.wnext,m=n.window,j=n.hold,S=n.bits,k=n.lencode,A=n.distcode,D=(1<<n.lenbits)-1,B=(1<<n.distbits)-1;e:do{S<15&&(j+=l[d++]<<S,S+=8,j+=l[d++]<<S,S+=8),E=k[j&D];t:for(;;){if(j>>>=T=E>>>24,S-=T,(T=E>>>16&255)===0)P[p++]=65535&E;else{if(!(16&T)){if(!(64&T)){E=k[(65535&E)+(j&(1<<T)-1)];continue t}if(32&T){n.mode=12;break e}i.msg="invalid literal/length code",n.mode=30;break e}H=65535&E,(T&=15)&&(S<T&&(j+=l[d++]<<S,S+=8),H+=j&(1<<T)-1,j>>>=T,S-=T),S<15&&(j+=l[d++]<<S,S+=8,j+=l[d++]<<S,S+=8),E=A[j&B];r:for(;;){if(j>>>=T=E>>>24,S-=T,!(16&(T=E>>>16&255))){if(!(64&T)){E=A[(65535&E)+(j&(1<<T)-1)];continue r}i.msg="invalid distance code",n.mode=30;break e}if(Y=65535&E,S<(T&=15)&&(j+=l[d++]<<S,(S+=8)<T&&(j+=l[d++]<<S,S+=8)),h<(Y+=j&(1<<T)-1)){i.msg="invalid distance too far back",n.mode=30;break e}if(j>>>=T,S-=T,(T=p-v)<Y){if(o<(T=Y-T)&&n.sane){i.msg="invalid distance too far back",n.mode=30;break e}if(O=m,(N=0)===x){if(N+=w-T,T<H){for(H-=T;P[p++]=m[N++],--T;);N=p-Y,O=P}}else if(x<T){if(N+=w+x-T,(T-=x)<H){for(H-=T;P[p++]=m[N++],--T;);if(N=0,x<H){for(H-=T=x;P[p++]=m[N++],--T;);N=p-Y,O=P}}}else if(N+=x-T,T<H){for(H-=T;P[p++]=m[N++],--T;);N=p-Y,O=P}for(;2<H;)P[p++]=O[N++],P[p++]=O[N++],P[p++]=O[N++],H-=3;H&&(P[p++]=O[N++],1<H&&(P[p++]=O[N++]))}else{for(N=p-Y;P[p++]=P[N++],P[p++]=P[N++],P[p++]=P[N++],2<(H-=3););H&&(P[p++]=P[N++],1<H&&(P[p++]=P[N++]))}break}}break}}while(d<b&&p<g);d-=H=S>>3,j&=(1<<(S-=H<<3))-1,i.next_in=d,i.next_out=p,i.avail_in=d<b?b-d+5:5-(d-b),i.avail_out=p<g?g-p+257:257-(p-g),n.hold=j,n.bits=S}},{}],49:[function(t,u,f){var i=t("../utils/common"),s=t("./adler32"),n=t("./crc32"),d=t("./inffast"),b=t("./inftrees"),p=1,v=2,g=0,h=-2,w=1,o=852,x=592;function m(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(N){var O;return N&&N.state?(O=N.state,N.total_in=N.total_out=O.total=0,N.msg="",O.wrap&&(N.adler=1&O.wrap),O.mode=w,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new i.Buf32(o),O.distcode=O.distdyn=new i.Buf32(x),O.sane=1,O.back=-1,g):h}function k(N){var O;return N&&N.state?((O=N.state).wsize=0,O.whave=0,O.wnext=0,S(N)):h}function A(N,O){var l,P;return N&&N.state?(P=N.state,O<0?(l=0,O=-O):(l=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?h:(P.window!==null&&P.wbits!==O&&(P.window=null),P.wrap=l,P.wbits=O,k(N))):h}function D(N,O){var l,P;return N?(P=new j,(N.state=P).window=null,(l=A(N,O))!==g&&(N.state=null),l):h}var B,E,T=!0;function H(N){if(T){var O;for(B=new i.Buf32(512),E=new i.Buf32(32),O=0;O<144;)N.lens[O++]=8;for(;O<256;)N.lens[O++]=9;for(;O<280;)N.lens[O++]=7;for(;O<288;)N.lens[O++]=8;for(b(p,N.lens,0,288,B,0,N.work,{bits:9}),O=0;O<32;)N.lens[O++]=5;b(v,N.lens,0,32,E,0,N.work,{bits:5}),T=!1}N.lencode=B,N.lenbits=9,N.distcode=E,N.distbits=5}function Y(N,O,l,P){var Q,M=N.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new i.Buf8(M.wsize)),P>=M.wsize?(i.arraySet(M.window,O,l-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(P<(Q=M.wsize-M.wnext)&&(Q=P),i.arraySet(M.window,O,l-P,Q,M.wnext),(P-=Q)?(i.arraySet(M.window,O,l-P,P,0),M.wnext=P,M.whave=M.wsize):(M.wnext+=Q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=Q))),0}f.inflateReset=k,f.inflateReset2=A,f.inflateResetKeep=S,f.inflateInit=function(N){return D(N,15)},f.inflateInit2=D,f.inflate=function(N,O){var l,P,Q,M,se,W,ae,R,z,ee,X,G,me,be,ie,oe,ye,pe,Ne,Ee,a,U,F,_,y=0,C=new i.Buf8(4),$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return h;(l=N.state).mode===12&&(l.mode=13),se=N.next_out,Q=N.output,ae=N.avail_out,M=N.next_in,P=N.input,W=N.avail_in,R=l.hold,z=l.bits,ee=W,X=ae,U=g;e:for(;;)switch(l.mode){case w:if(l.wrap===0){l.mode=13;break}for(;z<16;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(2&l.wrap&&R===35615){C[l.check=0]=255&R,C[1]=R>>>8&255,l.check=n(l.check,C,2,0),z=R=0,l.mode=2;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&R)<<8)+(R>>8))%31){N.msg="incorrect header check",l.mode=30;break}if((15&R)!=8){N.msg="unknown compression method",l.mode=30;break}if(z-=4,a=8+(15&(R>>>=4)),l.wbits===0)l.wbits=a;else if(a>l.wbits){N.msg="invalid window size",l.mode=30;break}l.dmax=1<<a,N.adler=l.check=1,l.mode=512&R?10:12,z=R=0;break;case 2:for(;z<16;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(l.flags=R,(255&l.flags)!=8){N.msg="unknown compression method",l.mode=30;break}if(57344&l.flags){N.msg="unknown header flags set",l.mode=30;break}l.head&&(l.head.text=R>>8&1),512&l.flags&&(C[0]=255&R,C[1]=R>>>8&255,l.check=n(l.check,C,2,0)),z=R=0,l.mode=3;case 3:for(;z<32;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}l.head&&(l.head.time=R),512&l.flags&&(C[0]=255&R,C[1]=R>>>8&255,C[2]=R>>>16&255,C[3]=R>>>24&255,l.check=n(l.check,C,4,0)),z=R=0,l.mode=4;case 4:for(;z<16;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}l.head&&(l.head.xflags=255&R,l.head.os=R>>8),512&l.flags&&(C[0]=255&R,C[1]=R>>>8&255,l.check=n(l.check,C,2,0)),z=R=0,l.mode=5;case 5:if(1024&l.flags){for(;z<16;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}l.length=R,l.head&&(l.head.extra_len=R),512&l.flags&&(C[0]=255&R,C[1]=R>>>8&255,l.check=n(l.check,C,2,0)),z=R=0}else l.head&&(l.head.extra=null);l.mode=6;case 6:if(1024&l.flags&&(W<(G=l.length)&&(G=W),G&&(l.head&&(a=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),i.arraySet(l.head.extra,P,M,G,a)),512&l.flags&&(l.check=n(l.check,P,G,M)),W-=G,M+=G,l.length-=G),l.length))break e;l.length=0,l.mode=7;case 7:if(2048&l.flags){if(W===0)break e;for(G=0;a=P[M+G++],l.head&&a&&l.length<65536&&(l.head.name+=String.fromCharCode(a)),a&&G<W;);if(512&l.flags&&(l.check=n(l.check,P,G,M)),W-=G,M+=G,a)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=8;case 8:if(4096&l.flags){if(W===0)break e;for(G=0;a=P[M+G++],l.head&&a&&l.length<65536&&(l.head.comment+=String.fromCharCode(a)),a&&G<W;);if(512&l.flags&&(l.check=n(l.check,P,G,M)),W-=G,M+=G,a)break e}else l.head&&(l.head.comment=null);l.mode=9;case 9:if(512&l.flags){for(;z<16;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(R!==(65535&l.check)){N.msg="header crc mismatch",l.mode=30;break}z=R=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),N.adler=l.check=0,l.mode=12;break;case 10:for(;z<32;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}N.adler=l.check=m(R),z=R=0,l.mode=11;case 11:if(l.havedict===0)return N.next_out=se,N.avail_out=ae,N.next_in=M,N.avail_in=W,l.hold=R,l.bits=z,2;N.adler=l.check=1,l.mode=12;case 12:if(O===5||O===6)break e;case 13:if(l.last){R>>>=7&z,z-=7&z,l.mode=27;break}for(;z<3;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}switch(l.last=1&R,z-=1,3&(R>>>=1)){case 0:l.mode=14;break;case 1:if(H(l),l.mode=20,O!==6)break;R>>>=2,z-=2;break e;case 2:l.mode=17;break;case 3:N.msg="invalid block type",l.mode=30}R>>>=2,z-=2;break;case 14:for(R>>>=7&z,z-=7&z;z<32;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if((65535&R)!=(R>>>16^65535)){N.msg="invalid stored block lengths",l.mode=30;break}if(l.length=65535&R,z=R=0,l.mode=15,O===6)break e;case 15:l.mode=16;case 16:if(G=l.length){if(W<G&&(G=W),ae<G&&(G=ae),G===0)break e;i.arraySet(Q,P,M,G,se),W-=G,M+=G,ae-=G,se+=G,l.length-=G;break}l.mode=12;break;case 17:for(;z<14;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(l.nlen=257+(31&R),R>>>=5,z-=5,l.ndist=1+(31&R),R>>>=5,z-=5,l.ncode=4+(15&R),R>>>=4,z-=4,286<l.nlen||30<l.ndist){N.msg="too many length or distance symbols",l.mode=30;break}l.have=0,l.mode=18;case 18:for(;l.have<l.ncode;){for(;z<3;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}l.lens[$[l.have++]]=7&R,R>>>=3,z-=3}for(;l.have<19;)l.lens[$[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,F={bits:l.lenbits},U=b(0,l.lens,0,19,l.lencode,0,l.work,F),l.lenbits=F.bits,U){N.msg="invalid code lengths set",l.mode=30;break}l.have=0,l.mode=19;case 19:for(;l.have<l.nlen+l.ndist;){for(;oe=(y=l.lencode[R&(1<<l.lenbits)-1])>>>16&255,ye=65535&y,!((ie=y>>>24)<=z);){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(ye<16)R>>>=ie,z-=ie,l.lens[l.have++]=ye;else{if(ye===16){for(_=ie+2;z<_;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(R>>>=ie,z-=ie,l.have===0){N.msg="invalid bit length repeat",l.mode=30;break}a=l.lens[l.have-1],G=3+(3&R),R>>>=2,z-=2}else if(ye===17){for(_=ie+3;z<_;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}z-=ie,a=0,G=3+(7&(R>>>=ie)),R>>>=3,z-=3}else{for(_=ie+7;z<_;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}z-=ie,a=0,G=11+(127&(R>>>=ie)),R>>>=7,z-=7}if(l.have+G>l.nlen+l.ndist){N.msg="invalid bit length repeat",l.mode=30;break}for(;G--;)l.lens[l.have++]=a}}if(l.mode===30)break;if(l.lens[256]===0){N.msg="invalid code -- missing end-of-block",l.mode=30;break}if(l.lenbits=9,F={bits:l.lenbits},U=b(p,l.lens,0,l.nlen,l.lencode,0,l.work,F),l.lenbits=F.bits,U){N.msg="invalid literal/lengths set",l.mode=30;break}if(l.distbits=6,l.distcode=l.distdyn,F={bits:l.distbits},U=b(v,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,F),l.distbits=F.bits,U){N.msg="invalid distances set",l.mode=30;break}if(l.mode=20,O===6)break e;case 20:l.mode=21;case 21:if(6<=W&&258<=ae){N.next_out=se,N.avail_out=ae,N.next_in=M,N.avail_in=W,l.hold=R,l.bits=z,d(N,X),se=N.next_out,Q=N.output,ae=N.avail_out,M=N.next_in,P=N.input,W=N.avail_in,R=l.hold,z=l.bits,l.mode===12&&(l.back=-1);break}for(l.back=0;oe=(y=l.lencode[R&(1<<l.lenbits)-1])>>>16&255,ye=65535&y,!((ie=y>>>24)<=z);){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(oe&&!(240&oe)){for(pe=ie,Ne=oe,Ee=ye;oe=(y=l.lencode[Ee+((R&(1<<pe+Ne)-1)>>pe)])>>>16&255,ye=65535&y,!(pe+(ie=y>>>24)<=z);){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}R>>>=pe,z-=pe,l.back+=pe}if(R>>>=ie,z-=ie,l.back+=ie,l.length=ye,oe===0){l.mode=26;break}if(32&oe){l.back=-1,l.mode=12;break}if(64&oe){N.msg="invalid literal/length code",l.mode=30;break}l.extra=15&oe,l.mode=22;case 22:if(l.extra){for(_=l.extra;z<_;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}l.length+=R&(1<<l.extra)-1,R>>>=l.extra,z-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=23;case 23:for(;oe=(y=l.distcode[R&(1<<l.distbits)-1])>>>16&255,ye=65535&y,!((ie=y>>>24)<=z);){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(!(240&oe)){for(pe=ie,Ne=oe,Ee=ye;oe=(y=l.distcode[Ee+((R&(1<<pe+Ne)-1)>>pe)])>>>16&255,ye=65535&y,!(pe+(ie=y>>>24)<=z);){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}R>>>=pe,z-=pe,l.back+=pe}if(R>>>=ie,z-=ie,l.back+=ie,64&oe){N.msg="invalid distance code",l.mode=30;break}l.offset=ye,l.extra=15&oe,l.mode=24;case 24:if(l.extra){for(_=l.extra;z<_;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}l.offset+=R&(1<<l.extra)-1,R>>>=l.extra,z-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){N.msg="invalid distance too far back",l.mode=30;break}l.mode=25;case 25:if(ae===0)break e;if(G=X-ae,l.offset>G){if((G=l.offset-G)>l.whave&&l.sane){N.msg="invalid distance too far back",l.mode=30;break}me=G>l.wnext?(G-=l.wnext,l.wsize-G):l.wnext-G,G>l.length&&(G=l.length),be=l.window}else be=Q,me=se-l.offset,G=l.length;for(ae<G&&(G=ae),ae-=G,l.length-=G;Q[se++]=be[me++],--G;);l.length===0&&(l.mode=21);break;case 26:if(ae===0)break e;Q[se++]=l.length,ae--,l.mode=21;break;case 27:if(l.wrap){for(;z<32;){if(W===0)break e;W--,R|=P[M++]<<z,z+=8}if(X-=ae,N.total_out+=X,l.total+=X,X&&(N.adler=l.check=l.flags?n(l.check,Q,X,se-X):s(l.check,Q,X,se-X)),X=ae,(l.flags?R:m(R))!==l.check){N.msg="incorrect data check",l.mode=30;break}z=R=0}l.mode=28;case 28:if(l.wrap&&l.flags){for(;z<32;){if(W===0)break e;W--,R+=P[M++]<<z,z+=8}if(R!==(4294967295&l.total)){N.msg="incorrect length check",l.mode=30;break}z=R=0}l.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return h}return N.next_out=se,N.avail_out=ae,N.next_in=M,N.avail_in=W,l.hold=R,l.bits=z,(l.wsize||X!==N.avail_out&&l.mode<30&&(l.mode<27||O!==4))&&Y(N,N.output,N.next_out,X-N.avail_out)?(l.mode=31,-4):(ee-=N.avail_in,X-=N.avail_out,N.total_in+=ee,N.total_out+=X,l.total+=X,l.wrap&&X&&(N.adler=l.check=l.flags?n(l.check,Q,X,N.next_out-X):s(l.check,Q,X,N.next_out-X)),N.data_type=l.bits+(l.last?64:0)+(l.mode===12?128:0)+(l.mode===20||l.mode===15?256:0),(ee==0&&X===0||O===4)&&U===g&&(U=-5),U)},f.inflateEnd=function(N){if(!N||!N.state)return h;var O=N.state;return O.window&&(O.window=null),N.state=null,g},f.inflateGetHeader=function(N,O){var l;return N&&N.state&&2&(l=N.state).wrap?((l.head=O).done=!1,g):h},f.inflateSetDictionary=function(N,O){var l,P=O.length;return N&&N.state?(l=N.state).wrap!==0&&l.mode!==11?h:l.mode===11&&s(1,O,P,0)!==l.check?-3:Y(N,O,P,P)?(l.mode=31,-4):(l.havedict=1,g):h},f.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,u,f){var i=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(p,v,g,h,w,o,x,m){var j,S,k,A,D,B,E,T,H,Y=m.bits,N=0,O=0,l=0,P=0,Q=0,M=0,se=0,W=0,ae=0,R=0,z=null,ee=0,X=new i.Buf16(16),G=new i.Buf16(16),me=null,be=0;for(N=0;N<=15;N++)X[N]=0;for(O=0;O<h;O++)X[v[g+O]]++;for(Q=Y,P=15;1<=P&&X[P]===0;P--);if(P<Q&&(Q=P),P===0)return w[o++]=20971520,w[o++]=20971520,m.bits=1,0;for(l=1;l<P&&X[l]===0;l++);for(Q<l&&(Q=l),N=W=1;N<=15;N++)if(W<<=1,(W-=X[N])<0)return-1;if(0<W&&(p===0||P!==1))return-1;for(G[1]=0,N=1;N<15;N++)G[N+1]=G[N]+X[N];for(O=0;O<h;O++)v[g+O]!==0&&(x[G[v[g+O]]++]=O);if(B=p===0?(z=me=x,19):p===1?(z=s,ee-=257,me=n,be-=257,256):(z=d,me=b,-1),N=l,D=o,se=O=R=0,k=-1,A=(ae=1<<(M=Q))-1,p===1&&852<ae||p===2&&592<ae)return 1;for(;;){for(E=N-se,H=x[O]<B?(T=0,x[O]):x[O]>B?(T=me[be+x[O]],z[ee+x[O]]):(T=96,0),j=1<<N-se,l=S=1<<M;w[D+(R>>se)+(S-=j)]=E<<24|T<<16|H|0,S!==0;);for(j=1<<N-1;R&j;)j>>=1;if(j!==0?(R&=j-1,R+=j):R=0,O++,--X[N]==0){if(N===P)break;N=v[g+x[O]]}if(Q<N&&(R&A)!==k){for(se===0&&(se=Q),D+=l,W=1<<(M=N-se);M+se<P&&!((W-=X[M+se])<=0);)M++,W<<=1;if(ae+=1<<M,p===1&&852<ae||p===2&&592<ae)return 1;w[k=R&A]=Q<<24|M<<16|D-o|0}}return R!==0&&(w[D+R]=N-se<<24|64<<16|0),m.bits=Q,0}},{"../utils/common":41}],51:[function(t,u,f){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,u,f){var i=t("../utils/common"),s=0,n=1;function d(y){for(var C=y.length;0<=--C;)y[C]=0}var b=0,p=29,v=256,g=v+1+p,h=30,w=19,o=2*g+1,x=15,m=16,j=7,S=256,k=16,A=17,D=18,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=new Array(2*(g+2));d(Y);var N=new Array(2*h);d(N);var O=new Array(512);d(O);var l=new Array(256);d(l);var P=new Array(p);d(P);var Q,M,se,W=new Array(h);function ae(y,C,$,Z,I){this.static_tree=y,this.extra_bits=C,this.extra_base=$,this.elems=Z,this.max_length=I,this.has_stree=y&&y.length}function R(y,C){this.dyn_tree=y,this.max_code=0,this.stat_desc=C}function z(y){return y<256?O[y]:O[256+(y>>>7)]}function ee(y,C){y.pending_buf[y.pending++]=255&C,y.pending_buf[y.pending++]=C>>>8&255}function X(y,C,$){y.bi_valid>m-$?(y.bi_buf|=C<<y.bi_valid&65535,ee(y,y.bi_buf),y.bi_buf=C>>m-y.bi_valid,y.bi_valid+=$-m):(y.bi_buf|=C<<y.bi_valid&65535,y.bi_valid+=$)}function G(y,C,$){X(y,$[2*C],$[2*C+1])}function me(y,C){for(var $=0;$|=1&y,y>>>=1,$<<=1,0<--C;);return $>>>1}function be(y,C,$){var Z,I,q=new Array(x+1),J=0;for(Z=1;Z<=x;Z++)q[Z]=J=J+$[Z-1]<<1;for(I=0;I<=C;I++){var V=y[2*I+1];V!==0&&(y[2*I]=me(q[V]++,V))}}function ie(y){var C;for(C=0;C<g;C++)y.dyn_ltree[2*C]=0;for(C=0;C<h;C++)y.dyn_dtree[2*C]=0;for(C=0;C<w;C++)y.bl_tree[2*C]=0;y.dyn_ltree[2*S]=1,y.opt_len=y.static_len=0,y.last_lit=y.matches=0}function oe(y){8<y.bi_valid?ee(y,y.bi_buf):0<y.bi_valid&&(y.pending_buf[y.pending++]=y.bi_buf),y.bi_buf=0,y.bi_valid=0}function ye(y,C,$,Z){var I=2*C,q=2*$;return y[I]<y[q]||y[I]===y[q]&&Z[C]<=Z[$]}function pe(y,C,$){for(var Z=y.heap[$],I=$<<1;I<=y.heap_len&&(I<y.heap_len&&ye(C,y.heap[I+1],y.heap[I],y.depth)&&I++,!ye(C,Z,y.heap[I],y.depth));)y.heap[$]=y.heap[I],$=I,I<<=1;y.heap[$]=Z}function Ne(y,C,$){var Z,I,q,J,V=0;if(y.last_lit!==0)for(;Z=y.pending_buf[y.d_buf+2*V]<<8|y.pending_buf[y.d_buf+2*V+1],I=y.pending_buf[y.l_buf+V],V++,Z===0?G(y,I,C):(G(y,(q=l[I])+v+1,C),(J=B[q])!==0&&X(y,I-=P[q],J),G(y,q=z(--Z),$),(J=E[q])!==0&&X(y,Z-=W[q],J)),V<y.last_lit;);G(y,S,C)}function Ee(y,C){var $,Z,I,q=C.dyn_tree,J=C.stat_desc.static_tree,V=C.stat_desc.has_stree,re=C.stat_desc.elems,xe=-1;for(y.heap_len=0,y.heap_max=o,$=0;$<re;$++)q[2*$]!==0?(y.heap[++y.heap_len]=xe=$,y.depth[$]=0):q[2*$+1]=0;for(;y.heap_len<2;)q[2*(I=y.heap[++y.heap_len]=xe<2?++xe:0)]=1,y.depth[I]=0,y.opt_len--,V&&(y.static_len-=J[2*I+1]);for(C.max_code=xe,$=y.heap_len>>1;1<=$;$--)pe(y,q,$);for(I=re;$=y.heap[1],y.heap[1]=y.heap[y.heap_len--],pe(y,q,1),Z=y.heap[1],y.heap[--y.heap_max]=$,y.heap[--y.heap_max]=Z,q[2*I]=q[2*$]+q[2*Z],y.depth[I]=(y.depth[$]>=y.depth[Z]?y.depth[$]:y.depth[Z])+1,q[2*$+1]=q[2*Z+1]=I,y.heap[1]=I++,pe(y,q,1),2<=y.heap_len;);y.heap[--y.heap_max]=y.heap[1],function(ce,Ae){var We,Oe,Ze,we,Ye,Je,Te=Ae.dyn_tree,tt=Ae.max_code,nt=Ae.stat_desc.static_tree,it=Ae.stat_desc.has_stree,ot=Ae.stat_desc.extra_bits,rt=Ae.stat_desc.extra_base,He=Ae.stat_desc.max_length,Ke=0;for(we=0;we<=x;we++)ce.bl_count[we]=0;for(Te[2*ce.heap[ce.heap_max]+1]=0,We=ce.heap_max+1;We<o;We++)He<(we=Te[2*Te[2*(Oe=ce.heap[We])+1]+1]+1)&&(we=He,Ke++),Te[2*Oe+1]=we,tt<Oe||(ce.bl_count[we]++,Ye=0,rt<=Oe&&(Ye=ot[Oe-rt]),Je=Te[2*Oe],ce.opt_len+=Je*(we+Ye),it&&(ce.static_len+=Je*(nt[2*Oe+1]+Ye)));if(Ke!==0){do{for(we=He-1;ce.bl_count[we]===0;)we--;ce.bl_count[we]--,ce.bl_count[we+1]+=2,ce.bl_count[He]--,Ke-=2}while(0<Ke);for(we=He;we!==0;we--)for(Oe=ce.bl_count[we];Oe!==0;)tt<(Ze=ce.heap[--We])||(Te[2*Ze+1]!==we&&(ce.opt_len+=(we-Te[2*Ze+1])*Te[2*Ze],Te[2*Ze+1]=we),Oe--)}}(y,C),be(q,xe,y.bl_count)}function a(y,C,$){var Z,I,q=-1,J=C[1],V=0,re=7,xe=4;for(J===0&&(re=138,xe=3),C[2*($+1)+1]=65535,Z=0;Z<=$;Z++)I=J,J=C[2*(Z+1)+1],++V<re&&I===J||(V<xe?y.bl_tree[2*I]+=V:I!==0?(I!==q&&y.bl_tree[2*I]++,y.bl_tree[2*k]++):V<=10?y.bl_tree[2*A]++:y.bl_tree[2*D]++,q=I,xe=(V=0)===J?(re=138,3):I===J?(re=6,3):(re=7,4))}function U(y,C,$){var Z,I,q=-1,J=C[1],V=0,re=7,xe=4;for(J===0&&(re=138,xe=3),Z=0;Z<=$;Z++)if(I=J,J=C[2*(Z+1)+1],!(++V<re&&I===J)){if(V<xe)for(;G(y,I,y.bl_tree),--V!=0;);else I!==0?(I!==q&&(G(y,I,y.bl_tree),V--),G(y,k,y.bl_tree),X(y,V-3,2)):V<=10?(G(y,A,y.bl_tree),X(y,V-3,3)):(G(y,D,y.bl_tree),X(y,V-11,7));q=I,xe=(V=0)===J?(re=138,3):I===J?(re=6,3):(re=7,4)}}d(W);var F=!1;function _(y,C,$,Z){X(y,(b<<1)+(Z?1:0),3),function(I,q,J,V){oe(I),ee(I,J),ee(I,~J),i.arraySet(I.pending_buf,I.window,q,J,I.pending),I.pending+=J}(y,C,$)}f._tr_init=function(y){F||(function(){var C,$,Z,I,q,J=new Array(x+1);for(I=Z=0;I<p-1;I++)for(P[I]=Z,C=0;C<1<<B[I];C++)l[Z++]=I;for(l[Z-1]=I,I=q=0;I<16;I++)for(W[I]=q,C=0;C<1<<E[I];C++)O[q++]=I;for(q>>=7;I<h;I++)for(W[I]=q<<7,C=0;C<1<<E[I]-7;C++)O[256+q++]=I;for($=0;$<=x;$++)J[$]=0;for(C=0;C<=143;)Y[2*C+1]=8,C++,J[8]++;for(;C<=255;)Y[2*C+1]=9,C++,J[9]++;for(;C<=279;)Y[2*C+1]=7,C++,J[7]++;for(;C<=287;)Y[2*C+1]=8,C++,J[8]++;for(be(Y,g+1,J),C=0;C<h;C++)N[2*C+1]=5,N[2*C]=me(C,5);Q=new ae(Y,B,v+1,g,x),M=new ae(N,E,0,h,x),se=new ae(new Array(0),T,0,w,j)}(),F=!0),y.l_desc=new R(y.dyn_ltree,Q),y.d_desc=new R(y.dyn_dtree,M),y.bl_desc=new R(y.bl_tree,se),y.bi_buf=0,y.bi_valid=0,ie(y)},f._tr_stored_block=_,f._tr_flush_block=function(y,C,$,Z){var I,q,J=0;0<y.level?(y.strm.data_type===2&&(y.strm.data_type=function(V){var re,xe=4093624447;for(re=0;re<=31;re++,xe>>>=1)if(1&xe&&V.dyn_ltree[2*re]!==0)return s;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return n;for(re=32;re<v;re++)if(V.dyn_ltree[2*re]!==0)return n;return s}(y)),Ee(y,y.l_desc),Ee(y,y.d_desc),J=function(V){var re;for(a(V,V.dyn_ltree,V.l_desc.max_code),a(V,V.dyn_dtree,V.d_desc.max_code),Ee(V,V.bl_desc),re=w-1;3<=re&&V.bl_tree[2*H[re]+1]===0;re--);return V.opt_len+=3*(re+1)+5+5+4,re}(y),I=y.opt_len+3+7>>>3,(q=y.static_len+3+7>>>3)<=I&&(I=q)):I=q=$+5,$+4<=I&&C!==-1?_(y,C,$,Z):y.strategy===4||q===I?(X(y,2+(Z?1:0),3),Ne(y,Y,N)):(X(y,4+(Z?1:0),3),function(V,re,xe,ce){var Ae;for(X(V,re-257,5),X(V,xe-1,5),X(V,ce-4,4),Ae=0;Ae<ce;Ae++)X(V,V.bl_tree[2*H[Ae]+1],3);U(V,V.dyn_ltree,re-1),U(V,V.dyn_dtree,xe-1)}(y,y.l_desc.max_code+1,y.d_desc.max_code+1,J+1),Ne(y,y.dyn_ltree,y.dyn_dtree)),ie(y),Z&&oe(y)},f._tr_tally=function(y,C,$){return y.pending_buf[y.d_buf+2*y.last_lit]=C>>>8&255,y.pending_buf[y.d_buf+2*y.last_lit+1]=255&C,y.pending_buf[y.l_buf+y.last_lit]=255&$,y.last_lit++,C===0?y.dyn_ltree[2*$]++:(y.matches++,C--,y.dyn_ltree[2*(l[$]+v+1)]++,y.dyn_dtree[2*z(C)]++),y.last_lit===y.lit_bufsize-1},f._tr_align=function(y){X(y,2,3),G(y,S,Y),function(C){C.bi_valid===16?(ee(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):8<=C.bi_valid&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)}(y)}},{"../utils/common":41}],53:[function(t,u,f){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,u,f){(function(i){(function(s,n){if(!s.setImmediate){var d,b,p,v,g=1,h={},w=!1,o=s.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(s);x=x&&x.setTimeout?x:s,d={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){j(k)})}:function(){if(s.postMessage&&!s.importScripts){var k=!0,A=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=A,k}}()?(v="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",S,!1):s.attachEvent("onmessage",S),function(k){s.postMessage(v+k,"*")}):s.MessageChannel?((p=new MessageChannel).port1.onmessage=function(k){j(k.data)},function(k){p.port2.postMessage(k)}):o&&"onreadystatechange"in o.createElement("script")?(b=o.documentElement,function(k){var A=o.createElement("script");A.onreadystatechange=function(){j(k),A.onreadystatechange=null,b.removeChild(A),A=null},b.appendChild(A)}):function(k){setTimeout(j,0,k)},x.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var A=new Array(arguments.length-1),D=0;D<A.length;D++)A[D]=arguments[D+1];var B={callback:k,args:A};return h[g]=B,d(g),g++},x.clearImmediate=m}function m(k){delete h[k]}function j(k){if(w)setTimeout(j,0,k);else{var A=h[k];if(A){w=!0;try{(function(D){var B=D.callback,E=D.args;switch(E.length){case 0:B();break;case 1:B(E[0]);break;case 2:B(E[0],E[1]);break;case 3:B(E[0],E[1],E[2]);break;default:B.apply(n,E)}})(A)}finally{m(k),w=!1}}}}function S(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(v)===0&&j(+k.data.slice(v.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(lr);var Cs=lr.exports;const Es=wr(Cs);var cr={exports:{}};(function(r,c){(function(t,u){u()})($e,function(){function t(b,p){return typeof p>"u"?p={autoBom:!1}:typeof p!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?new Blob(["\uFEFF",b],{type:b.type}):b}function u(b,p,v){var g=new XMLHttpRequest;g.open("GET",b),g.responseType="blob",g.onload=function(){d(g.response,p,v)},g.onerror=function(){console.error("could not download file")},g.send()}function f(b){var p=new XMLHttpRequest;p.open("HEAD",b,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function i(b){try{b.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),b.dispatchEvent(p)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $e=="object"&&$e.global===$e?$e:void 0,n=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(b,p,v){var g=s.URL||s.webkitURL,h=document.createElement("a");p=p||b.name||"download",h.download=p,h.rel="noopener",typeof b=="string"?(h.href=b,h.origin===location.origin?i(h):f(h.href)?u(b,p,v):i(h,h.target="_blank")):(h.href=g.createObjectURL(b),setTimeout(function(){g.revokeObjectURL(h.href)},4e4),setTimeout(function(){i(h)},0))}:"msSaveOrOpenBlob"in navigator?function(b,p,v){if(p=p||b.name||"download",typeof b!="string")navigator.msSaveOrOpenBlob(t(b,v),p);else if(f(b))u(b,p,v);else{var g=document.createElement("a");g.href=b,g.target="_blank",setTimeout(function(){i(g)})}}:function(b,p,v,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),typeof b=="string")return u(b,p,v);var h=b.type==="application/octet-stream",w=/constructor/i.test(s.HTMLElement)||s.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||h&&w||n)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var S=x.result;S=o?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=S:location=S,g=null},x.readAsDataURL(b)}else{var m=s.URL||s.webkitURL,j=m.createObjectURL(b);g?g.location=j:location.href=j,g=null,setTimeout(function(){m.revokeObjectURL(j)},4e4)}});s.saveAs=d.saveAs=d,r.exports=d})})(cr);var As=cr.exports;const zs="http://localhost:5000/api",Rs=({workspaceId:r,infraSpec:c,selectedProvider:t,costEstimation:u,onComplete:f,onBack:i})=>{var E,T,H;const[s,n]=K.useState(!0),[d,b]=K.useState(null),[p,v]=K.useState("main.tf"),[g,h]=K.useState([]),[w,o]=K.useState(null),[x,m]=K.useState(!1);K.useEffect(()=>{(async()=>{var N,O,l,P,Q,M,se;try{const W=(N=u.provider_details)==null?void 0:N[t],ae=((O=Object.entries(u.scenarios||{}).find(([R,z])=>{var ee;return((ee=z[t])==null?void 0:ee.monthly_cost)===(W==null?void 0:W.total_monthly_cost)}))==null?void 0:O[0])||"standard";try{const R=await Be.post(`${zs}/workflow/terraform`,{workspace_id:r,infraSpec:c,provider:t,profile:ae,project_name:c.project_name||"cloudiverse-project",requirements:{}});R.data.success&&(R.data.terraform.structure==="modular"?b(R.data.terraform.project):b({"main.tf":R.data.terraform.code}),h(R.data.services||[]))}catch(R){console.warn("Terraform generation failed (non-blocking):",R),console.error("[TERRAFORM ERROR] Full error:",(l=R.response)==null?void 0:l.data);const z=((Q=(P=R.response)==null?void 0:P.data)==null?void 0:Q.message)||R.message||"",ee=((se=(M=R.response)==null?void 0:M.data)==null?void 0:se.details)||"";if(console.error("[TERRAFORM ERROR] Message:",z),console.error("[TERRAFORM ERROR] Details:",ee),z.includes("No template for pattern")||z.includes("not available")||z.includes("under construction"))m(!0),console.log("[TERRAFORM UX] Pattern template not available - showing coming soon message");else{const X=`Failed to generate Terraform code: ${z}${ee?`
`+ee:""}`;o(X)}throw R}}catch(W){console.error("Terraform generation failed:",W),o("Failed to generate Terraform code. Please try again.")}finally{n(!1)}})()},[r,c,t,u]);const j=()=>{if(!d)return"";const Y=p.split("/");let N=d;for(const O of Y)if(typeof N=="object"&&N[O])N=N[O];else return"";return typeof N=="string"?N:""},S=(Y,N="")=>{let O=[];for(const[l,P]of Object.entries(Y)){const Q=N?`${N}/${l}`:l;typeof P=="string"?O.push(Q):typeof P=="object"&&(O=O.concat(S(P,Q)))}return O},k=()=>{const Y=j();navigator.clipboard.writeText(Y),ue.success(`Copied ${p} to clipboard`)},A=async()=>{if(!d)return;const Y=new Es,N=c.project_name||"cloudiverse-project",O=(P,Q)=>{for(const[M,se]of Object.entries(P))if(typeof se=="string")Q.file(M,se);else if(typeof se=="object"){const W=Q.folder(M);O(se,W)}};O(d,Y);const l=await Y.generateAsync({type:"blob"});As.saveAs(l,`${N}-terraform.zip`),ue.success("Downloaded Terraform project as ZIP")};if(s)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generating Infrastructure Code"}),e.jsxs("p",{className:"text-gray-400 mt-2",children:["Creating Terraform configuration for ",t,"..."]})]})]});if(x){const Y=(c==null?void 0:c.architecture_pattern)||((E=c==null?void 0:c.service_classes)==null?void 0:E.pattern_name)||"this pattern";return e.jsx("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in pb-20",children:e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6",children:[e.jsx("div",{className:"text-amber-500 text-6xl material-icons",children:"construction"}),e.jsxs("div",{className:"text-center max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Terraform Generation Coming Soon"}),e.jsxs("p",{className:"text-gray-300 text-lg mb-2",children:["Terraform generation for ",e.jsx("span",{className:"text-primary font-semibold",children:Y})," is not available yet."]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Your architecture and cost estimates are saved and validated. You can continue with manual infrastructure setup or check back later for automated Terraform generation."})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-6 w-full max-w-2xl",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Your Architecture Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Pattern"}),e.jsx("span",{className:"text-white font-semibold",children:Y})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Provider"}),e.jsx("span",{className:"text-white font-semibold",children:t.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Services"}),e.jsx("span",{className:"text-white font-semibold",children:((H=(T=c==null?void 0:c.service_classes)==null?void 0:T.required_services)==null?void 0:H.length)||0})]})]})]}),e.jsxs("button",{onClick:f,className:"mt-6 px-8 py-3 bg-primary hover:bg-primary/90 rounded-xl text-white font-semibold transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"check_circle"}),e.jsx("span",{children:"Continue to Dashboard"})]})]})})}if(w)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsx("div",{className:"text-red-500 text-6xl material-icons",children:"error_outline"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generation Failed"}),e.jsx("p",{className:"text-red-400 mt-2",children:w}),e.jsx("button",{onClick:i,className:"mt-6 px-6 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors",children:"Go Back"})]})]});const D=d?S(d):[],B=j();return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Your Infrastructure Code"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Modular Terraform project for ",t]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:k,className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"content_copy"}),e.jsx("span",{className:"text-sm",children:"Copy File"})]}),e.jsxs("button",{onClick:A,className:"px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg text-primary hover:bg-primary/20 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"download"}),e.jsx("span",{className:"text-sm",children:"Download ZIP"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-1 bg-surface border border-border rounded-xl p-4 max-h-[600px] overflow-y-auto",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Project Files"}),e.jsx("div",{className:"space-y-1",children:D.map(Y=>{const N=Y===p;Y.startsWith("modules/");const O=Y.split("/").pop(),l=(Y.split("/").length-1)*12;return e.jsxs("button",{onClick:()=>v(Y),className:`w-full text-left px-2 py-1.5 rounded text-xs font-mono transition-colors flex items-center space-x-2 ${N?"bg-primary/20 text-primary border border-primary/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,style:{paddingLeft:`${8+l}px`},children:[e.jsx("span",{className:"material-icons text-xs",children:Y.endsWith(".tf")?"description":Y.endsWith(".md")?"article":"insert_drive_file"}),e.jsx("span",{className:"truncate",children:O})]},Y)})})]}),e.jsxs("div",{className:"col-span-3 bg-[#1e1e1e] rounded-xl border border-white/10 overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"flex items-center px-4 py-2 bg-white/5 border-b border-white/5",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500/50"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500/50"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]}),e.jsx("span",{className:"ml-4 text-xs font-mono text-gray-400",children:p})]}),e.jsx("div",{className:"p-4 overflow-x-auto max-h-[550px] overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm text-gray-300 leading-relaxed",children:B||"// Select a file to view"})})]})]}),g.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Included Resources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((Y,N)=>e.jsx("div",{className:"px-3 py-1.5 bg-blue-500/10 border border-blue-500/20 rounded text-xs text-blue-300 font-mono",children:Y.terraform_resource||Y.cloud_service||Y.generic_name||Y},N))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5 mt-8",children:[e.jsxs("button",{onClick:i,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back"})]}),e.jsxs("button",{onClick:f,className:"px-8 py-4 bg-primary hover:bg-primary/90 border border-primary/20 rounded-xl text-black font-bold transition-all flex items-center space-x-3",children:[e.jsx("span",{className:"material-icons",children:"check_circle"}),e.jsx("span",{children:"Continue to Deployment"})]})]})]})},Is=({workspaceId:r,infraSpec:c,costEstimation:t,onNext:u,onBack:f,onRequirementsCaptured:i})=>{const[s,n]=K.useState({nfr:{availability:"99.5",latency:"medium",compliance:[],data_residency:"",cost_ceiling_usd:null,security_level:"standard"},region:{primary_region:"us-east-1",secondary_region:"",multi_region:!1},data_classes:{},data_retention:{},deployment_strategy:"rolling",downtime_allowed:!0,observability:{logs:!0,metrics:!0,alerts:!1}}),[d,b]=K.useState("region"),p=(o,x)=>{n(m=>({...m,region:{...m.region,[o]:x}}))},v=o=>{n(x=>({...x,deployment_strategy:o}))},g=(o,x)=>{n(m=>({...m,observability:{...m.observability,[o]:x}}))},h=()=>{try{if(!s||Object.keys(s).length===0){console.error("Requirements data is empty");return}i&&i(s),u()}catch(o){console.error("Error in handleSubmit:",o)}},w=[{id:"region",label:"Region",icon:"public"},{id:"data",label:"Data",icon:"database"},{id:"deployment",label:"Deployment",icon:"build"},{id:"observability",label:"Monitoring",icon:"monitoring"}];return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"System Requirements"}),e.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Configure region, data, deployment, and monitoring settings for your infrastructure."})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-white/10 pb-4",children:w.map(o=>e.jsxs("button",{onClick:()=>b(o.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center space-x-2 ${d===o.id?"bg-primary/20 text-white border border-primary/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:o.icon}),e.jsx("span",{children:o.label})]},o.id))}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[d==="region"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Region Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Primary Region"}),e.jsxs("select",{value:s.region.primary_region,onChange:o=>p("primary_region",o.target.value),className:"w-full bg-surface border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"us-east-1",children:"US East (N. Virginia)"}),e.jsx("option",{value:"us-west-2",children:"US West (Oregon)"}),e.jsx("option",{value:"eu-west-1",children:"EU (Ireland)"}),e.jsx("option",{value:"eu-central-1",children:"EU (Frankfurt)"}),e.jsx("option",{value:"ap-southeast-1",children:"Asia Pacific (Singapore)"}),e.jsx("option",{value:"ap-northeast-1",children:"Asia Pacific (Tokyo)"}),e.jsx("option",{value:"ca-central-1",children:"Canada (Central)"}),e.jsx("option",{value:"sa-east-1",children:"South America (So Paulo)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Secondary Region (Optional)"}),e.jsxs("select",{value:s.region.secondary_region,onChange:o=>p("secondary_region",o.target.value),className:"w-full bg-surface border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"us-east-1",children:"US East (N. Virginia)"}),e.jsx("option",{value:"us-west-2",children:"US West (Oregon)"}),e.jsx("option",{value:"eu-west-1",children:"EU (Ireland)"}),e.jsx("option",{value:"eu-central-1",children:"EU (Frankfurt)"}),e.jsx("option",{value:"ap-southeast-1",children:"Asia Pacific (Singapore)"}),e.jsx("option",{value:"ap-northeast-1",children:"Asia Pacific (Tokyo)"}),e.jsx("option",{value:"ca-central-1",children:"Canada (Central)"}),e.jsx("option",{value:"sa-east-1",children:"South America (So Paulo)"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-surface/50 rounded-xl border border-border",children:[e.jsx("input",{type:"checkbox",id:"multi-region",checked:s.region.multi_region,onChange:o=>p("multi_region",o.target.checked),className:"w-5 h-5 text-primary bg-surface border-border rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"multi-region",className:"text-white",children:"Enable multi-region deployment for high availability"})]}),s.nfr.compliance.includes("GDPR")&&e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-amber-200 mb-1",children:"Data Residency Notice"}),e.jsx("p",{className:"text-sm text-amber-200/80",children:"GDPR compliance requires data to be stored within EU regions. Primary region must be EU-based."})]})]})})]}),d==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Data Classification & Retention"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Data Classification"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Classify your data types to apply appropriate security measures"}),e.jsx("div",{className:"space-y-4",children:[{type:"user_profiles",label:"User Profiles",desc:"Names, emails, personal preferences, account details"},{type:"payment_data",label:"Payment Data",desc:"Credit cards, billing info, transaction history"},{type:"documents",label:"Documents",desc:"User-uploaded files, images, videos, PDFs"},{type:"logs",label:"System Logs",desc:"Application logs, access logs, error traces"},{type:"analytics",label:"Analytics",desc:"Usage metrics, user behavior, performance data"},{type:"backup",label:"Backup Data",desc:"Backup copies, snapshots, archived data"}].map(o=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:o.label}),e.jsx("div",{className:"text-sm text-gray-400",children:o.desc})]}),e.jsxs("select",{value:s.data_classes[o.type]||"",onChange:x=>n(m=>({...m,data_classes:{...m.data_classes,[o.type]:x.target.value}})),className:"bg-surface border border-border rounded-lg px-3 py-2 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"Unclassified"}),e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"internal",children:"Internal"}),e.jsx("option",{value:"confidential",children:"Confidential"}),e.jsx("option",{value:"restricted",children:"Restricted"})]})]},o.type))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Data Retention"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Define how long different data types should be retained"}),e.jsx("div",{className:"space-y-4",children:[{type:"user_profiles",label:"User Profiles"},{type:"payment_data",label:"Payment Data"},{type:"logs",label:"System Logs"},{type:"analytics",label:"Analytics Data"}].map(o=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsx("div",{children:e.jsx("div",{className:"font-medium text-white",children:o.label})}),e.jsx("input",{type:"text",placeholder:"e.g., 7 years, 90 days",value:s.data_retention[o.type]||"",onChange:x=>n(m=>({...m,data_retention:{...m.data_retention,[o.type]:x.target.value}})),className:"bg-surface border border-border rounded-lg px-3 py-2 text-white focus:outline-none focus:border-primary w-40"})]},o.type))})]})]})]}),d==="deployment"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Deployment Strategy"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white mb-4",children:"Deployment Strategy"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[{value:"rolling",label:"Rolling",desc:"Instances updated gradually, minimal risk"},{value:"blue-green",label:"Blue/Green",desc:"Zero downtime with instant rollback capability"},{value:"canary",label:"Canary",desc:"Test with small traffic before full rollout"},{value:"batch",label:"Batch",desc:"All instances updated at once, fastest but risky"}].map(o=>e.jsxs("div",{onClick:()=>v(o.value),className:`p-4 rounded-xl border cursor-pointer transition-all ${s.deployment_strategy===o.value?"border-primary bg-primary/10 text-white":"border-white/10 text-gray-400 hover:border-white/20 hover:bg-white/5"}`,children:[e.jsx("div",{className:"font-medium",children:o.label}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:o.desc})]},o.value))})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-surface/50 rounded-xl border border-border",children:[e.jsx("input",{type:"checkbox",id:"downtime-allowed",checked:s.downtime_allowed,onChange:o=>n(x=>({...x,downtime_allowed:o.target.checked})),className:"w-5 h-5 text-primary bg-surface border-border rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"downtime-allowed",className:"text-white",children:"Downtime is allowed during deployment"})]}),e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-blue-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-200 mb-1",children:"Strategy Recommendations"}),e.jsxs("p",{className:"text-sm text-blue-200/80",children:[" High availability systems: Blue/Green or Canary",e.jsx("br",{})," Development systems: Rolling",e.jsx("br",{})," Batch: Only for non-critical systems"]})]})]})})]})]}),d==="observability"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Observability & Monitoring"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Application Logging"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Capture application and system logs"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.logs,onChange:o=>g("logs",o.target.checked),className:"sr-only",id:"logs-toggle"}),e.jsx("label",{htmlFor:"logs-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.logs?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.logs?"transform translate-x-6":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Infrastructure Metrics"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Monitor CPU, memory, disk, and network"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.metrics,onChange:o=>g("metrics",o.target.checked),className:"sr-only",id:"metrics-toggle"}),e.jsx("label",{htmlFor:"metrics-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.metrics?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.metrics?"transform translate-x-6":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface/30 rounded-xl border border-border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Alerting System"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Get notified of issues and anomalies"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s.observability.alerts,onChange:o=>g("alerts",o.target.checked),className:"sr-only",id:"alerts-toggle"}),e.jsx("label",{htmlFor:"alerts-toggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors ${s.observability.alerts?"bg-primary":"bg-gray-600"}`,children:e.jsx("span",{className:`absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${s.observability.alerts?"transform translate-x-6":""}`})})]})]})]}),e.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-green-400 text-sm mt-0.5",children:"info"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-green-200 mb-1",children:"Observability Benefits"}),e.jsx("p",{className:"text-sm text-green-200/80",children:"Monitoring and logging are essential for production systems. They help identify issues before they impact users."})]})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back"})]}),e.jsxs("button",{onClick:h,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Continue to Architecture"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]})},dr=({id:r,x:c,y:t,width:u,height:f,style:i,color:s,strokeColor:n,strokeWidth:d,className:b,borderRadius:p,shapeRendering:v,onClick:g,selected:h})=>{const{background:w,backgroundColor:o}=i||{},x=s||w||o;return Le.createElement("rect",{className:Qt(["react-flow__minimap-node",{selected:h},b]),x:c,y:t,rx:p,ry:p,width:u,height:f,fill:x,stroke:n,strokeWidth:d,shapeRendering:v,onClick:g?m=>g(m,r):void 0})};dr.displayName="MiniMapNode";var Os=K.memo(dr);const Fs=r=>r.nodeOrigin,Ts=r=>r.getNodes().filter(c=>!c.hidden&&c.width&&c.height),yt=r=>r instanceof Function?r:()=>r;function Bs({nodeStrokeColor:r="transparent",nodeColor:c="#e2e2e2",nodeClassName:t="",nodeBorderRadius:u=5,nodeStrokeWidth:f=2,nodeComponent:i=Os,onClick:s}){const n=wt(Ts,er),d=wt(Fs),b=yt(c),p=yt(r),v=yt(t),g=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Le.createElement(Le.Fragment,null,n.map(h=>{const{x:w,y:o}=zr(h,d).positionAbsolute;return Le.createElement(i,{key:h.id,x:w,y:o,width:h.width,height:h.height,style:h.style,selected:h.selected,className:v(h),color:b(h),borderRadius:u,strokeColor:p(h),strokeWidth:f,shapeRendering:g,onClick:s,id:h.id})}))}var Ds=K.memo(Bs);const Ps=200,Us=150,$s=r=>{const c=r.getNodes(),t={x:-r.transform[0]/r.transform[2],y:-r.transform[1]/r.transform[2],width:r.width/r.transform[2],height:r.height/r.transform[2]};return{viewBB:t,boundingRect:c.length>0?Rr(Ir(c,r.nodeOrigin),t):t,rfId:r.rfId}},Ls="react-flow__minimap-desc";function ur({style:r,className:c,nodeStrokeColor:t="transparent",nodeColor:u="#e2e2e2",nodeClassName:f="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:n,maskColor:d="rgb(240, 240, 240, 0.6)",maskStrokeColor:b="none",maskStrokeWidth:p=1,position:v="bottom-right",onClick:g,onNodeClick:h,pannable:w=!1,zoomable:o=!1,ariaLabel:x="React Flow mini map",inversePan:m=!1,zoomStep:j=10,offsetScale:S=5}){const k=Nr(),A=K.useRef(null),{boundingRect:D,viewBB:B,rfId:E}=wt($s,er),T=(r==null?void 0:r.width)??Ps,H=(r==null?void 0:r.height)??Us,Y=D.width/T,N=D.height/H,O=Math.max(Y,N),l=O*T,P=O*H,Q=S*O,M=D.x-(l-D.width)/2-Q,se=D.y-(P-D.height)/2-Q,W=l+Q*2,ae=P+Q*2,R=`${Ls}-${E}`,z=K.useRef(0);z.current=O,K.useEffect(()=>{if(A.current){const G=kr(A.current),me=oe=>{const{transform:ye,d3Selection:pe,d3Zoom:Ne}=k.getState();if(oe.sourceEvent.type!=="wheel"||!pe||!Ne)return;const Ee=-oe.sourceEvent.deltaY*(oe.sourceEvent.deltaMode===1?.05:oe.sourceEvent.deltaMode?1:.002)*j,a=ye[2]*Math.pow(2,Ee);Ne.scaleTo(pe,a)},be=oe=>{const{transform:ye,d3Selection:pe,d3Zoom:Ne,translateExtent:Ee,width:a,height:U}=k.getState();if(oe.sourceEvent.type!=="mousemove"||!pe||!Ne)return;const F=z.current*Math.max(1,ye[2])*(m?-1:1),_={x:ye[0]-oe.sourceEvent.movementX*F,y:ye[1]-oe.sourceEvent.movementY*F},y=[[0,0],[a,U]],C=Er.translate(_.x,_.y).scale(ye[2]),$=Ne.constrain()(C,y,Ee);Ne.transform(pe,$)},ie=Sr().on("zoom",w?be:null).on("zoom.wheel",o?me:null);return G.call(ie),()=>{G.on("zoom",null)}}},[w,o,m,j]);const ee=g?G=>{const me=Ar(G);g(G,{x:me[0],y:me[1]})}:void 0,X=h?(G,me)=>{const be=k.getState().nodeInternals.get(me);h(G,be)}:void 0;return Le.createElement(Cr,{position:v,style:r,className:Qt(["react-flow__minimap",c]),"data-testid":"rf__minimap"},Le.createElement("svg",{width:T,height:H,viewBox:`${M} ${se} ${W} ${ae}`,role:"img","aria-labelledby":R,ref:A,onClick:ee},x&&Le.createElement("title",{id:R},x),Le.createElement(Ds,{onClick:X,nodeColor:u,nodeStrokeColor:t,nodeBorderRadius:i,nodeClassName:f,nodeStrokeWidth:s,nodeComponent:n}),Le.createElement("path",{className:"react-flow__minimap-mask",d:`M${M-Q},${se-Q}h${W+Q*2}v${ae+Q*2}h${-W-Q*2}z
        M${B.x},${B.y}h${B.width}v${B.height}h${-B.width}z`,fill:d,fillRule:"evenodd",stroke:b,strokeWidth:p,pointerEvents:"none"})))}ur.displayName="MiniMap";var Ms=K.memo(ur);function Ws(r,c){if(r.match(/^[a-z]+:\/\//i))return r;if(r.match(/^\/\//))return window.location.protocol+r;if(r.match(/^[a-z]+:/i))return r;const t=document.implementation.createHTMLDocument(),u=t.createElement("base"),f=t.createElement("a");return t.head.appendChild(u),t.body.appendChild(f),c&&(u.href=c),f.href=r,f.href}const Zs=(()=>{let r=0;const c=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(r+=1,`u${c()}${r}`)})();function qe(r){const c=[];for(let t=0,u=r.length;t<u;t++)c.push(r[t]);return c}let Qe=null;function hr(r={}){return Qe||(r.includeStyleProperties?(Qe=r.includeStyleProperties,Qe):(Qe=qe(window.getComputedStyle(document.documentElement)),Qe))}function ht(r,c){const u=(r.ownerDocument.defaultView||window).getComputedStyle(r).getPropertyValue(c);return u?parseFloat(u.replace("px","")):0}function Hs(r){const c=ht(r,"border-left-width"),t=ht(r,"border-right-width");return r.clientWidth+c+t}function Gs(r){const c=ht(r,"border-top-width"),t=ht(r,"border-bottom-width");return r.clientHeight+c+t}function fr(r,c={}){const t=c.width||Hs(r),u=c.height||Gs(r);return{width:t,height:u}}function qs(){let r,c;try{c=process}catch{}const t=c&&c.env?c.env.devicePixelRatio:null;return t&&(r=parseInt(t,10),Number.isNaN(r)&&(r=1)),r||window.devicePixelRatio||1}const Fe=16384;function Vs(r){(r.width>Fe||r.height>Fe)&&(r.width>Fe&&r.height>Fe?r.width>r.height?(r.height*=Fe/r.width,r.width=Fe):(r.width*=Fe/r.height,r.height=Fe):r.width>Fe?(r.height*=Fe/r.width,r.width=Fe):(r.width*=Fe/r.height,r.height=Fe))}function ft(r){return new Promise((c,t)=>{const u=new Image;u.onload=()=>{u.decode().then(()=>{requestAnimationFrame(()=>c(u))})},u.onerror=t,u.crossOrigin="anonymous",u.decoding="async",u.src=r})}async function Ys(r){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(r)).then(encodeURIComponent).then(c=>`data:image/svg+xml;charset=utf-8,${c}`)}async function Ks(r,c,t){const u="http://www.w3.org/2000/svg",f=document.createElementNS(u,"svg"),i=document.createElementNS(u,"foreignObject");return f.setAttribute("width",`${c}`),f.setAttribute("height",`${t}`),f.setAttribute("viewBox",`0 0 ${c} ${t}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),f.appendChild(i),i.appendChild(r),Ys(f)}const Ie=(r,c)=>{if(r instanceof c)return!0;const t=Object.getPrototypeOf(r);return t===null?!1:t.constructor.name===c.name||Ie(t,c)};function Xs(r){const c=r.getPropertyValue("content");return`${r.cssText} content: '${c.replace(/'|"/g,"")}';`}function Js(r,c){return hr(c).map(t=>{const u=r.getPropertyValue(t),f=r.getPropertyPriority(t);return`${t}: ${u}${f?" !important":""};`}).join(" ")}function Qs(r,c,t,u){const f=`.${r}:${c}`,i=t.cssText?Xs(t):Js(t,u);return document.createTextNode(`${f}{${i}}`)}function Gt(r,c,t,u){const f=window.getComputedStyle(r,t),i=f.getPropertyValue("content");if(i===""||i==="none")return;const s=Zs();try{c.className=`${c.className} ${s}`}catch{return}const n=document.createElement("style");n.appendChild(Qs(s,t,f,u)),c.appendChild(n)}function ea(r,c,t){Gt(r,c,":before",t),Gt(r,c,":after",t)}const qt="application/font-woff",Vt="image/jpeg",ta={woff:qt,woff2:qt,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Vt,jpeg:Vt,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ra(r){const c=/\.([^./]*?)$/g.exec(r);return c?c[1]:""}function Ct(r){const c=ra(r).toLowerCase();return ta[c]||""}function sa(r){return r.split(/,/)[1]}function Nt(r){return r.search(/^(data:)/)!==-1}function aa(r,c){return`data:${c};base64,${r}`}async function mr(r,c,t){const u=await fetch(r,c);if(u.status===404)throw new Error(`Resource "${u.url}" not found`);const f=await u.blob();return new Promise((i,s)=>{const n=new FileReader;n.onerror=s,n.onloadend=()=>{try{i(t({res:u,result:n.result}))}catch(d){s(d)}},n.readAsDataURL(f)})}const vt={};function na(r,c,t){let u=r.replace(/\?.*/,"");return t&&(u=r),/ttf|otf|eot|woff2?/i.test(u)&&(u=u.replace(/.*\//,"")),c?`[${c}]${u}`:u}async function Et(r,c,t){const u=na(r,c,t.includeQueryParams);if(vt[u]!=null)return vt[u];t.cacheBust&&(r+=(/\?/.test(r)?"&":"?")+new Date().getTime());let f;try{const i=await mr(r,t.fetchRequestInit,({res:s,result:n})=>(c||(c=s.headers.get("Content-Type")||""),sa(n)));f=aa(i,c)}catch(i){f=t.imagePlaceholder||"";let s=`Failed to fetch resource: ${r}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return vt[u]=f,f}async function ia(r){const c=r.toDataURL();return c==="data:,"?r.cloneNode(!1):ft(c)}async function oa(r,c){if(r.currentSrc){const i=document.createElement("canvas"),s=i.getContext("2d");i.width=r.clientWidth,i.height=r.clientHeight,s==null||s.drawImage(r,0,0,i.width,i.height);const n=i.toDataURL();return ft(n)}const t=r.poster,u=Ct(t),f=await Et(t,u,c);return ft(f)}async function la(r,c){var t;try{if(!((t=r==null?void 0:r.contentDocument)===null||t===void 0)&&t.body)return await xt(r.contentDocument.body,c,!0)}catch{}return r.cloneNode(!1)}async function ca(r,c){return Ie(r,HTMLCanvasElement)?ia(r):Ie(r,HTMLVideoElement)?oa(r,c):Ie(r,HTMLIFrameElement)?la(r,c):r.cloneNode(pr(r))}const da=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SLOT",pr=r=>r.tagName!=null&&r.tagName.toUpperCase()==="SVG";async function ua(r,c,t){var u,f;if(pr(c))return c;let i=[];return da(r)&&r.assignedNodes?i=qe(r.assignedNodes()):Ie(r,HTMLIFrameElement)&&(!((u=r.contentDocument)===null||u===void 0)&&u.body)?i=qe(r.contentDocument.body.childNodes):i=qe(((f=r.shadowRoot)!==null&&f!==void 0?f:r).childNodes),i.length===0||Ie(r,HTMLVideoElement)||await i.reduce((s,n)=>s.then(()=>xt(n,t)).then(d=>{d&&c.appendChild(d)}),Promise.resolve()),c}function ha(r,c,t){const u=c.style;if(!u)return;const f=window.getComputedStyle(r);f.cssText?(u.cssText=f.cssText,u.transformOrigin=f.transformOrigin):hr(t).forEach(i=>{let s=f.getPropertyValue(i);i==="font-size"&&s.endsWith("px")&&(s=`${Math.floor(parseFloat(s.substring(0,s.length-2)))-.1}px`),Ie(r,HTMLIFrameElement)&&i==="display"&&s==="inline"&&(s="block"),i==="d"&&c.getAttribute("d")&&(s=`path(${c.getAttribute("d")})`),u.setProperty(i,s,f.getPropertyPriority(i))})}function fa(r,c){Ie(r,HTMLTextAreaElement)&&(c.innerHTML=r.value),Ie(r,HTMLInputElement)&&c.setAttribute("value",r.value)}function ma(r,c){if(Ie(r,HTMLSelectElement)){const t=c,u=Array.from(t.children).find(f=>r.value===f.getAttribute("value"));u&&u.setAttribute("selected","")}}function pa(r,c,t){return Ie(c,Element)&&(ha(r,c,t),ea(r,c,t),fa(r,c),ma(r,c)),c}async function xa(r,c){const t=r.querySelectorAll?r.querySelectorAll("use"):[];if(t.length===0)return r;const u={};for(let i=0;i<t.length;i++){const n=t[i].getAttribute("xlink:href");if(n){const d=r.querySelector(n),b=document.querySelector(n);!d&&b&&!u[n]&&(u[n]=await xt(b,c,!0))}}const f=Object.values(u);if(f.length){const i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";const n=document.createElementNS(i,"defs");s.appendChild(n);for(let d=0;d<f.length;d++)n.appendChild(f[d]);r.appendChild(s)}return r}async function xt(r,c,t){return!t&&c.filter&&!c.filter(r)?null:Promise.resolve(r).then(u=>ca(u,c)).then(u=>ua(r,u,c)).then(u=>pa(r,u,c)).then(u=>xa(u,c))}const xr=/url\((['"]?)([^'"]+?)\1\)/g,ga=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ba=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ya(r){const c=r.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${c})(['"]?\\))`,"g")}function va(r){const c=[];return r.replace(xr,(t,u,f)=>(c.push(f),t)),c.filter(t=>!Nt(t))}async function wa(r,c,t,u,f){try{const i=t?Ws(c,t):c,s=Ct(c);let n;return f||(n=await Et(i,s,u)),r.replace(ya(c),`$1${n}$3`)}catch{}return r}function _a(r,{preferredFontFormat:c}){return c?r.replace(ba,t=>{for(;;){const[u,,f]=ga.exec(t)||[];if(!f)return"";if(f===c)return`src: ${u};`}}):r}function gr(r){return r.search(xr)!==-1}async function br(r,c,t){if(!gr(r))return r;const u=_a(r,t);return va(u).reduce((i,s)=>i.then(n=>wa(n,s,c,t)),Promise.resolve(u))}async function et(r,c,t){var u;const f=(u=c.style)===null||u===void 0?void 0:u.getPropertyValue(r);if(f){const i=await br(f,null,t);return c.style.setProperty(r,i,c.style.getPropertyPriority(r)),!0}return!1}async function ja(r,c){await et("background",r,c)||await et("background-image",r,c),await et("mask",r,c)||await et("-webkit-mask",r,c)||await et("mask-image",r,c)||await et("-webkit-mask-image",r,c)}async function Na(r,c){const t=Ie(r,HTMLImageElement);if(!(t&&!Nt(r.src))&&!(Ie(r,SVGImageElement)&&!Nt(r.href.baseVal)))return;const u=t?r.src:r.href.baseVal,f=await Et(u,Ct(u),c);await new Promise((i,s)=>{r.onload=i,r.onerror=c.onImageErrorHandler?(...d)=>{try{i(c.onImageErrorHandler(...d))}catch(b){s(b)}}:s;const n=r;n.decode&&(n.decode=i),n.loading==="lazy"&&(n.loading="eager"),t?(r.srcset="",r.src=f):r.href.baseVal=f})}async function ka(r,c){const u=qe(r.childNodes).map(f=>yr(f,c));await Promise.all(u).then(()=>r)}async function yr(r,c){Ie(r,Element)&&(await ja(r,c),await Na(r,c),await ka(r,c))}function Sa(r,c){const{style:t}=r;c.backgroundColor&&(t.backgroundColor=c.backgroundColor),c.width&&(t.width=`${c.width}px`),c.height&&(t.height=`${c.height}px`);const u=c.style;return u!=null&&Object.keys(u).forEach(f=>{t[f]=u[f]}),r}const Yt={};async function Kt(r){let c=Yt[r];if(c!=null)return c;const u=await(await fetch(r)).text();return c={url:r,cssText:u},Yt[r]=c,c}async function Xt(r,c){let t=r.cssText;const u=/url\(["']?([^"')]+)["']?\)/g,i=(t.match(/url\([^)]+\)/g)||[]).map(async s=>{let n=s.replace(u,"$1");return n.startsWith("https://")||(n=new URL(n,r.url).href),mr(n,c.fetchRequestInit,({result:d})=>(t=t.replace(s,`url(${d})`),[s,d]))});return Promise.all(i).then(()=>t)}function Jt(r){if(r==null)return[];const c=[],t=/(\/\*[\s\S]*?\*\/)/gi;let u=r.replace(t,"");const f=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=f.exec(u);if(d===null)break;c.push(d[0])}u=u.replace(f,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",n=new RegExp(s,"gi");for(;;){let d=i.exec(u);if(d===null){if(d=n.exec(u),d===null)break;i.lastIndex=n.lastIndex}else n.lastIndex=i.lastIndex;c.push(d[0])}return c}async function Ca(r,c){const t=[],u=[];return r.forEach(f=>{if("cssRules"in f)try{qe(f.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let n=s+1;const d=i.href,b=Kt(d).then(p=>Xt(p,c)).then(p=>Jt(p).forEach(v=>{try{f.insertRule(v,v.startsWith("@import")?n+=1:f.cssRules.length)}catch(g){console.error("Error inserting rule from remote css",{rule:v,error:g})}})).catch(p=>{console.error("Error loading remote css",p.toString())});u.push(b)}})}catch(i){const s=r.find(n=>n.href==null)||document.styleSheets[0];f.href!=null&&u.push(Kt(f.href).then(n=>Xt(n,c)).then(n=>Jt(n).forEach(d=>{s.insertRule(d,s.cssRules.length)})).catch(n=>{console.error("Error loading remote stylesheet",n)})),console.error("Error inlining remote css file",i)}}),Promise.all(u).then(()=>(r.forEach(f=>{if("cssRules"in f)try{qe(f.cssRules||[]).forEach(i=>{t.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${f.href}`,i)}}),t))}function Ea(r){return r.filter(c=>c.type===CSSRule.FONT_FACE_RULE).filter(c=>gr(c.style.getPropertyValue("src")))}async function Aa(r,c){if(r.ownerDocument==null)throw new Error("Provided element is not within a Document");const t=qe(r.ownerDocument.styleSheets),u=await Ca(t,c);return Ea(u)}function vr(r){return r.trim().replace(/["']/g,"")}function za(r){const c=new Set;function t(u){(u.style.fontFamily||getComputedStyle(u).fontFamily).split(",").forEach(i=>{c.add(vr(i))}),Array.from(u.children).forEach(i=>{i instanceof HTMLElement&&t(i)})}return t(r),c}async function Ra(r,c){const t=await Aa(r,c),u=za(r);return(await Promise.all(t.filter(i=>u.has(vr(i.style.fontFamily))).map(i=>{const s=i.parentStyleSheet?i.parentStyleSheet.href:null;return br(i.cssText,s,c)}))).join(`
`)}async function Ia(r,c){const t=c.fontEmbedCSS!=null?c.fontEmbedCSS:c.skipFonts?null:await Ra(r,c);if(t){const u=document.createElement("style"),f=document.createTextNode(t);u.appendChild(f),r.firstChild?r.insertBefore(u,r.firstChild):r.appendChild(u)}}async function Oa(r,c={}){const{width:t,height:u}=fr(r,c),f=await xt(r,c,!0);return await Ia(f,c),await yr(f,c),Sa(f,c),await Ks(f,t,u)}async function Fa(r,c={}){const{width:t,height:u}=fr(r,c),f=await Oa(r,c),i=await ft(f),s=document.createElement("canvas"),n=s.getContext("2d"),d=c.pixelRatio||qs(),b=c.canvasWidth||t,p=c.canvasHeight||u;return s.width=b*d,s.height=p*d,c.skipAutoScale||Vs(s),s.style.width=`${b}`,s.style.height=`${p}`,c.backgroundColor&&(n.fillStyle=c.backgroundColor,n.fillRect(0,0,s.width,s.height)),n.drawImage(i,0,0,s.width,s.height),s}async function Ta(r,c={}){return(await Fa(r,c)).toDataURL()}const kt={client:{bg:"#4B5563",border:"#9CA3AF",text:"#F9FAFB"},network:{bg:"#1E40AF",border:"#3B82F6",text:"#DBEAFE"},compute:{bg:"#7C3AED",border:"#A78BFA",text:"#EDE9FE"},database:{bg:"#059669",border:"#10B981",text:"#D1FAE5"},storage:{bg:"#DC2626",border:"#EF4444",text:"#FEE2E2"},security:{bg:"#EA580C",border:"#F97316",text:"#FFEDD5"},messaging:{bg:"#DB2777",border:"#EC4899",text:"#FCE7F3"},observability:{bg:"#0891B2",border:"#06B6D4",text:"#CFFAFE"},integration:{bg:"#65A30D",border:"#84CC16",text:"#ECFCCB"},other:{bg:"#6B7280",border:"#9CA3AF",text:"#F3F4F6"}},Ba={client:"",cdn:"",load_balancer:"",api_gateway:"",websocket_gateway:"",app_compute:"",serverless_compute:"",compute_container:"",compute_vm:"",batch_compute:"",ml_inference_service:"",relational_database:"",nosql_database:"",analytical_database:"",cache:"",object_storage:"",block_storage:"",identity_auth:"",message_queue:"",messaging_queue:"",event_bus:"",logging:"",monitoring:"",payment_gateway:"",push_notification_service:"",secrets_management:"",networking:""};function Da(r,c,t="LR"){const u=new Zt.graphlib.Graph;return u.setDefaultEdgeLabel(()=>({})),u.setGraph({rankdir:t,nodesep:100,ranksep:150,marginx:50,marginy:50}),r.forEach(i=>{u.setNode(i.id,{width:200,height:80})}),c.forEach(i=>{u.setEdge(i.source,i.target)}),Zt.layout(u),{nodes:r.map(i=>{const s=u.node(i.id);return{...i,position:{x:s.x-100,y:s.y-40}}}),edges:c}}function Pa(r){if(!(r!=null&&r.architecture))return{nodes:[],edges:[]};const{nodes:c=[],edges:t=[]}=r.architecture,u=c.map(i=>{const s=i.category||"other",n=kt[s]||kt.other,d=Ba[i.type]||"";return{id:i.id,type:"default",data:{label:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-1 p-3",children:[e.jsx("div",{className:"text-2xl",children:d}),e.jsx("div",{className:"text-xs font-bold text-center leading-tight",style:{color:n.text},children:i.label}),i.role&&e.jsx("div",{className:"text-[9px] opacity-70 italic",style:{color:n.text},children:i.role.replace(/_/g," ")})]})},position:{x:0,y:0},style:{background:n.bg,border:`2px solid ${n.border}`,borderRadius:"12px",padding:"8px",width:200,height:80,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 12px ${n.border}40`},draggable:!1}}),f=t.map((i,s)=>({id:`edge-${s}`,source:i.from,target:i.to,label:i.label||"",type:"smoothstep",animated:!0,style:{stroke:"#6B7280",strokeWidth:2},labelStyle:{fill:"#9CA3AF",fontSize:11,fontWeight:600},labelBgStyle:{fill:"#1F2937",fillOpacity:.8}}));return{nodes:u,edges:f}}const Ua=({architectureData:r,provider:c,pattern:t})=>{const{nodes:u,edges:f}=K.useMemo(()=>Pa(r),[r]),{nodes:i,edges:s}=K.useMemo(()=>Da(u,f),[u,f]),[n,d,b]=Or(i),[p,v,g]=Fr(s),h=K.useCallback(()=>{const w=document.querySelector(".react-flow");if(!w){console.error("Diagram element not found");return}Ta(w,{backgroundColor:"#0F172A",width:w.offsetWidth,height:w.offsetHeight,style:{width:`${w.offsetWidth}px`,height:`${w.offsetHeight}px`}}).then(o=>{const x=document.createElement("a");x.download=`architecture-${c}-${t}-${Date.now()}.png`,x.href=o,x.click()}).catch(o=>{console.error("Failed to export diagram:",o),alert("Failed to export diagram. Please try again.")})},[c,t]);return n.length===0?e.jsx("div",{className:"bg-black/20 rounded-xl p-12 min-h-[500px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("span",{className:"material-icons text-gray-500 text-6xl",children:"cloud_off"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No architecture data available"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:h,className:"px-4 py-2 bg-primary/20 border border-primary/40 text-primary rounded-lg hover:bg-primary/30 transition-colors flex items-center space-x-2 text-sm font-semibold",children:[e.jsx("span",{className:"material-icons text-lg",children:"download"}),e.jsx("span",{children:"Download PNG"})]})}),e.jsx("div",{className:"bg-[#0F172A] rounded-xl border border-white/10 overflow-hidden",style:{height:"600px"},children:e.jsxs(Tr,{nodes:n,edges:p,onNodesChange:b,onEdgesChange:g,fitView:!0,fitViewOptions:{padding:.2},minZoom:.5,maxZoom:2,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnDrag:!0,zoomOnScroll:!0,preventScrolling:!0,children:[e.jsx(Br,{color:"#1E293B",gap:20,size:1}),e.jsx(Dr,{showInteractive:!1,style:{background:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(Ms,{nodeColor:w=>(w.style||{}).background||"#6B7280",maskColor:"#0F172A99",style:{background:"#1F2937",border:"1px solid #374151",borderRadius:"8px"}})]})}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Service Categories"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(kt).map(([w,o])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{background:o.bg,border:`2px solid ${o.border}`}}),e.jsx("span",{className:"text-xs text-gray-300 capitalize",children:w})]},w))})]})]})},$a="http://localhost:5000/api",La=({workspaceId:r,infraSpec:c,costEstimation:t,selectedProvider:u,selectedProfile:f,usageProfile:i,requirementsData:s,architectureData:n,onArchitectureDataLoaded:d,onNext:b,onBack:p})=>{var o;const[v,g]=K.useState(!0),[h,w]=K.useState(null);return K.useEffect(()=>{(async()=>{if(!(!c||!u||!f))try{const m=localStorage.getItem("token"),j=m?{Authorization:`Bearer ${m}`}:{},S=await Be.post(`${$a}/workflow/architecture`,{workspace_id:r,infraSpec:c,provider:u,profile:f,usage_profile:(i==null?void 0:i.usage_profile)||{},intent:(c==null?void 0:c.locked_intent)||{},requirements:s||{}},{headers:j});if(!S.data||!S.data.data)throw new Error("Invalid response structure from architecture endpoint");d&&d(S.data.data),w(null)}catch(m){console.error("Architecture loading error:",m),w("Failed to load architecture diagram. Using fallback view."),ue.error("Failed to load architecture diagram")}finally{g(!1)}})()},[r,c,u,f,i,s,d]),h?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design"}),e.jsx("p",{className:"text-gray-400",children:"Architecture diagram could not be loaded, but you can continue to Terraform generation."})]}),e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"warning"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-200 mb-1",children:"Architecture Not Available"}),e.jsx("p",{className:"text-sm text-amber-200/80",children:"The architecture diagram could not be generated, but your infrastructure specification is ready for Terraform generation."})]})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:p,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Cost"})]}),e.jsxs("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Continue to Feedback"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]}):v&&!n?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design Confirmation"}),e.jsx("p",{className:"text-gray-400",children:"Generating your cloud architecture diagram..."})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsx("p",{className:"text-xl font-semibold text-white",children:"Generating Architecture"}),e.jsx("p",{className:"text-gray-400",children:"Creating your provider-specific diagram..."})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-fade-in pb-20",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Architecture Design Confirmation"}),e.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"This architecture reflects the recommended setup based on your requirements and usage."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Provider"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold
                            ${u==="AWS"?"bg-[#FF9900]/20 text-[#FF9900]":u==="GCP"?"bg-[#4285F4]/20 text-[#4285F4]":"bg-[#0078D4]/20 text-[#0078D4]"}`,children:u==="AWS"?"AWS":u==="GCP"?"GCP":"AZ"}),e.jsx("div",{children:e.jsx("div",{className:"font-bold text-white text-lg",children:u==="AZURE"?"Azure":u})})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-2",children:"Scenario"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/20 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-primary",children:"tune"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white text-lg capitalize",children:f==null?void 0:f.replace("_"," ")}),e.jsx("div",{className:"text-xs text-gray-400",children:"Cost optimization profile"})]})]})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"design_services"}),"Architecture Diagram"]}),e.jsx(Ua,{architectureData:n,provider:u,pattern:(c==null?void 0:c.architecture_pattern)||"SERVERLESS_WEB_APP"}),e.jsx("div",{className:"text-xs text-gray-500 mt-4 text-center italic",children:'Interactive architecture diagram. Use mouse wheel to zoom, drag to pan. Click "Download PNG" to export.'})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"inventory"}),"Services Used (",u==="AZURE"?"Azure":u,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(o=n==null?void 0:n.services)==null?void 0:o.map((x,m)=>{var j;return e.jsx("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:x.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:x.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 capitalize",children:[x.category," service"]})]}),e.jsx("div",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full capitalize",children:(j=x.type)==null?void 0:j.replace("_"," ")})]})},m)})})]}),(n==null?void 0:n.notes)&&e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-6 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"sticky_note_2"}),"Architecture Notes"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.notes.map((x,m)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-primary text-sm mt-0.5",children:"info"}),e.jsx("p",{className:"text-sm text-gray-300",children:x})]},m))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:p,className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Cost"})]}),e.jsxs("button",{onClick:b,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Confirm Architecture"}),e.jsx("span",{className:"material-icons",children:"arrow_forward"})]})]})]})},Xe="http://localhost:5000",qa=()=>{var F,_,y,C,$,Z,I,q,J,V,re,xe,ce,Ae,We,Oe,Ze,we,Ye,Je,Te,tt,nt,it,ot,rt,He,Ke,At,zt,Rt,It,Ot,Ft,Tt,Bt,Dt,Pt,Ut,$t,Lt,Mt,Wt;const{id:r}=_r(),c=jr(),[t,u]=K.useState("input"),[f,i]=K.useState(""),[s,n]=K.useState([]),[d,b]=K.useState(null),[p,v]=K.useState(null),[g,h]=K.useState(null),[w,o]=K.useState(!1),[x,m]=K.useState(null),[j,S]=K.useState(!1),[k,A]=K.useState(null),[D,B]=K.useState(null),[E,T]=K.useState(null),[H,Y]=K.useState("cost_effective"),[N,O]=K.useState(r==="new"?null:r),[l,P]=K.useState(null),[Q,M]=K.useState(null),[se,W]=K.useState(!1),[ae,R]=K.useState(null),[z,ee]=K.useState(!1),[X,G]=K.useState(!1),[me,be]=K.useState(!1),[ie,oe]=K.useState("");K.useEffect(()=>{E&&ie&&f!==ie?G(!0):E&&ie&&f===ie&&G(!1)},[f,ie,E]);const ye=async()=>{if(k){console.log("Usage profile already exists, skipping redundant AI call."),u("usage_review");return}o(!0),u("processing_usage");try{const L=localStorage.getItem("token"),te=L?{Authorization:`Bearer ${L}`}:{},le=await Be.post(`${Xe}/api/workflow/predict-usage`,{intent:D,infraSpec:p},{headers:te});setTimeout(()=>{A(le.data.data),u("usage_review"),o(!1),ue.success("Usage estimates generated!")},1e3)}catch(L){console.error("Usage Prediction Error:",L),o(!1),u("review_spec"),ue.error("Failed to estimate usage. Skipping to manual mode.")}},pe=async()=>{var L,te,le,fe,ge,ve,Se,Re,_e,ke,he;if(!p||!D){ue.error("Missing infrastructure data. Please restart.");return}o(!0),u("processing_cost"),ue.loading("Analyzing costs across providers...",{id:"cost-analysis"});try{const de=localStorage.getItem("token"),ne=de?{Authorization:`Bearer ${de}`}:{},je={infraSpec:p,intent:D,cost_profile:H,usage_profile:{...k==null?void 0:k.usage_profile,source:me?"user_provided":"ai_inferred"}};G(!1),oe(f);const De=await Be.post(`${Xe}/api/workflow/cost-analysis`,je,{headers:ne});if(ue.dismiss("cost-analysis"),De.data.step==="cost_estimation")setTimeout(()=>{var st;const ze=De.data.data;T(ze),P(((st=ze.recommended)==null?void 0:st.provider)||ze.recommended_provider),u("cost_estimation"),ue.success("Cost analysis complete!")},100);else throw new Error("Unexpected response from cost analysis")}catch(de){console.error("[COST ANALYSIS ERROR]",de),ue.dismiss("cost-analysis"),u("usage_review");let ne="Failed to analyze costs.";((L=de.response)==null?void 0:L.status)===400?ne=((le=(te=de.response)==null?void 0:te.data)==null?void 0:le.msg)||"Invalid infrastructure data. Please review your architecture.":((fe=de.response)==null?void 0:fe.status)===401?(ne="Session expired. Please login again.",setTimeout(()=>c("/"),1500)):((ge=de.response)==null?void 0:ge.status)===500?ne=((Se=(ve=de.response)==null?void 0:ve.data)==null?void 0:Se.error)||"Server error during cost calculation. Please try again.":de.code==="ECONNABORTED"?ne="Cost analysis timed out. Please try again.":de.response?ne=((_e=(Re=de.response)==null?void 0:Re.data)==null?void 0:_e.msg)||((he=(ke=de.response)==null?void 0:ke.data)==null?void 0:he.error)||ne:ne="Cannot reach cost analysis service. Check your connection.",ue.error(ne,{duration:6e3,icon:""})}finally{o(!1)}};K.useEffect(()=>{(async()=>{var te,le,fe,ge;if(r)try{const ve=localStorage.getItem("token"),Se=ve?{Authorization:`Bearer ${ve}`}:{},_e=(await Be.get(`${Xe}/api/workspaces/${r}`,{headers:Se})).data;if(((((le=(te=_e.state_json)==null?void 0:te.deployment)==null?void 0:le.status)||_e.step)==="active"||_e.step==="active_deployment")&&(ee(!0),console.log("[WORKSPACE] Deployed workspace - editing disabled")),O(_e.id),h({id:_e.project_id,name:_e.name}),_e.state_json){const he=_e.state_json;let de=he.step||_e.step||"input";de==="confirm_intent"&&(de="input"),u(de),i(he.description||""),n(he.history||[]),b(he.currentQuestion||null),v(he.infraSpec||null),he.aiSnapshot&&B(he.aiSnapshot),he.costEstimation&&T(he.costEstimation),he.costProfile&&Y(he.costProfile),he.selectedProvider?P(he.selectedProvider):(ge=(fe=he.costEstimation)==null?void 0:fe.recommended)!=null&&ge.provider&&P(he.costEstimation.recommended.provider),he.projectData&&h(ne=>({...ne,...he.projectData}))}oe(f),console.log("Workspace loaded:",_e.name)}catch(ve){console.error("Load Error:",ve),ve.response?ve.response.status===401?(ue.error("Session expired. Please login again."),c("/")):ve.response.status===403?(ue.error("You do not have permission to view this workspace."),c("/workspaces")):ve.response.status===404?(ue.error("Workspace not found. It may have been deleted."),c("/workspaces")):ue.error("Failed to load workspace. Server error."):ue.error("Connection failed. Please check your internet.")}})()},[r,c]);const Ne=async()=>{var L,te,le,fe,ge,ve,Se,Re,_e,ke,he;if(!f.trim()){ue.error("Please describe your project first!");return}o(!0),u("processing");try{const de=localStorage.getItem("token"),ne=de?{Authorization:`Bearer ${de}`}:{},je=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:f,conversationHistory:s,input_type:"DESCRIPTION"},{headers:ne});setTimeout(()=>{const{step:De,data:ze}=je.data;o(!1),ze!=null&&ze.full_analysis&&B(ze.full_analysis),De==="refine_requirements"?(b(ze),u("question")):De==="confirm_intent"?(b(ze),u("confirm_intent")):De==="infra_spec_generated"?(v(ze),h({name:ze.project_name}),u("review_spec"),ue.success("Architecture Generated Successfully!")):(console.warn("Unknown Step:",De),!De&&!ze&&(ue.error("Server returned empty response."),u("input")))},1200)}catch(de){console.error("[ANALYZE ERROR]",de),o(!1),u("input");let ne="Failed to analyze your request.";((L=de.response)==null?void 0:L.status)===401?(ne="Your session has expired. Please login again.",ue.error(ne,{duration:4e3}),setTimeout(()=>c("/"),1500)):((te=de.response)==null?void 0:te.status)===400?(ne=((fe=(le=de.response)==null?void 0:le.data)==null?void 0:fe.msg)||((ve=(ge=de.response)==null?void 0:ge.data)==null?void 0:ve.error)||"Invalid request. Please check your input.",ue.error(ne,{duration:5e3})):((Se=de.response)==null?void 0:Se.status)===500?(ne="Server error occurred. Please try again or contact support.",ue.error(ne,{duration:5e3})):de.code==="ECONNABORTED"||de.message.includes("timeout")?(ne="Request timeout. Please check your connection and try again.",ue.error(ne,{duration:5e3})):de.response?(ne=((_e=(Re=de.response)==null?void 0:Re.data)==null?void 0:_e.msg)||((he=(ke=de.response)==null?void 0:ke.data)==null?void 0:he.error)||ne,ue.error(ne,{duration:5e3})):(ne="Cannot connect to server. Please check your internet connection.",ue.error(ne,{duration:5e3}))}},Ee=async L=>{var te,le,fe,ge,ve,Se,Re,_e,ke,he,de;o(!0),u("processing");try{const ne=localStorage.getItem("token"),je=ne?{Authorization:`Bearer ${ne}`}:{},De=f||(g==null?void 0:g.name)||"User confirmed intent",ze=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:De,conversationHistory:s,input_type:"CONFIRMATION",approvedIntent:L},{headers:je});setTimeout(()=>{const{step:st,data:gt}=ze.data;o(!1),st==="refine_requirements"?(b(gt),u("question")):st==="infra_spec_generated"&&(v(gt),h({name:gt.project_name}),u("review_spec"),ue.success("Architecture Generated Successfully!"))},1e3)}catch(ne){console.error("[CONFIRMATION ERROR]",ne),o(!1),u("confirm_intent");let je="Failed to confirm and generate architecture.";((te=ne.response)==null?void 0:te.status)===400?je=((fe=(le=ne.response)==null?void 0:le.data)==null?void 0:fe.msg)||((ve=(ge=ne.response)==null?void 0:ge.data)==null?void 0:ve.error)||"Invalid confirmation data. Please try again.":((Se=ne.response)==null?void 0:Se.status)===401?(je="Session expired. Please login again.",setTimeout(()=>c("/"),1500)):((Re=ne.response)==null?void 0:Re.status)===500?je="Server error during architecture generation. Please try again.":ne.response?je=((ke=(_e=ne.response)==null?void 0:_e.data)==null?void 0:ke.msg)||((de=(he=ne.response)==null?void 0:he.data)==null?void 0:de.error)||je:je="Network error. Please check your connection.",ue.error(je,{duration:5e3})}},a=async L=>{m(L),setTimeout(async()=>{var le,fe,ge,ve,Se,Re,_e;const te=[...s,{role:"user",content:f},{role:"assistant",content:d.clarifying_question},{role:"user",content:L}];n(te),b(null),m(null),o(!0),u("processing_spec");try{const ke=localStorage.getItem("token"),he=ke?{Authorization:`Bearer ${ke}`}:{},de=await Be.post(`${Xe}/api/workflow/analyze`,{userInput:f,conversationHistory:te,input_type:"AXIS_ANSWER",ai_snapshot:D||(d==null?void 0:d.full_analysis)},{headers:he});setTimeout(()=>{const{step:ne,data:je}=de.data;o(!1),je!=null&&je.full_analysis&&B(je.full_analysis),ne==="refine_requirements"?(b(je),u("question")):ne==="confirm_intent"?(b(je),u("confirm_intent")):ne==="infra_spec_generated"&&(v(je),h({name:je.project_name}),u("review_spec"),ue.success("Architecture Refined & Generated!"))},1200)}catch(ke){console.error("[ANSWER QUESTION ERROR]",ke),o(!1),u("question");let he="Failed to process your answer.";((le=ke.response)==null?void 0:le.status)===400?he="Invalid answer format. Please select a valid option.":((fe=ke.response)==null?void 0:fe.status)===401?(he="Session expired. Redirecting to login...",setTimeout(()=>c("/"),1500)):((ge=ke.response)==null?void 0:ge.status)===500?he="Server error processing your answer. Please try again.":ke.response?he=((Se=(ve=ke.response)==null?void 0:ve.data)==null?void 0:Se.msg)||((_e=(Re=ke.response)==null?void 0:Re.data)==null?void 0:_e.error)||he:he="Network error. Please check your connection.",ue.error(he,{duration:5e3})}},600)},U=async(L=!1)=>{var te,le;try{const fe=localStorage.getItem("token"),ge={workspaceId:N,projectId:g==null?void 0:g.id,name:(g==null?void 0:g.name)||`Draft ${new Date().toLocaleTimeString()}`,step:t,state:{history:s,description:f,currentQuestion:d,infraSpec:p,projectData:g,aiSnapshot:D,costEstimation:E,costProfile:H,step:t}},ve=fe?{Authorization:`Bearer ${fe}`}:{},Se=await Be.post(`${Xe}/api/workspaces/save`,ge,{headers:ve});O(Se.data.workspaceId),Se.data.projectId&&h(Re=>({...Re,id:Se.data.projectId})),L||ue.success(`Draft ${N?"Updated":"Saved"} Successfully!`)}catch(fe){if(console.error("Save Error:",fe),!L){const ge=((le=(te=fe.response)==null?void 0:te.data)==null?void 0:le.msg)||fe.message||"Unknown error";ue.error(`Failed to save draft: ${ge}`)}}};return K.useEffect(()=>{if(t&&N&&t!=="input"&&t!=="processing"){const L=setTimeout(()=>{U(!0),console.log(`[Auto-save] Step: ${t}`)},1500);return()=>clearTimeout(L)}},[t,p,E]),e.jsxs("div",{className:"flex h-screen bg-background text-white font-inter overflow-hidden relative selection:bg-primary/30",children:[e.jsx(ks,{position:"top-right",toastOptions:{style:{background:"var(--color-surface, #171E2B)",color:"#fff",border:"1px solid var(--color-border, #2E3645)"}}}),e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-primary/5 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[30%] h-[30%] bg-blue-500/5 rounded-full blur-[100px]"})]}),e.jsx("div",{className:"w-64 bg-surface/80 backdrop-blur-xl border-r border-border flex flex-col justify-between p-6 hidden md:flex z-10",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-primary font-bold text-xl tracking-tight",children:[e.jsx("span",{className:"material-icons text-2xl",children:"cloud_circle"}),e.jsx("span",{children:"Cloudiverse"})]}),e.jsxs("nav",{className:"space-y-3",children:[e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all cursor-pointer 
                            ${t==="input"||t==="question"||t==="processing"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":"text-gray-400 hover:bg-white/5"}`,onClick:()=>u("input"),children:[e.jsx("span",{className:"material-icons text-sm",children:"edit_note"}),e.jsx("span",{children:"Requirements"}),p&&t!=="input"&&t!=="question"&&t!=="processing"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="review_spec"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":p?"text-gray-400 hover:bg-white/5 cursor-pointer":"opacity-50 cursor-not-allowed text-gray-500"}`,onClick:()=>p&&u("review_spec"),children:[e.jsx("span",{className:"material-icons text-sm",children:"schema"}),e.jsx("span",{children:"Specification"}),p&&t!=="review_spec"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="cost_estimation"||t==="processing_cost"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":p?"text-gray-400 hover:bg-white/5 cursor-pointer":"opacity-50 cursor-not-allowed text-gray-500"}`,onClick:()=>E&&u("cost_estimation"),children:[e.jsx("span",{className:"material-icons text-sm",children:"savings"}),e.jsx("span",{children:"Cost Estimator"}),E&&t!=="cost_estimation"&&t!=="processing_cost"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="architecture"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":E?"text-gray-400 hover:bg-white/5 cursor-pointer":"opacity-50 cursor-not-allowed text-gray-500"}`,onClick:()=>E&&u("architecture"),children:[e.jsx("span",{className:"material-icons text-sm",children:"design_services"}),e.jsx("span",{children:"Architecture"}),Q&&t!=="architecture"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:`px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all 
                            ${t==="terraform_view"||t==="deployment_ready"?"bg-primary/10 border border-primary/20 text-primary shadow-lg shadow-primary/5":se?"text-gray-400 hover:bg-white/5 cursor-pointer":"opacity-50 cursor-not-allowed text-gray-500"}`,onClick:()=>se&&u("terraform_view"),children:[e.jsx("span",{className:"material-icons text-sm",children:"code"}),e.jsx("span",{children:"Terraform"}),se&&t!=="terraform_view"&&t!=="deployment_ready"&&e.jsx("span",{className:"material-icons text-xs text-green-500 ml-auto",children:"check_circle"})]}),e.jsxs("div",{className:"px-4 py-3 rounded-xl font-medium flex items-center space-x-3 transition-all cursor-pointer text-gray-400 hover:bg-white/5",onClick:()=>c(`/workspace/${N}/settings`),children:[e.jsx("span",{className:"material-icons text-sm",children:"settings"}),e.jsx("span",{children:"Settings"})]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col relative overflow-y-auto z-10 backdrop-blur-sm",children:[e.jsxs("header",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-black/20 backdrop-blur-md sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-lg font-medium text-gray-200 tracking-wide",children:(g==null?void 0:g.name)||"Untitled Project"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold text-gray-400 tracking-wider uppercase",children:"Draft Mode"}),e.jsxs("button",{onClick:()=>U(!1),className:"px-3 py-1 rounded-full bg-primary/10 border border-primary/20 text-[10px] font-bold text-primary hover:bg-primary/20 transition-colors uppercase tracking-wider flex items-center space-x-1",children:[e.jsx("span",{className:"material-icons text-[10px]",children:"save"}),e.jsx("span",{children:N?"Update Draft":"Save Draft"})]})]})]}),e.jsxs("button",{onClick:()=>c("/workspaces"),className:"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-sm font-medium text-gray-400 hover:bg-white/10 hover:text-white transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-sm",children:"dashboard"}),e.jsx("span",{children:"Workspace Dashboard"})]})]}),e.jsx("div",{className:"flex-1 p-8 flex",children:e.jsxs("div",{className:"w-full max-w-5xl space-y-12 mx-auto",children:[X&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 flex items-center justify-between animate-shake",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"material-icons text-yellow-500",children:"warning"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("b",{children:"Assumption Drift:"})," The project description has changed. Previous cost estimates may no longer be valid."]})]}),e.jsx("button",{onClick:()=>Ne(),className:"px-4 py-2 bg-yellow-500 text-black font-bold text-xs rounded-lg hover:bg-yellow-400 transition-colors",children:"Re-Analyze"})]}),(t==="processing"||t==="processing_spec")&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-white/10 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-primary rounded-full border-t-transparent animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"material-icons text-4xl text-white animate-pulse",children:"grain"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t==="processing"?"Analyzing Intent...":"Generating Blueprint..."}),e.jsx("p",{className:"text-gray-400 animate-pulse",children:"Architecting your production-grade infrastructure"})]})]}),t==="input"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up mt-10",children:[z&&e.jsxs("div",{className:"bg-green-500/10 border-2 border-green-500/30 rounded-2xl p-6 flex items-start space-x-4 shadow-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"material-icons text-green-400 text-4xl",children:"check_circle"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-green-400 mb-2 flex items-center space-x-2",children:[e.jsx("span",{children:"Project Successfully Deployed"}),e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-300 text-xs rounded-full",children:"Read-Only Mode"})]}),e.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:"This workspace has been deployed and is now in read-only mode. You can view all details and download Terraform files, but cannot modify the architecture or configuration."})]})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-200 to-gray-500 tracking-tight",children:z?"Deployed Architecture":"Architect Your Vision"}),e.jsx("p",{className:"text-lg text-gray-400 max-w-2xl mx-auto leading-relaxed",children:z?"Review your deployed infrastructure configuration below.":"Describe your application in plain English. Our AI Discovery Engine will analyze your intent and generate a production-grade infrastructure specification."})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary to-blue-600 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"}),e.jsxs("div",{className:"relative bg-surface border border-border rounded-2xl p-2 shadow-2xl",children:[e.jsx("textarea",{className:"w-full h-48 bg-transparent text-xl p-8 focus:outline-none resize-none placeholder-gray-600 text-gray-200 font-light leading-relaxed disabled:opacity-60 disabled:cursor-not-allowed",placeholder:"e.g., I need a highly scalable e-commerce backend with microservices, handling 50k concurrent users, and strict PCI compliance...",value:f,onChange:L=>i(L.target.value),disabled:z,readOnly:z}),e.jsxs("div",{className:"flex justify-between items-center px-8 py-5 bg-white/5 rounded-b-xl border-t border-white/5",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 disabled:opacity-40 disabled:cursor-not-allowed",disabled:z,children:e.jsx("span",{className:"material-icons text-xl",children:"mic"})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 disabled:opacity-40 disabled:cursor-not-allowed",disabled:z,children:e.jsx("span",{className:"material-icons text-xl",children:"attach_file"})})]}),!z&&e.jsxs("button",{onClick:Ne,className:"flex items-center space-x-3 px-8 py-3 bg-primary hover:bg-primary-hover text-black font-bold rounded-xl transition-all transform hover:scale-[1.02] shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Generate Architecture"}),e.jsx("span",{className:"material-icons text-lg",children:"auto_awesome"})]})]})]})]})]}),t==="question"&&d&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up max-w-2xl mx-auto mt-12 pb-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"material-icons text-primary text-3xl",children:"psychology"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Clarifying Requirements"}),e.jsx("p",{className:"text-gray-400",children:d.clarifying_question})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:(F=d.suggested_options)==null?void 0:F.map((L,te)=>e.jsxs("button",{onClick:()=>a(typeof L=="object"?L.value||L.label:L),className:`p-6 bg-surface border rounded-2xl text-left transition-all group relative overflow-hidden
                                                ${x===(typeof L=="object"?L.value||L.label:L)?"border-primary ring-1 ring-primary":"border-border hover:border-white/20"}`,children:[e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:typeof L=="object"?L.label:L}),L.description&&e.jsx("div",{className:"text-sm text-gray-400 line-clamp-2",children:L.description})]}),e.jsx("span",{className:"material-icons text-gray-600 group-hover:text-primary transition-colors",children:"arrow_forward"})]}),x===(typeof L=="object"?L.value||L.label:L)&&e.jsx("div",{className:"absolute inset-0 bg-primary/5 animate-pulse"})]},te))})]}),t==="confirm_intent"&&d&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up max-w-3xl mx-auto mt-12 pb-20",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Confirm Project Scope"}),e.jsx("p",{className:"text-gray-400",children:"We've analyzed your requirements. Please confirm this summary before we generate the infrastructure."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-3xl p-8 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full blur-[100px] -mr-32 -mt-32"}),e.jsxs("div",{className:"space-y-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/10 border border-primary/20 text-primary rounded-full text-[10px] font-bold uppercase tracking-widest",children:"AI Intent Snapshot"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:"Confirmed"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase",children:"Excluded"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Goal"}),e.jsx("p",{className:"text-white font-medium capitalize prose prose-invert",children:((y=(_=d.intent)==null?void 0:_.primary_domain)==null?void 0:y.replace(/_/g," "))||"Building an application"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:"Workload Pattern"}),e.jsx("p",{className:"text-white/80 text-sm italic",children:(($=(C=d.intent)==null?void 0:C.workload_type)==null?void 0:$.replace(/_/g," "))||"Standard Workload"})]}),d.exclusions&&d.exclusions.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-red-500/70 uppercase tracking-widest mb-2 flex items-center",children:[e.jsx("span",{className:"material-icons text-xs mr-1",children:"block"}),"Explicit Exclusions"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.exclusions.map((L,te)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/10 text-red-400 border border-red-500/20 rounded text-[10px] font-bold uppercase tracking-wider line-through decoration-red-500/50",children:L.replace(/_/g," ")},te))})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white/5 rounded-2xl p-5 border border-white/5",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Feature Resolution"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[10px] text-green-500 font-bold uppercase",children:"Confirmed Present"}),e.jsxs("ul",{className:"grid grid-cols-1 gap-1.5",children:[Object.entries(d.features||{}).filter(([L,te])=>te===!0).map(([L,te],le)=>e.jsxs("li",{className:"flex items-center text-xs text-gray-200 bg-green-500/5 px-2 py-1 rounded",children:[e.jsx("span",{className:"material-icons text-[12px] text-green-500 mr-2",children:"check_circle"}),e.jsx("span",{className:"capitalize",children:L.replace(/_/g," ")})]},le)),Object.values(d.features||{}).filter(L=>L===!0).length===0&&e.jsx("li",{className:"text-xs text-gray-500 italic",children:"None detected."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 font-bold uppercase",children:"What we did NOT assume"}),e.jsx("ul",{className:"grid grid-cols-1 gap-1.5 opacity-60",children:Object.entries(d.features||{}).filter(([L,te])=>te==="unknown"||te===!1).map(([L,te],le)=>e.jsxs("li",{className:"flex items-center text-xs text-gray-400",children:[e.jsx("span",{className:"material-icons text-[12px] text-gray-600 mr-2",children:te===!1?"block":"help_outline"}),e.jsx("span",{className:"capitalize",children:L.replace(/_/g," ")})]},le))})]})]})]})})]}),e.jsxs("div",{className:"pt-6 border-t border-white/5 flex flex-col space-y-4",children:[e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:[e.jsx("span",{className:"material-icons text-[10px] align-middle mr-1",children:"lock"}),"Confirming locks this intent as the ",e.jsx("b",{children:"Single Source of Truth"}),"."]}),e.jsxs("button",{onClick:()=>Ee(d.full_analysis),className:"w-full py-4 bg-primary hover:bg-primary-hover text-black font-extrabold rounded-2xl transition-all transform hover:scale-[1.01] shadow-xl shadow-primary/20 flex items-center justify-center space-x-3",children:[e.jsx("span",{children:"Confirm & Generate Blueprint"}),e.jsx("span",{className:"material-icons",children:"rocket_launch"})]})]})]})]})]}),t==="review_spec"&&p&&e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary/5 rounded-full blur-[60px] -mr-10 -mt-10"}),e.jsx("button",{onClick:()=>c(`/workspace/${N}/settings`),className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors rounded-lg p-2 hover:bg-white/5",children:e.jsx("span",{className:"material-icons text-sm",children:"settings"})}),e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-4",children:"Project Snapshot"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 relative z-10",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Project Name"}),e.jsx("div",{className:"text-xl font-bold text-white tracking-tight flex items-center space-x-2 group",children:e.jsx("span",{children:(g==null?void 0:g.name)||p.project_name||"My Cloud Project"})}),e.jsxs("div",{className:"mt-2 group",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",title:g==null?void 0:g.description,children:(g==null?void 0:g.description)||p.project_summary||f||"No description provided."})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Project Type"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 bg-white/5 rounded-full text-sm text-gray-300 border border-white/5",children:[e.jsx("span",{className:"material-icons text-xs",children:"category"}),e.jsx("span",{className:"capitalize",children:((Z=p.architecture_pattern)==null?void 0:Z.replace(/_/g," "))||"Web App"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Client Type"}),e.jsxs("div",{className:"inline-flex items-center space-x-2 px-3 py-1 bg-white/5 rounded-full text-sm text-gray-300 border border-white/5",children:[e.jsx("span",{className:"material-icons text-xs",children:"devices"}),e.jsx("span",{className:"capitalize",children:((I=D==null?void 0:D.intent)==null?void 0:I.client_type)||"Web"})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(D==null?void 0:D.features)&&Object.entries(D.features).filter(([L,te])=>te===!0).map(([L])=>e.jsx("span",{className:"px-2 py-1 bg-blue-500/10 text-blue-400 border border-blue-500/20 rounded text-[10px] font-bold uppercase tracking-wider",children:L.replace(/_/g," ")},L))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 text-xs font-bold",children:""}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"How we understood your project"})]}),e.jsxs("div",{className:"bg-surface/50 border border-border rounded-2xl p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(q=p.explanations)==null?void 0:q.slice(0,4).map((L,te)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mt-0.5",children:"check"}),e.jsx("span",{className:"text-sm text-gray-300 leading-relaxed",children:L})]},te)),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mt-0.5",children:"check"}),e.jsxs("span",{className:"text-sm text-gray-300 leading-relaxed",children:["Traffic scale assumption: ",e.jsx("span",{className:"text-white font-medium",children:((J=p.assumptions)==null?void 0:J.traffic_tier)||"Medium"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4 italic",children:"Based on your description and selected options."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-primary",children:"schema"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Architecture Overview"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 relative overflow-hidden group hover:border-primary/30 transition-all duration-500",children:[e.jsxs("p",{className:"text-white font-medium text-lg leading-relaxed border-b border-white/5 pb-4 mb-6",children:['"',p.project_summary||"Optimized cloud infrastructure.",'"']}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-3",children:"Included Services & Infrastructure"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(V=p.modules)==null?void 0:V.map((L,te)=>e.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/20 transition-colors",children:[e.jsx("span",{className:"material-icons text-gray-500 text-sm mr-3",children:L.category==="compute"?"memory":L.category==="storage"?"storage":L.category==="database"?"database":"cloud"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-bold text-white",children:L.service_name||L.type}),e.jsx("div",{className:"text-xs text-primary/80 uppercase font-bold tracking-wider",children:L.category})]})]},te))})]}),e.jsxs("div",{className:"flex items-start space-x-2 bg-blue-500/5 p-4 rounded-xl border border-blue-500/10",children:[e.jsx("span",{className:"material-icons text-blue-400 text-sm mt-0.5",children:"info"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["This architecture is designed for ",e.jsx("strong",{children:(re=p.assumptions)==null?void 0:re.traffic_tier})," traffic. Proceed to usage estimation to see detailed costs."]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:ye,disabled:w,className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50",children:[e.jsx("span",{children:"Estimate Usage & Costs"}),e.jsx("span",{className:"material-icons",children:"analytics"})]})})]}),t==="processing_usage"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Analyzing Usage Patterns"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"AI is predicting realistic user traffic, storage, and bandwidth..."})]})]}),t==="usage_review"&&k&&e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Estimated Usage Profile"}),e.jsxs("p",{className:"text-gray-400 max-w-2xl mx-auto",children:['Based on your project description ("',g==null?void 0:g.name,`"), we've inferred the following usage patterns to generate accurate costs.`]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-primary/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-primary/20 group-hover:text-primary/40 transition-colors text-4xl",children:"group"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Scale: Monthly Users"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-primary outline-none transition-colors",value:k.usage_profile.monthly_users.min,onChange:L=>{const te=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,monthly_users:{...k.usage_profile.monthly_users,min:te}}}),be(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-primary outline-none transition-colors",value:k.usage_profile.monthly_users.max,onChange:L=>{const te=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,monthly_users:{...k.usage_profile.monthly_users,max:te}}}),be(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[10px] text-green-400 font-bold uppercase tracking-wider",children:"Expected Traffic"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((xe=k.rationale)==null?void 0:xe.monthly_users)||"Based on typical growth for this workload type.",'"']})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-blue-500/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-blue-500/20 group-hover:text-blue-500/40 transition-colors text-4xl",children:"swap_horiz"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Network: Data Transfer (GB)"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-blue-500 outline-none transition-colors",value:k.usage_profile.data_transfer_gb.min,onChange:L=>{const te=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,data_transfer_gb:{...k.usage_profile.data_transfer_gb,min:te}}}),be(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-blue-500 outline-none transition-colors",value:k.usage_profile.data_transfer_gb.max,onChange:L=>{const te=parseInt(L.target.value)||0;A({...k,usage_profile:{...k.usage_profile,data_transfer_gb:{...k.usage_profile.data_transfer_gb,max:te}}}),be(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-wider",children:"Egress/Bandwidth"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((ce=k.rationale)==null?void 0:ce.data_transfer_gb)||"Simulates content delivery and API interactions.",'"']})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col hover:border-purple-500/50 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3",children:e.jsx("span",{className:"material-icons text-purple-500/20 group-hover:text-purple-500/40 transition-colors text-4xl",children:"storage"})}),e.jsx("h3",{className:"text-gray-400 text-xs uppercase font-bold tracking-widest mb-4",children:"Capacity: Storage (GB)"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Min"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-purple-500 outline-none transition-colors",value:k.usage_profile.data_storage_gb.min,onChange:L=>{const te=parseInt(L.target.value)||0;A(le=>({...le,usage_profile:{...le.usage_profile,data_storage_gb:{...le.usage_profile.data_storage_gb,min:te}}})),be(!0)}})]}),e.jsx("span",{className:"text-gray-600 self-end mb-2",children:"to"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold mb-1",children:"Max"}),e.jsx("input",{type:"number",className:"w-24 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white font-bold focus:border-purple-500 outline-none transition-colors",value:k.usage_profile.data_storage_gb.max,onChange:L=>{const te=parseInt(L.target.value)||0;A(le=>({...le,usage_profile:{...le.usage_profile,data_storage_gb:{...le.usage_profile.data_storage_gb,max:te}}})),be(!0)}})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-purple-500"}),e.jsx("span",{className:"text-[10px] text-purple-400 font-bold uppercase tracking-wider",children:"Data Footprint"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 italic leading-relaxed",children:['"',((Ae=k.rationale)==null?void 0:Ae.data_storage_gb)||((We=k.rationale)==null?void 0:We.storage_gb)||"Accounts for both database and file assets.",'"']})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>u("review_spec"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Architecture"})]}),e.jsxs("button",{onClick:pe,disabled:w,className:"px-8 py-4 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-green-500/20 disabled:opacity-50",children:[e.jsx("span",{children:"Calculate Cloud Costs"}),e.jsx("span",{className:"material-icons",children:"payments"})]})]})]}),t==="cost_estimation"&&E&&e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-primary",children:"cloud"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Cloud Provider Comparison"})]}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:"Select a provider to see specific details"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(E.rankings||[]).map(L=>{var le;const te=l===L.provider;return e.jsxs("div",{onClick:()=>P(L.provider),className:`cursor-pointer rounded-2xl p-5 border transition-all relative overflow-hidden flex flex-col justify-between
                                                        ${te?"bg-primary/10 border-primary shadow-lg shadow-primary/20 scale-[1.02]":"bg-surface border-border hover:border-white/20"}`,children:[L.recommended&&e.jsx("div",{className:"absolute top-0 right-0 px-3 py-1 bg-gradient-to-r from-yellow-400 to-amber-500 text-[10px] font-bold text-black uppercase tracking-tighter rounded-bl-xl shadow-lg",children:"Recommended"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold
                                                            ${L.provider==="AWS"?"bg-[#FF9900]/20 text-[#FF9900]":L.provider==="GCP"?"bg-[#4285F4]/20 text-[#4285F4]":"bg-[#0078D4]/20 text-[#0078D4]"}`,children:L.provider==="AWS"?"AWS":L.provider==="GCP"?"GCP":"AZ"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:L.provider==="AZURE"?"Azure":L.provider}),e.jsxs("div",{className:"text-[10px] text-gray-400 uppercase tracking-widest",children:[L.score,"% Score"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-white leading-tight",children:[((le=L.cost_range)==null?void 0:le.formatted)||L.formatted_cost,L.monthly_cost&&L.monthly_cost<1&&e.jsx("div",{className:"text-[10px] text-amber-400",children:L.cost_intent==="hobby"?"Hobby-scale lower bound":"Estimated minimum"})]}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:L.recommended?"Recommended configuration (Cost-Effective)":"Estimated Monthly Cost"}),(()=>{let fe="standard";if(E.scenarios){for(const[ge,ve]of Object.entries(E.scenarios))if(ve[L.provider]){fe=ge;break}}return e.jsxs("div",{className:"text-[10px] text-gray-400",children:[fe.replace("_"," ").replace(/\b\w/g,ge=>ge.toUpperCase())," profile"]})})(),L.recommended&&(E==null?void 0:E.recommendation_facts)&&e.jsx("div",{className:"text-[10px] text-amber-400 italic mt-1",children:E.recommendation_facts.facts.dominant_drivers[0]?`${E.recommendation_facts.facts.dominant_drivers[0].name} is a key cost driver at your usage level.`:"Based on your usage patterns and cost optimization."})]}),te&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-primary/20 flex items-center justify-between text-[10px] text-primary font-bold uppercase tracking-wider",children:[e.jsx("span",{children:"Selected"}),e.jsx("span",{className:"material-icons text-[12px]",children:"check_circle"})]})]},L.provider)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-green-400",children:"paid"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Cost Details & Confidence"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col justify-center items-center text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mb-3",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#2E3645",strokeWidth:"4"}),e.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:typeof((Oe=E.ai_explanation)==null?void 0:Oe.confidence_score)=="number"&&E.ai_explanation.confidence_score>.8?"#22c55e":typeof((Ze=E.ai_explanation)==null?void 0:Ze.confidence_score)=="number"&&E.ai_explanation.confidence_score>.5?"#eab308":"#ef4444",strokeWidth:"4",strokeDasharray:`${(((we=E.ai_explanation)==null?void 0:we.confidence_score)||0)*100}, 100`})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsxs("span",{className:"text-xl font-bold text-white",children:[typeof((Ye=E.ai_explanation)==null?void 0:Ye.confidence_score)=="number"?(E.ai_explanation.confidence_score*100).toFixed(0):"0","%"]})})]}),e.jsxs("div",{className:"text-sm font-bold text-white uppercase tracking-wider flex items-center space-x-2",children:[e.jsx("span",{children:"Confidence"}),e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"material-icons text-xs text-gray-400 cursor-help",children:"info"}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg shadow-lg w-64 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:["Confidence is based on identified services, multi-cloud comparison, and inferred usage. Final costs may vary after Terraform generation.",e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 line-clamp-2",children:"Based on identified services, multi-cloud comparison, and usage estimation. Final costs will be validated after infrastructure generation."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 flex flex-col justify-center items-center text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white mb-3",children:(()=>{var te,le;const L=(te=E.rankings)==null?void 0:te.find(fe=>fe.provider===l);if(!(L!=null&&L.score)){const fe=E.scenarios?Object.values(E.scenarios).map(ge=>ge[l]).find(ge=>ge):null;return(fe==null?void 0:fe.score)||((le=E.recommended)==null?void 0:le.score)||"N/A"}return L.score})()}),e.jsx("div",{className:"text-sm font-bold text-white uppercase tracking-wider",children:"% Score"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[l||"Provider"," competitiveness"]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 bg-surface border border-border rounded-2xl p-6",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase font-bold mb-4",children:"Estimate Based On"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(Je=k==null?void 0:k.usage_profile)!=null&&Je.monthly_users?typeof k.usage_profile.monthly_users=="object"?`${(k.usage_profile.monthly_users.min||0).toLocaleString()} - ${(k.usage_profile.monthly_users.max||0).toLocaleString()}`:k.usage_profile.monthly_users.toLocaleString():(nt=(tt=(Te=E==null?void 0:E.recommendation_facts)==null?void 0:Te.facts)==null?void 0:tt.usage)!=null&&nt.monthly_users?typeof E.recommendation_facts.facts.usage.monthly_users=="object"?`${(E.recommendation_facts.facts.usage.monthly_users.min||0).toLocaleString()} - ${(E.recommendation_facts.facts.usage.monthly_users.max||0).toLocaleString()}`:E.recommendation_facts.facts.usage.monthly_users.toLocaleString():"5,000"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Monthly Users"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(it=k==null?void 0:k.usage_profile)!=null&&it.data_transfer_gb?typeof k.usage_profile.data_transfer_gb=="object"?`${k.usage_profile.data_transfer_gb.min||0} - ${k.usage_profile.data_transfer_gb.max||0} GB`:`${k.usage_profile.data_transfer_gb} GB`:(He=(rt=(ot=E==null?void 0:E.recommendation_facts)==null?void 0:ot.facts)==null?void 0:rt.usage)!=null&&He.data_transfer_gb?typeof E.recommendation_facts.facts.usage.data_transfer_gb=="object"?`${E.recommendation_facts.facts.usage.data_transfer_gb.min||0} - ${E.recommendation_facts.facts.usage.data_transfer_gb.max||0} GB`:`${E.recommendation_facts.facts.usage.data_transfer_gb} GB`:"50 GB"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Data Transfer"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(Ke=k==null?void 0:k.usage_profile)!=null&&Ke.data_storage_gb?typeof k.usage_profile.data_storage_gb=="object"?`${k.usage_profile.data_storage_gb.min||0} - ${k.usage_profile.data_storage_gb.max||0} GB`:`${k.usage_profile.data_storage_gb} GB`:(Rt=(zt=(At=E==null?void 0:E.recommendation_facts)==null?void 0:At.facts)==null?void 0:zt.usage)!=null&&Rt.data_storage_gb?typeof E.recommendation_facts.facts.usage.data_storage_gb=="object"?`${E.recommendation_facts.facts.usage.data_storage_gb.min||0} - ${E.recommendation_facts.facts.usage.data_storage_gb.max||0} GB`:`${E.recommendation_facts.facts.usage.data_storage_gb} GB`:"10 GB"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Storage"})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{var le,fe,ge;return((((le=E.recommended)==null?void 0:le.provider)===l?E.recommended.services:null)||((ge=(fe=E.provider_details)==null?void 0:fe[l||"aws"])==null?void 0:ge.services)||[]).slice(0,6).map((ve,Se)=>e.jsx("span",{className:"px-3 py-1 bg-white/5 border border-white/10 rounded-full text-xs text-gray-300",children:ve.cloud_service||ve.display_name},Se))})()})}),(E==null?void 0:E.recommendation_facts)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-amber-500/20",children:[e.jsxs("div",{className:"text-xs text-amber-400 font-bold uppercase tracking-wider mb-2",children:["Why ",E.recommendation_facts.provider.toUpperCase(),"?"]}),e.jsx("div",{className:"space-y-1 text-xs text-gray-300",children:E.recommendation_facts.pros.map((L,te)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-green-400 mr-1",children:""}),e.jsx("span",{children:L})]},te))})]}),e.jsxs("button",{onClick:()=>u("usage_review"),className:"mt-4 w-full py-2 text-gray-400 text-xs font-medium hover:text-white hover:bg-white/5 rounded-lg transition-colors flex items-center justify-center space-x-1",children:[e.jsx("span",{className:"material-icons text-xs",children:"edit"}),e.jsx("span",{children:"Refine assumptions"})]})]})]})]}),e.jsxs("div",{className:"border border-white/5 rounded-2xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>m(x==="scenarios"?null:"scenarios"),className:"w-full p-4 bg-white/5 hover:bg-white/10 flex items-center justify-between transition-colors",children:[e.jsx("span",{className:"font-medium text-gray-300",children:"Scaling Scenarios"}),e.jsx("span",{className:`material-icons text-gray-400 transition-transform ${x==="scenarios"?"rotate-180":""}`,children:"expand_more"})]}),x==="scenarios"&&e.jsxs("div",{className:"p-6 bg-surface animate-fade-in",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-bold text-white mb-3",children:"Scenario Profiles"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-500/10 to-emerald-500/10 border border-green-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-green-400",children:""}),e.jsx("h5",{className:"font-bold text-white",children:"Cost-Effective (Recommended)"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Optimized for minimal costs with basic resources and serverless patterns."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/10 to-amber-500/10 border border-amber-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-amber-400",children:""}),e.jsx("h5",{className:"font-bold text-white",children:"Standard"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Balanced configuration with moderate performance and availability."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500/10 to-rose-500/10 border border-rose-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-rose-400",children:""}),e.jsx("h5",{className:"font-bold text-white",children:"High-Performance"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Premium resources with enhanced performance and high availability."})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"If traffic doubles?"}),e.jsx("span",{className:"text-[10px] font-bold text-red-400 bg-red-400/10 px-2 py-0.5 rounded uppercase",children:"+25%"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Cost scales with bandwidth and API requests."})]}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"If storage doubles?"}),e.jsx("span",{className:"text-[10px] font-bold text-green-400 bg-green-400/10 px-2 py-0.5 rounded uppercase",children:"+5%"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Storage is generally the most cost-effective component."})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-xl p-4",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:"Estimated Cost Range"}),e.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:((It=E.cost_range)==null?void 0:It.formatted)||"$0.00 - $0.00/month"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Depends on scaling, availability, and performance choices"})]})]})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-xl p-4 flex items-start space-x-3",children:[e.jsx("span",{className:"material-icons text-amber-400 text-sm mt-0.5",children:"warning"}),e.jsxs("p",{className:"text-xs text-amber-200/90 leading-relaxed",children:["This is an approximate cost estimate based on formula-driven provider pricing for ",l||"the selected provider",". Exact costs will be calculated when Terraform is generated and will depend on actual resource usage, region selection, and any enterprise discounts."]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-white/5",children:[e.jsxs("button",{onClick:()=>u("usage_review"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Usage"})]}),e.jsxs("button",{onClick:()=>{u("architecture")},className:"px-8 py-4 bg-gradient-to-r from-primary to-purple-500 rounded-xl text-white font-bold uppercase tracking-wider flex items-center space-x-3 hover:opacity-90 transition-all shadow-lg shadow-primary/20",children:[e.jsx("span",{children:"Review Architecture"}),e.jsx("span",{className:"material-icons",children:"design_services"})]})]})]}),t==="requirements"&&e.jsx(Is,{workspaceId:r,infraSpec:p,costEstimation:E,onNext:()=>u("architecture"),onBack:()=>u("cost_estimation"),onRequirementsCaptured:R}),t==="architecture"&&e.jsx(La,{workspaceId:r,infraSpec:p,costEstimation:E,selectedProvider:l,selectedProfile:H,usageProfile:k,requirementsData:ae,architectureData:Q,onArchitectureDataLoaded:M,onNext:()=>u("feedback"),onBack:()=>u("requirements")}),t==="feedback"&&e.jsx(Ss,{workspaceId:r,costEstimation:E,selectedProvider:l,costIntent:k==null?void 0:k.intent,onFeedbackSubmitted:()=>W(!0),onNext:()=>u("terraform_view"),onBack:()=>u("architecture")}),t==="terraform_view"&&e.jsx(Rs,{workspaceId:r,infraSpec:p,selectedProvider:l,costEstimation:E,onComplete:()=>u("deployment_ready"),onBack:()=>u("feedback")}),t==="processing_cost"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-white",children:"Analyzing Cloud Costs"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Comparing AWS, GCP, and Azure pricing..."})]})]}),t==="deployment_ready"&&e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-500/20 mb-6",children:e.jsx("span",{className:"material-icons text-4xl text-green-400",children:"check_circle"})}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Ready for Deployment"}),e.jsx("p",{className:"text-gray-400 mt-3 max-w-md",children:"Your infrastructure is ready. Choose your deployment method below."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 max-w-lg w-full",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Deployment Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cloud Provider"}),e.jsx("span",{className:"text-white font-medium",children:(l==null?void 0:l.toUpperCase())||"Not Selected"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Services Count"}),e.jsxs("span",{className:"text-white font-medium",children:[((Ot=E==null?void 0:E.recommended)==null?void 0:Ot.service_count)||((Tt=(Ft=E==null?void 0:E.provider_details)==null?void 0:Ft[l])==null?void 0:Tt.service_count)||((Dt=(Bt=p==null?void 0:p.service_classes)==null?void 0:Bt.required_services)==null?void 0:Dt.length)||0," services"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Monthly Estimate"}),e.jsx("span",{className:"text-green-400 font-bold",children:((Pt=E==null?void 0:E.recommended)==null?void 0:Pt.formatted_cost)||(($t=(Ut=E==null?void 0:E.provider_details)==null?void 0:Ut[l])==null?void 0:$t.formatted_cost)||((Mt=(Lt=E==null?void 0:E.rankings)==null?void 0:Lt.find(L=>L.provider===l))==null?void 0:Mt.formatted_cost)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cost Profile"}),e.jsx("span",{className:"text-white font-medium capitalize",children:((Wt=E==null?void 0:E.cost_profile)==null?void 0:Wt.replace("_"," ").toLowerCase())||"standard"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-4 w-full max-w-2xl",children:[e.jsx("div",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Deployment Options"}),e.jsxs("div",{className:"flex space-x-4 w-full justify-center",children:[e.jsxs("button",{onClick:async()=>{try{await Be.put(`http://localhost:5000/api/workspaces/${r}/deploy`,{deployment_method:"self",provider:l}),ue.success("Workspace ready! You can now deploy the downloaded Terraform code."),c("/workspaces")}catch(L){console.error("Failed to update deployment readiness:",L),ue.error("Failed to mark workspace as ready")}},className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons text-lg",children:"download_done"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold",children:"Self Deployment"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Download & deploy manually"})]})]}),e.jsxs("button",{disabled:!0,className:"px-6 py-3 bg-gradient-to-r from-primary/10 to-blue-500/10 border border-primary/20 rounded-xl text-primary/50 font-medium cursor-not-allowed flex items-center space-x-2 relative",children:[e.jsx("span",{className:"material-icons text-lg",children:"rocket_launch"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("span",{className:"text-sm font-bold flex items-center space-x-2",children:[e.jsx("span",{children:"One-Click Deployment"}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 rounded text-xs text-primary",children:"Coming Soon"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Automated cloud deployment"})]})]})]})]}),e.jsxs("button",{onClick:()=>u("terraform_view"),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-medium hover:bg-white/10 transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:"material-icons",children:"arrow_back"}),e.jsx("span",{children:"Back to Terraform"})]})]})]})})]})]})};export{qa as default};
